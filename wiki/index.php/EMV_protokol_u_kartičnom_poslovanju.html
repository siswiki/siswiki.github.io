<!DOCTYPE html>
<html lang="hr" dir="ltr">
<head>
<meta charset="UTF-8" />
<title>EMV protokol u kartičnom poslovanju - SIS Wiki</title>
<meta name="generator" content="MediaWiki 1.17.0" />
<link rel="shortcut icon" href="http://security.foi.hr/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="../opensearch_desc.php" title="SIS Wiki (hr)" />
<link rel="EditURI" type="application/rsd+xml" href="../api.php%3Faction=rsd" />
<link title="Creative Commons" type="application/rdf+xml" href="http://security.foi.hr/wiki/index.php?title=EMV_protokol_u_karti%C4%8Dnom_poslovanju&amp;action=creativecommons" rel="meta" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-sa/3.0/" />
<link rel="alternate" type="application/atom+xml" title="SIS Wiki Atom izvor" href="../index.php%3Ftitle=Posebno:Nedavne_promjene&amp;feed=atom" />
<link rel="stylesheet" href="../load.php%3Fdebug=false&amp;lang=hr&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cskins.vector&amp;only=styles&amp;skin=vector&amp;*.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/wiki/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr ns-0 ns-subject page-EMV_protokol_u_kartičnom_poslovanju skin-vector">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<!-- content -->
		<div id="content">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<!-- firstHeading -->
			<h1 id="firstHeading" class="firstHeading">EMV protokol u kartičnom poslovanju</h1>
			<!-- /firstHeading -->
			<!-- bodyContent -->
			<div id="bodyContent">
				<!-- tagline -->
				<div id="siteSub">Izvor: SIS Wiki</div>
				<!-- /tagline -->
				<!-- subtitle -->
				<div id="contentSub"></div>
				<!-- /subtitle -->
																<!-- jumpto -->
				<div id="jump-to-nav">
					Skoči na: <a href="EMV_protokol_u_kartičnom_poslovanju.html#mw-head">orijentacija</a>,
					<a href="EMV_protokol_u_kartičnom_poslovanju.html#p-search">traži</a>
				</div>
				<!-- /jumpto -->
								<!-- bodytext -->
				<p>Tomislav Slunjski - izvanredni student
</p><p>Tomislav Stanić - izvanredni student
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Sadržaj</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="EMV_protokol_u_kartičnom_poslovanju.html#1.Uvod"><span class="tocnumber">1</span> <span class="toctext">1.Uvod</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="EMV_protokol_u_kartičnom_poslovanju.html#2._Autentikacija_podataka"><span class="tocnumber">2</span> <span class="toctext">2. Autentikacija podataka</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="EMV_protokol_u_kartičnom_poslovanju.html#2.1._Stati.C4.8Dka_autentifikacija_podataka_SDA"><span class="tocnumber">3</span> <span class="toctext">2.1. Statička autentifikacija podataka SDA</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="EMV_protokol_u_kartičnom_poslovanju.html#2.2.Lokalna_Dinami.C4.8Dka_autentifikacija_podataka_DDA"><span class="tocnumber">4</span> <span class="toctext">2.2.Lokalna Dinamička autentifikacija podataka DDA</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="EMV_protokol_u_kartičnom_poslovanju.html#2.3.Kombinirana_dinami.C4.8Dka_autentifikacija_podataka.2F_Generiranje_aplikacijskog_kriptograma_CDA"><span class="tocnumber">5</span> <span class="toctext">2.3.Kombinirana dinamička autentifikacija podataka/ Generiranje aplikacijskog kriptograma CDA</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="EMV_protokol_u_kartičnom_poslovanju.html#2.4.Enkripcija_osobnog_identifikacijskog_broja_.28PIN.29"><span class="tocnumber">6</span> <span class="toctext">2.4.Enkripcija osobnog identifikacijskog broja (PIN)</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="EMV_protokol_u_kartičnom_poslovanju.html#2.5.Aplikacijski_kriptogram_i_autentifikacija_izdava.C4.8Da_kartice"><span class="tocnumber">7</span> <span class="toctext">2.5.Aplikacijski kriptogram i autentifikacija izdavača kartice</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="EMV_protokol_u_kartičnom_poslovanju.html#2.6.Sigurno_komuniciranje_porukama"><span class="tocnumber">8</span> <span class="toctext">2.6.Sigurno komuniciranje porukama</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="EMV_protokol_u_kartičnom_poslovanju.html#3._Infrastruktura_javnog_klju.C4.8Da_izdavatelja_certifikata"><span class="tocnumber">9</span> <span class="toctext">3. Infrastruktura javnog ključa izdavatelja certifikata</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="EMV_protokol_u_kartičnom_poslovanju.html#3.1..C5.BDivotni_ciklus_javnog_klju.C4.8Da"><span class="tocnumber">10</span> <span class="toctext">3.1.Životni ciklus javnog ključa</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="EMV_protokol_u_kartičnom_poslovanju.html#5.Sigurnost_terminala_i_rukovanje_klju.C4.8Devima"><span class="tocnumber">11</span> <span class="toctext">5.Sigurnost terminala i rukovanje ključevima</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="EMV_protokol_u_kartičnom_poslovanju.html#5.1.Sigurnosni_zahtjevi_za_terminale"><span class="tocnumber">12</span> <span class="toctext">5.1.Sigurnosni zahtjevi za terminale</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="EMV_protokol_u_kartičnom_poslovanju.html#5.2.Zahtjevi_za_rukovanje_klju.C4.8Devima"><span class="tocnumber">13</span> <span class="toctext">5.2.Zahtjevi za rukovanje ključevima</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="EMV_protokol_u_kartičnom_poslovanju.html#6._Sigurnosni_mehanizmi_i_algoritmi"><span class="tocnumber">14</span> <span class="toctext">6. Sigurnosni mehanizmi i algoritmi</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="EMV_protokol_u_kartičnom_poslovanju.html#6.1.Simetri.C4.8Dni_mehanizmi"><span class="tocnumber">15</span> <span class="toctext">6.1.Simetrični mehanizmi</span></a></li>
<li class="toclevel-1 tocsection-16"><a href="EMV_protokol_u_kartičnom_poslovanju.html#6.1.1.Kriptiranje"><span class="tocnumber">16</span> <span class="toctext">6.1.1.Kriptiranje</span></a></li>
<li class="toclevel-1 tocsection-17"><a href="EMV_protokol_u_kartičnom_poslovanju.html#6.1.2._Message_Authentication_Code_.28MAC.29"><span class="tocnumber">17</span> <span class="toctext">6.1.2. Message Authentication Code (MAC)</span></a></li>
<li class="toclevel-1 tocsection-18"><a href="EMV_protokol_u_kartičnom_poslovanju.html#6.1.3._Derivacija_sesijskog_klju.C4.8Da"><span class="tocnumber">18</span> <span class="toctext">6.1.3. Derivacija sesijskog ključa</span></a></li>
<li class="toclevel-1 tocsection-19"><a href="EMV_protokol_u_kartičnom_poslovanju.html#6.1.4._Opcija_.C4.8Deste_derivacije_sesijskog_klju.C4.8Da"><span class="tocnumber">19</span> <span class="toctext">6.1.4. Opcija česte derivacije sesijskog ključa</span></a></li>
<li class="toclevel-1 tocsection-20"><a href="EMV_protokol_u_kartičnom_poslovanju.html#6.1.5._Derivacija_Master_klju.C4.8Da"><span class="tocnumber">20</span> <span class="toctext">6.1.5. Derivacija Master ključa</span></a></li>
<li class="toclevel-1 tocsection-21"><a href="EMV_protokol_u_kartičnom_poslovanju.html#6.2._Simetri.C4.8Dni_algoritmi"><span class="tocnumber">21</span> <span class="toctext">6.2. Simetrični algoritmi</span></a></li>
<li class="toclevel-1 tocsection-22"><a href="EMV_protokol_u_kartičnom_poslovanju.html#6.2.1._Data_Encryption_Standard_.28DES.29"><span class="tocnumber">22</span> <span class="toctext">6.2.1. Data Encryption Standard (DES)</span></a></li>
<li class="toclevel-1 tocsection-23"><a href="EMV_protokol_u_kartičnom_poslovanju.html#6.2.2._Advanced_Encryption_Standard_.28AES.29"><span class="tocnumber">23</span> <span class="toctext">6.2.2. Advanced Encryption Standard (AES)</span></a></li>
<li class="toclevel-1 tocsection-24"><a href="EMV_protokol_u_kartičnom_poslovanju.html#6.3.Asimetri.C4.8Dni_mehanizmi"><span class="tocnumber">24</span> <span class="toctext">6.3.Asimetrični mehanizmi</span></a></li>
<li class="toclevel-1 tocsection-25"><a href="EMV_protokol_u_kartičnom_poslovanju.html#6.3.1._Digitalni_potpis_sa_oporavkom_poruke"><span class="tocnumber">25</span> <span class="toctext">6.3.1. Digitalni potpis sa oporavkom poruke</span></a></li>
<li class="toclevel-1 tocsection-26"><a href="EMV_protokol_u_kartičnom_poslovanju.html#6.4._Asimetri.C4.8Dni_algoritmi"><span class="tocnumber">26</span> <span class="toctext">6.4. Asimetrični algoritmi</span></a></li>
<li class="toclevel-1 tocsection-27"><a href="EMV_protokol_u_kartičnom_poslovanju.html#6.4.1._RSA"><span class="tocnumber">27</span> <span class="toctext">6.4.1. RSA</span></a></li>
<li class="toclevel-1 tocsection-28"><a href="EMV_protokol_u_kartičnom_poslovanju.html#6.4.2._Hash"><span class="tocnumber">28</span> <span class="toctext">6.4.2. Hash</span></a></li>
<li class="toclevel-1 tocsection-29"><a href="EMV_protokol_u_kartičnom_poslovanju.html#7._Zaklju.C4.8Dak"><span class="tocnumber">29</span> <span class="toctext">7. Zaključak</span></a></li>
<li class="toclevel-1 tocsection-30"><a href="EMV_protokol_u_kartičnom_poslovanju.html#8._Literatura"><span class="tocnumber">30</span> <span class="toctext">8. Literatura</span></a></li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id="1.Uvod"> <b>1.Uvod</b> </span></h2>
<p>EMV označava Europay, MasterCard i Visa, tri kompanije koje su originalno napravile standard. Standardom sada upravlja EMVCo, konzorcij s jednako podijeljenom kontrolom između Visa, MasterCard, JCB, American Express, China UnionPay i Discover 
</p><p>EMV je tehnički standard kartica za pametno plaćanje, terminala za plaćanje i automatiziranih blagajni koji ih prihvaćaju. EMV kartice su pametne kartice (također se nazivaju kartice s čipom ili IC kartice) koje pohranjuju podatke na integriranim krugovima umjesto magnetnih traka, iako mnoge EMV kartice imaju trake. Mogu biti kontaktne kartice koje se fizički moraju umetnuti u čitač, ili beskontaktne kartice koje se mogu čitati preko kratke udaljenosti koristeći radio frekvencijsku identifikaciju (RFID) tehnologiju. Kartice koje su u skladu s EMV standardom se često nazivaju čip i pin ili čip i potpis karticama, ovisno o načinu na koji se ovjeravaju prilikom korištenja. 
</p><p>Postoje standardi baziran na ISO/IEC 7816 za kontaktne kartice, i standardi bazirani na ISO/IEC 14443 za beskontaktne kartice (PayPass, PayWave, ExpressPay)
</p>
<h2> <span class="mw-headline" id="2._Autentikacija_podataka"> <b>2. Autentikacija podataka</b> </span></h2>
<h2> <span class="mw-headline" id="2.1._Stati.C4.8Dka_autentifikacija_podataka_SDA"> 2.1. Statička autentifikacija podataka SDA </span></h2>
<p>Lokalna statička autentifikacija podataka se vrši pomoću terminala koji koristi shemu digitalnog potpisa bazirano na tehnikama javnog ključa kako bi potvrdio legitimnost kritičnih ICC statičnih podataka. Ovo otkriva neautorizirane promjene podataka nakon personalizacije. 
</p><p>Jedina forma ovjeravanja offline statičkih podataka je Statička Ovjera (SDA – Static Data Authentication) koja verificira podatke koje identificira Application File Locator i opcionalno Static Data Authentication Tag List.
</p><p>SDA zahtjeva postojanje certificiranja, od strane jako sigurnih kriptografskih ustanova koje potpisuju javne ključeve izdavača. 
</p><p>Svaki terminal u skladu s ovom specifikacijom mora sadržavati odgovarajuću certifikaciju javnog ključa(eve) za svaku uporabu prepoznatu od strane terminala. 
</p><p>Ova specifikacija dopušta da više AID-ova (Application Identifier) dijele isti set certificiranih javnih ključeva. Odnos između podataka i kriptografskih ključeva je prikazan na slici 1.
</p><p><a href="http://security.foi.hr/wiki/index.php/Datoteka:Peroipetar.jpg" class="image"><img alt="Peroipetar.jpg" src="../images/f/fc/Peroipetar.jpg" width="753" height="535" /></a>
</p><p>Kako bi podržavao SDA, svaki terminal će biti u mogućnosti pohraniti šest certificiranih javnih ključeva po RID-u (Registered Application Provider Identifier) i povezat će se sa svakim takvim ključem povezanu ključ informaciju koja se koristi s ključem (tako da se terminali u budućnosti mogu podržavati višestruke algoritme i omoguće evolucijsku tranziciji od jednog do drugog). Terminal će biti u mogućnosti locirati takav ključ (i ključ povezane informacije) s obzirom na RID i certificiranja indeksa javnog ključa koje osigurava ICC.
</p>
<h2> <span class="mw-headline" id="2.2.Lokalna_Dinami.C4.8Dka_autentifikacija_podataka_DDA"> 2.2.Lokalna Dinamička autentifikacija podataka DDA </span></h2>
<p>Lokalnu dinamičku autentifikaciju podataka vrši terminal koristeći shemu digitalnog potpisa bazirano na tehnikama javnog ključa za autentificiranje ICC i potvrdu legitimnosti kritičnog ICC-stanovnik/generiranih podataka i podataka koji se primaju od terminala. To isključuje krivotvorenje bilo kakve kartice. 
</p><p>Postoje dva oblika lokalne dinamičke autentifikacije podataka:
Dinamička autentifikacija podataka (DDA – Dynamic Data Authentication) koja se vrši prije analize akcije kartice, gdje čip generira digitalni potpis na podatcima koji se nalaze na čipu identificiranih od strane ICC Dynamic Data i podataka primljenih od terminala identificiranih od strane DDOL (Dynamic Data Authentication Data Object List).
Dynamic Data Authentication/Application Cryptogram Generation izvršena na izdavanju prvog i drugog GENERATE AC naredbe. U slučaju Transaction Certificate (TC) ili Authorisation Request Cryptogram (ARQC), čip generira digiralni potpis na podatke koji se nalaze na čipu koje identificira ICC Dynamic Dana koji sadrži TC ili ARQC, i nepredviđeni broj kojeg generira terminal. 
</p><p>AIP označava opcije koje čip podržava.
</p><p>Lokalna dinamička autentikacija podataka zahtjeva postojanje certificiranja, od strane jako sigurnih kriptografskih ustanova koje potpisuju javne ključeve izdavača.  Svaki terminal u skladu s ovom specifikacijom sadržavat će prikladnu certifikaciju javnog ključa(eva) za svaku primjenu prepoznatu od terminala. Specifikacija dopušta više AID-ova da dijele isti set certificiranja javnih ključeva. Odnos između podataka i kriptografskih ključeva prikazan je na slici 2.
</p><p><a href="http://security.foi.hr/wiki/index.php/Datoteka:Jankec2.jpg" class="image"><img alt="Jankec2.jpg" src="../images/6/65/Jankec2.jpg" width="705" height="458" /></a>
</p><p>Kako bi podržavao SDA, svaki terminal će biti u mogućnosti pohraniti šest certificiranih javnih ključeva po RID-u (Registered Application Provider Identifier) i povezat će se sa svakim takvim ključem povezanu ključ informaciju koja se koristi s ključem (tako da se terminali u budućnosti mogu podržavati višestruke algoritme i omoguće evolucijsku tranziciji od jednog do drugog). Terminal će biti u mogućnosti locirati takav ključ (i ključ povezane informacije) s obzirom na RID i certificiranja indeksa javnog ključa koje osigurava ICC.
</p>
<h2> <span class="mw-headline" id="2.3.Kombinirana_dinami.C4.8Dka_autentifikacija_podataka.2F_Generiranje_aplikacijskog_kriptograma_CDA"> 2.3.Kombinirana dinamička autentifikacija podataka/ Generiranje aplikacijskog kriptograma CDA </span></h2>
<p>CDA se sastoji od dinamičnog potpisa kojeg generira čip (slično kao DDA li uključuje Application Cryptiogram (AC) generiranje) kojeg prati verificiranje potpisa od strane terminala. To je primjenjivo na obje prvu i drugu GENERATE AC naredbu i zahtjva pronalaženje relevantnih javnih ključeva. Budući da javni ključevi nisu potrebni sve dok se CDA potpis ne verificira kao dio procesuiranja odgovora na prvu GENERATE AC naredbu, pronalaženje javnih ključeva može se dogoditi u bilo koje vrijeme prije provjere CDA potpisa.  Prilikom pronalaženja javnih ključeva, pogreške mogu dovesti do neuspjeha CDA. U ovim greškama je uključen, ali nije ograničeno na neuspjeh pronalaženja javnog ključa i nevažećim formatima zapisa koje treba autentificirati. Za prvu GENERATE AC naredbu, i za drugu GENERATE AC naredbu u slučaju kada nije moguće ići u online obradu, tip kriptograma zahtjevan od strane terminala je uvijek određen od strane finalnog Terminal Action Analysis koji prethodi GENERATE AC naredbu. Kada se GENERATE AC naredba izda sa CDA zahtjevom, i ako se naknadno otkriju bilo koje gornje greške, eventualni rezultat će bili lokalna odbijenica
</p>
<h2> <span class="mw-headline" id="2.4.Enkripcija_osobnog_identifikacijskog_broja_.28PIN.29"> 2.4.Enkripcija osobnog identifikacijskog broja (PIN) </span></h2>
<p>Ako je podržano, osobni identifikacijski broj (PIN – Personal Identification Number) enkripcija za loklanu PIN verifikaciju se vrši od strane terminala koristeći asimetričnu bazu enkripcijskog mehanizma kako bi osigurao siguran transfer PIN-a od sigurne podloge za pin u čip. Preciznije, čip će posjedovati par javnih ključeva povezanih s enkripcijom PIN-a. Javni ključ se koristi od strane podloge za PIN ili sigurne komponente terminala (koja nije podloga za pin) kako bi se enkriptirao PIN za verifikaciju.
</p><p>Razmjena i provjera šifriranog PIN-a između terminala i čipa odvija se u sljedećim koracima.
</p><p>1.PIN se unosu u plaintext formatu na PIN podlogu i PIN blok je konstruiran
</p><p>2.Terminal izdaje GET CHALLENGE naredbu čipu kako bi dobio nepredviditi 8-bajtni nepredvidljiv broj sa čipa. Kada je odgovor na GET CHALLENGE naredbu bilo što drugo osim 8 bajtnog podatka s SW1 SW2 = '9000', onda terminal smatra da je lokalni šifrirani PIN CVM nije uspio. 
3.Terminal generira nasumičnu postavu koja se sastoji od N – 17 bajtova, gdje je N dužina javnog ključa u bajtovima koji će se koristiti za šifriranje PIN. Vrijednost nasumične postave bit će nepredvidljiva iz perspektive napadača (čak i sa znanjem prethodnih pokušaja) a prije šifriranja postojat će samo u hardveru sposobnom za čuvanje plaintext PIN-a. ZA svako šifriranje sve vrijednosti bi trebale imati jednaku šansu za generiranje. To se može postići koristeći generatorom slučajnih brojeva koji je u skladu s ISO/IEC 18031 i testiran koristeći NIST SP 800-22A.
</p><p>4.Koristeći PIN šifriranje javnog ključa ili dohvaćanje javnog ključa čipa, terminal primjenjuje RSA Recovery Function na podatke kako bi dobio šifrirane PIN podatke.
</p><p>5.Terminal izdaje VERIFY naredbu uključujući i šifrirane PIN podatke dobivene u prethodnom koraku.
</p><p>6.S privatnim ključem čipa, čip primjenjuje RSA Signing Function na šifrirane PIN podatke kako bi dobio natrag plaintext podatke.
</p><p>7.Čip verificira je li čipov nepredvidljivi broj kojeg je dobio natrag jednak onome koje je čip generirao s GET CHALLENGE naredbom. Ako nije, lokalni šifrirani PIN nije uspio.
</p><p>8.Čip verificira je li Dana Header kojeg je dobio natrag jednak '7F'. Ako nije, lokalni šifrirani PIN nije uspio.
</p><p>9.Čip verificira je li PIN uključen u obnovljenom PIN bloku odgovara PIN-u pohranjenom u čipu. Ako nije, verifikacija pina nije uspijela. 
</p><p>Ako su svi gornji koraci uspješno izvršeni, šifrirana PIN verifikacija je uspješna.
</p>
<h2> <span class="mw-headline" id="2.5.Aplikacijski_kriptogram_i_autentifikacija_izdava.C4.8Da_kartice"> 2.5.Aplikacijski kriptogram i autentifikacija izdavača kartice </span></h2>
<p><b>Generiranje aplikacijskog kriptograma</b> 
</p><p><i>Odabir podataka</i>
</p><p>Aplikacijski kriptogram sastoji se od Message Authentication Code (MAC) generiranog preko podataka referenciranih u čipovim DOLs i odašiljane s terminala na čip u GENERATE AC ili nekoj drugoj naredbi, i pristupljeno interno od strane čipa.
</p><p><i>Algoritam aplikacijskog kriptograma</i>
</p><p>Metoda za generiranje aplikacijskog kriptograma za ulaz uzima unikatni 16-bajtni čipov Application Cryptogram Master Key MKAC i podatke odabrane prema opisu u prethodnom odjeljku, i onda izračuna 8-bajtni aplikacijski kriptogram u dva koraka:
1. Uzme derivaciju sesije ključa da izvuče 16 – bajtni Application Cryptogram Session Key SKAC iz čipovog MKAC i čipov 2-bajtni Application Transaction Ccounter (ATC).
2. Generira 8-bajtni aplikacijski kriptogram primjenom MAC algoritma na podatke označene koristeći 16-bajtni Application Cryptogram Session Key izvućen u prethodnom koraku.
</p><p><br />
<b>Autentifikacija izdavača kartice</b>
</p><p>Podržane su dvije metode za generiranje ARPC koje koristi autentifikacija izdavača kartice.
</p><p><i>ARPC Metoda 1</i>
</p><p>ARPC Metoda 1 za generiranje 8-bajtnog ARPC sastoji se od primjene Triple-DES algoritma na:
- 8-bajtni ARQC kojeg čip generira
- 2-bajtni Authorisation Response Code (ARC)
</p><p>Koristeći 16-bajtni Application Cryptogram Session Key SKAC na sljedeći način:
1. Obložiti 2-bajtni ARC sa šest nul bajtova kako bi dobili 8-bajtni broj
X:=(ARC ||'00'||'00'||'00'||'00'||'00'||'00'||'00')
2. Izračunati Y:= ARQC + X. 
3. I onda dobijemo 8-bajtni ARPC&#160;:= DES3(SKAC)[Y]
</p><p><br />
<i>ARPC Metoda 2</i>
</p><p>ARPC Metoda 2 za generiranje –bajtnog ARPC sastoji se od primjene MAC algoritma na:
- 8-bajtni ARQC (kojeg čip generira)
- 4-bajtni binarni Card Status Update (CSU)
- 0-8 bajtni binarni Proprietary Authentication Data 
</p><p>Koristeći 16-bajtni Application Cryptogram seession key SKAC na sljedeći način:
1.Spojiti ARQC, CSU i Proprietary Authentication Dana
</p><p>Y:=ARQC || CSU || Proprietary Authentication Dana
</p><p>2. Generirati MAC preko podataka Y primjenom MAC algoritma na podatke definirane gore koristeći 16-bajtni Application Cryptogram Session Key izvedenog prilikom računanja ARQC. Za ovu primjenu MAC algoritma, MAC se računa prema  ISO/IEC 9797-1 Algoritam 3, a parametar s je postavljen na 4, time dajući 4-bajtni MAC
</p><p>ARPC&#160;:=MAC:=MAC algoritam(SKAC)[Y]
</p><p>3. Podaci za autentifikaciju izdavača kartice se formiraju spajajući rezultate 4-bajtne ARPC, 4-bajtne CSU i Proprietary Authentication Data. 
</p><p>Podaci za autentifikaciju izdavača kartice&#160;:= ARPC ||CSU ||Proprietary Authentication Data
</p>
<h2> <span class="mw-headline" id="2.6.Sigurno_komuniciranje_porukama"> 2.6.Sigurno komuniciranje porukama </span></h2>
<p>Ciljevi sigurnog slanja poruka su osiguravanje tajnosti podataka, integritet podataka i autenifikacija pošiljatelja. Integritet podataka i autentifikacija izdavača se postižu koristeći MAC. Povjerljivost podataka se postiže koristeći šifriranje polja podatka.
</p><p><b>Formati sigurnog komuniciranja porukama</b>
</p><p><i>Format 1</i>
</p><p>Sigurno komuniciranje porukama prema ISO/IEC 7816-4, gdje se polje podataka zahvaćenog naredbom koristi Basic encoding Rules – Tag Length Value (BER-TLV) šifriranje i pravila šifriranja ASN.11/ISO 8825-1 strogo primijeniti. 
</p><p><i>Format 2</i>
</p><p>Format sigurnog komuniciranja porukama gdje se polje podataka zahvaćeno naredbom ne okoristi BER-TLV šifriranje za sigurno komuniciranje porukama, ali ga može koristiti za druge svrhe. U ovom slučaju, objekti podataka zadržani u polju podataka su odgovarajućih dužina od ovih objekata podataka i bit će znani od pošiljatelja naredbe koristeći sigurno komuniciranje porukama i znat će ga trenutno oznažena aplikacija. U skladu je s ISO/IEC 7816-4.
</p>
<h2> <span class="mw-headline" id="3._Infrastruktura_javnog_klju.C4.8Da_izdavatelja_certifikata"> <b>3. Infrastruktura javnog ključa izdavatelja certifikata</b> </span></h2>
<h2> <span class="mw-headline" id="3.1..C5.BDivotni_ciklus_javnog_klju.C4.8Da"> 3.1.Životni ciklus javnog ključa </span></h2>
<p>Životni ciklus certificiranja javnog ključa u normalnim okolnostima može biti podijeljeno na sljedeće faze:
</p><p>- Planiranje 
</p><p>Tijekom faze planiranja, sustav za naplatu istražuje uvjete za uvođenje novih certificiranja javnih ključeva u bliskoj budućnosti. Ti uvjeti su povezani s brojem potrebnih ključeva i parametre tih ključeva. Važan dio faze planiranja e sigurnosni pregled kako bi se utvrdio životni vijek postojećih i novih ključeva. 
</p><p>- Generiranje
</p><p>Ako rezultati faze planiranja zahtijevaju uvođenje novih parova certificiranih javnih ključeva, njih će generirati sustav za naplatu. 
</p><p>- Distribucija
</p><p>U fazi distribucije ključeva, sustav za naplatu će distribuirati novo generirane certificirane javne ključeve svojim članovima.
</p><p>- Korištenje ključa
</p><p>Certificirani javni ključ se koristi u robnim terminalima za obavljanje lokalne statične ili dinamičke autentifikacije .
</p><p>- Opoziv (planirano)	
Kada par certificiranih javnih ključeva dosegne svoj planirani datum isteka postavljen u fazi planiranje, mora ga se maknuti iz uporabe.
</p>
<h2> <span class="mw-headline" id="5.Sigurnost_terminala_i_rukovanje_klju.C4.8Devima"> <b>5.Sigurnost terminala i rukovanje ključevima</b> </span></h2>
<p>Ovo poglavlje opisuje zahtjeve vezane za rukovanje terminala  osjetljivim podacima, kao što su kriptografski ključevi. Precizira zahtjeve za sigurnost tipkovnice za unošenje identifikacijskog broja i zahtjeve za rukovanje javnim ključevima za autorizaciju certifikata.
</p><p><b>FIZIČKA SIGURNOST</b>
</p><p>Siguran uređaj mora biti dizajniran tako da onemogućuje fizički pristup interno-spremljenim osjetljivim podacima i da onemogućuje krađu, ne autoriziranu upotrebu ili ne autoriziranu modifikaciju opreme. Navedeni ciljevi zahtijevaju otpornost, detekciju ili mehanizme zaštite kao što su vizualni ili zvučni alarmi.
</p><p>Siguran uređaj, kada ne obavlja nikakve operacije, ne bi smio sadržavati nikakve kriptografske ključeve ili druge osjetljive podatke (na primjer PIN-ove) koji su korišteni u nekoj od prethodnih transakcija. Probijanje u sistem može biti bez gubljenja sigurnosti tj. ne detektira ih uređaj, zato se takva probijanja moraju detektirati prije uređaja i prije nego što se kriptografski ključevi i osjetljivi podaci opet stave u operacijski sustav. Ako je uređaj dizajniran tako da je omogućen interni pristup, moraju se odmah osjetljivi podaci obrisati, čim dođe do probijanja u sistem. Sigurni uređaj je ovisan o fizičkoj sigurnosti što se tiče detekcije napada. Zato mora biti dizajniran tako da ima svojstva koja odmah vlasnika kartice ili trgovca upućuju na zločin.
</p><p>Uređaj mora biti dizajniran i sastavljen tako da se:
</p><p>-         Ne može izvesti probijanje u uređaj u smislu izvođenja nekim promjena, dodataka ili zamjena sklopovske i programske opreme uređaja; ili promjene osjetljivih podataka i naknadno ponovno instaliranje uređaja bez upotrebne posebnih vještina i uređaja koji nisu generalno dostupni, i bez oštećenja uređaja tako da se ne bi moglo detektirati oštećivanje.
-         Svaki neautorizirani pristup ili izmjena osjetljivih podataka, koji se unose, spremaju ili obrađuju, se pripisuje samo aktualnom probijanju uređaja.
-         Nije omogućeno na bilo kakav način krivotvorenje i izrađivanje sličnih komponenti od kojih je uređaj sastavljen.
-         Kvar na bilo kojem dijelu uređaja ne smije prouzročiti oštećivanje tajnih i osjetljivih podataka.
-         Ako je uređaj dizajniran tako da dijelovi mogu biti fizički odvojeni od uređaja, svako obrađivanje podataka između vlasnika kartice i tih odvojenih dijelova mora imati istu razinu sigurnosti kao što je ima i cijeli, ne rastavljeni uređaj.
-         Integriranje drugačijih dijelova uređaja u kućište sigurnog uređaja je nužan uvjet za izmjenu osjetljivih podataka kao što je PIN.
</p><p><b>LOGIČKA SIGURNOST</b>
</p><p>Siguran uređaj mora biti dizajniran tako da nijedna funkcija ili kombinacija funkcija ne prouzroči otkrivanje osjetljivih podataka, osim ako je to eksplicitno dozvoljeno od strane sigurnosti implementirane u terminalu. Logička zaštita mora uvijek štititi osjetljive podatke, pa i ako su samo upotrebljene legitimne funkcije. To svojstvo se može postići internim praćenjem statistike ili mjerenjem minimalnog vremena između poziva osjetljivih funkcija.
</p><p>Ako terminal može doći u osjetljivo stanje (stanje u kojem se mogu pozivati funkcije koje nisu omogućene u normalnom načinu rada, na primjer, korisničko rukovanje kriptografskim ključevima), takav prijenos mora biti dodatno nadgledan od dviju ili više povjerljivih strana. Ako je lozinka ili drugi tekstualni podaci upotrebljena kod kontrole prijenosa u osjetljivom stanju, unos te lozinke ili tekstualnih podataka mora biti zaštićen na način kao i ostali osjetljivi podaci.
</p><p>Za minimiziranje rizika koji rezultira ne autoriziranom upotrebom osjetljivih funkcija, osjetljivo stanje mora biti postignuto sa ograničenim brojem poziva funkcija (gdje je to prikladno) i vremenskim ograničenjem. Ako je neko od tih ograničenja postignuto, uređaj se mora vratiti u normalno stanje.
</p><p>Siguran uređaj mora automatski isprazniti svoje unutrašnje spremnike (buffers) na kraju svake transakcije ili u time-out situaciji.
</p>
<h2> <span class="mw-headline" id="5.1.Sigurnosni_zahtjevi_za_terminale"> 5.1.Sigurnosni zahtjevi za terminale </span></h2>
<p>Sigurni uređaji moraju u normalnom radnom okruženju osigurati da uređaj ili njegovo sučelje ne otkriva ili mijenja osjetljive podatke koji ulaze ili izlaze iz uređaja te koji su spremljeni ili se obrađuju u uređaju. 
</p><p>Kada siguran uređaj radi u sigurnosno-kontroliranom okruženju, zahtjevi za karakteristike uređaja su reducirani jer se zaštita provodi sigurnosno-kontroliranim okruženjem i rukovanjem uređaja.
</p><p><b>Tipkovnica za unos osobnog identifikacijskog broja (PIN Pad)</b>
</p><p>Tipkovnica za unos osobnog identifikacijskog broja mora biti siguran uređaj te mora podržavati unos 4-12 znamenki  osobnog identifikacijskog broja. Ako je priložen i ispis uz tipkovnicu (display), vizualna i/ili zvučna indikacija unošenja pojedinog broja mora biti prikazana. 
</p><p>Stvarne vrijednosti brojeva se ne smiju vidjeti, već se smiju vidjeti samo oznake da su brojevi uneseni.
</p><p>Kad terminal podržava off-line verifikaciju PIN-a, IFD (Interface Device) i tipkovnica za unos PIN-a mogu biti intergrirane u jedan uređaj ili IFD i tipkovnica mogu biti dva posebno odvojena uređaja.
</p><p>Ako su IFD i tipkovnica integrirani i offline PIN se šalje kartici u obliku teksta, tipkovnica ne kriptira offline PIN kada je tekstualni PIN poslan od tipkovnice do IFD-a.
</p><p>Ako su IFD i tipkovnica integrirani i offline PIN se šalje kartici u obliku teksta, ali offline PIN tekst nije poslan direktno od tipkovnice do IFD-a, tada tipkovnica mora kriptirati offline PIN za prijenos do IFD-a. U tom slučaju IFD dekriptira offline PIN za prijenos u tekstu do kartice.
</p><p>Ako IFD i tipkovnica nisu integrirani zajedno, a offline PIN se mora poslati kartici u tekstualnom obliku, tipkovnica mora kriptirati offline PIN za prijenos do IFD-a. U tom slučaju IFD dekriptira offline PIN za prijenos u tekstu do kartice.
</p><p>Ako se offline PIN šalje kartici u kriptiranom obliku, kriptiranje se provodi na:
</p><p>-         tipkovnici samog uređaja
</p><p>-         sigurnoj komponenti terminala
</p><p>Ako terminal podržava on-line verifikaciju PIN-a, kada je PIN unesen mora biti zaštićen kriptiranjem unutar terminala i terminal mora slati kriptirani PIN u skladu s pravilima sustava plaćanja.
</p><p><br />
Ispis prompt-a za unos PIN-a mora biti generiran od same tipkovnice. To znači da se mogu ispisivati sve vrste poruka koje su autorizirane od strane tipkovnice, a ne samo koje su u vezi s PIN-om. Tipkovnica mora odbiti ispis bilo kakve neautorizirane poruke.
</p><p><br />
Za praćene terminale, unos iznosa mora biti separiran od unosa PIN-a da bi se izbjeglo nesretno ispisivanje PIN-a na terminalu. Ako se PIN i iznos unose sa iste tipkovnice, iznos mora biti provjeren od vlasnika kartice prije nego što se unosi PIN.
</p><p><br />
Tipkovnica mora biti dizajnirana tako da štiti privatnost i tajnost, tako da u normalnoj upotrebi samo vlasnik može vidjeti informacije ispisane na zaslonu terminala. Tipkovnica mora biti tako ugrađena da vlasnik kartice može unijeti PIN sa minimalnim rizikom da su taj unos vidjeli drugi.
</p><p><br />
Tipkovnica mora isprazniti svoje unutrašnje spremnike u slijedećim uvjetima:
</p><p>-         pri završetku transakcije
</p><p>-         u time-out situaciji, uključujući neodređeni period vremena otkako je unesen PIN
</p>
<h2> <span class="mw-headline" id="5.2.Zahtjevi_za_rukovanje_klju.C4.8Devima"> 5.2.Zahtjevi za rukovanje ključevima </span></h2>
<p>U ovome poglavlju specificirani su zahtjevi za rukovanje javnim ključem izdavatelja certifikata (Certification Authority public key) od strane acquirera. Zahtjevi pokrivaju sljedeće faze:
</p><p><br />
</p><p><b>Objava CA javnog ključa u terminal</b>
</p><p>Kada se platni sustav odluči objaviti novi CA javni ključ, bitno je pokrenuti proces distribucije novog ključ prema svim acquirer-ima kako bi im bio na raspolaganju. Nakon toga, odgovornost je na acquirer-ima da ključ prenesu u do svakog terminala u svojoj mreži.
</p><p>Primjenjuju se sljedeća pravila kod prijenosa ključa od acquirera prema terminalima:
</p>
<ul><li> Terminal mora biti u mogućnosti verificirati da je zaprimio CA javni ključ bez ikakve greške
</li></ul>
<ul><li> Terminal mora biti u mogućnosti verificirati da je primljeni CA ključ dostavljen od strane legitimnog acquirer-a
</li></ul>
<ul><li> Acquirer mora biti u mogućnosti potvrditi da je novi CA ključ spušten uredno na sve terminale u njegovoj mreži
</li></ul>
<p><br />
</p><p><b>Pohrana CA javnog ključa u terminalu</b>
</p><p>Terminali koji podržavaju offline statičku ili dinamičku autentikaciju podataka morali bi biti u mogućnosti podržati šest CA javnih ključeva po RID za EMVCo člana debitne/creditne aplikacije bazirane na ovoj specifikaciji.
</p><p>Svaki CA javni ključ je jedinstveno identificiran sa 5 bajtnim RIDom koji identificira platni sustav i sa 1 bajtom indeksom CA javnog ključa.
</p><p>Integritet pohranjenog CA javnog ključa mora biti verificiran periodično.
</p><p><br />
</p><p><b>Korištenje CA javnog ključa u terminalu</b>
</p><p>U specifikaciji EMV book 2 navedeno je kako se mora koristiti CA javni ključ prilikom transakcije.
</p><p><br />
</p><p><b>Brisanje CA javnog ključa iz terminala</b>
</p><p>Kada platni sustav odluči povući svoj CA javni ključ, acquirer mora biti u mogućnosti osigurati da se ključ više ne može koristiti za offline statičnu i dinamičku autentikaciju podataka tokom transakcije nakon određenog datuma.
</p><p>Preporuka je da acquireri ne implementiraju datum isteka u terminale nego da jednostavno maknu ključeve prema datumu isteka koji odrede platni sustavi.
</p>
<h2> <span class="mw-headline" id="6._Sigurnosni_mehanizmi_i_algoritmi"> <b>6. Sigurnosni mehanizmi i algoritmi</b> </span></h2>
<h2> <span class="mw-headline" id="6.1.Simetri.C4.8Dni_mehanizmi"> 6.1.Simetrični mehanizmi</span></h2>
<h2> <span class="mw-headline" id="6.1.1.Kriptiranje"> 6.1.1.Kriptiranje</span></h2>
<p>Kod kriptiranja podataka kriptiraju se blokovi veličine n koristeći sljedeće načine kriptiranja(prema ISO/IEC 10116v standardu):
</p><p>Electronic Codebook - ECB 
</p><p><br />
</p><p>Cipher Block Chaining - CBC
</p><p><br />
</p>
<h2> <span class="mw-headline" id="6.1.2._Message_Authentication_Code_.28MAC.29"> 6.1.2. Message Authentication Code (MAC) </span></h2>
<p><b>MAC algoritam za 8 bajtni blok</b>
</p><p>Računanje s bajtnog MAC-a (4&lt;=s&lt;=8) vrši se prema ISO/IEC 9797-1 koristeći kriptirajući algoritam 8 bajtnog (64-bitnog) bloka kao što je 3DES u CBC-u.
</p><p><b>MAC algoritam za 16 bajtni blok</b>
</p><p>Računanje s bajtnog MAC-a (4&lt;=s&lt;=8) vrši se prema ISO/IEC 9797-1:2011 Algoritam 5 (CMAC) koristeći kriptirajući algoritam 16 bajtnog (128-bitnog) bloka kao što je AES u CBC-u.
</p>
<h2> <span class="mw-headline" id="6.1.3._Derivacija_sesijskog_klju.C4.8Da"> 6.1.3. Derivacija sesijskog ključa </span></h2>
<p>	Sesijski ključevi Ks deriviraju se iz jedinstvenog Master ključa Km mijenjajući podatke R na način:
</p><p>			Ks:= F(Km)[R]
</p><p>	Da se spriječe napadi ponavljanjem, promjena podataka R trebala bi imati veliku vjerojatnost razlike (podataka) u idućim sesijama derivacije ključa.
	Također, važan zahtjev za funkciju promjene podataka F je da su mogući rezultati funkcije dovoljno veliki i ravnomjerno raspoređeni kako bi spriječili iscrpnu potragu ključa na temelju sesijskog ključa.
</p>
<h2> <span class="mw-headline" id="6.1.4._Opcija_.C4.8Deste_derivacije_sesijskog_klju.C4.8Da"> 6.1.4. Opcija česte derivacije sesijskog ključa </span></h2>
<p>		Generira se jedinstveni sesijski ključ za svaku transakciju odrađenu od strane aplikacije. Vrši se kriptiranjem različite vrijednosti duljine n bajtova sa  Master ključem čipa kartice duljine k bitova kako bi dobili k bitni sesijski ključ čipa kartice (SK) koristeći n bajtni kriptirajući algoritam bloka podataka ECB-om.
</p><p>Isti sesijski ključ koristi se za sve komande u pojedinoj transakciji.
</p><p><br />		
</p>
<h2> <span class="mw-headline" id="6.1.5._Derivacija_Master_klju.C4.8Da"> 6.1.5. Derivacija Master ključa </span></h2>
<p>	Postoje tri opcionalne metode za derivaciju k bitnog ICC Master ključa od strane izdavača kartice, koji se koristi za generiranje aplikacijskog kriptograma, autentikaciju izdavača i sigurnu razmjenu poruka. Prve dvije metode koriste 8 bajtni blok kriptirajućeg algoritma 3DES u ECB-u dok treća metoda koristi 16 bajtni blok kriptirajućeg algoritma AES u ECB-u. Ona ujedno podržava u 128, 192 i 256 bitni ključ.
</p><p>	Ove metode nisu mandatorne nego su opcionalne te izdavači kartica mogu koristiti i alternativne metode za ovu funkciju.
</p><p>	Ove metode za ulaznu varijablu uzimaju PAN i PAN Sequence Number zajedno sa k bitnim Master ključem izdavača i kao rezultat daju k bitni Master ključ čipa kartice.
</p><p><br />
</p>
<h2> <span class="mw-headline" id="6.2._Simetri.C4.8Dni_algoritmi"> 6.2. Simetrični algoritmi </span></h2>
<h2> <span class="mw-headline" id="6.2.1._Data_Encryption_Standard_.28DES.29"> 6.2.1. Data Encryption Standard (DES) </span></h2>
<p>	3DES kritpirajući algoritam dvostruke duljine (ISO/IEC 18033-3) je odobreni kriptografski algoritam koji se koristi kod kriptiranja i MAC mehanizama gdje se koristi 8 bajtni blok. Algoritam se bazira na (single) DES algoritmu standardiziranom u ISO 16609.
</p><p>	3DES kriptiranje uključuje kriptiranje 8 bajtnog bloka čistog teksta u 8 bajtni kriptirani blok sa tajnim ključem dvostruke duljine (128 bita) K = (KL||KR)
</p><p>	Kriptiranje
	Y = DES3(K)[X] = DES(KL)[DES-1(KR)[DES(KL)[X]]]
</p><p>	Dekriptiranje
	X = DES-1(KL)[DES(KR)[DES-1(KL)[Y]]]
</p><p><br />
</p>
<h2> <span class="mw-headline" id="6.2.2._Advanced_Encryption_Standard_.28AES.29"> 6.2.2. Advanced Encryption Standard (AES) </span></h2>
<p>	AES kriptirajući algoritam je odobreni kriptografski algoritam koji se koristi kod kriptiranja i MAC mehanizama gdje se koristi 16 bajtni blok. Podržane duljne ključeva kod AESa su 128 bitni, 192 bitni i 256 bitni.
</p>
<h2> <span class="mw-headline" id="6.3.Asimetri.C4.8Dni_mehanizmi"> 6.3.Asimetrični mehanizmi</span></h2>
<h2> <span class="mw-headline" id="6.3.1._Digitalni_potpis_sa_oporavkom_poruke"> 6.3.1. Digitalni potpis sa oporavkom poruke </span></h2>
<p>	<b>Algoritmi</b>
</p><p>		Koriste se dvije vrste algoritma:
</p><p>	Reverzibilni asimetrični algoritam kojis se sastoji od potpisne funkcije Sign(SK)[] koji ovisi o privatnom ključu Sk i od povratne funkcije Recover(Pk)[] koja ovisi o javnom ključu Pk. Obje funkcije mapiraju n bajtne brojeve na n bajtne brojeve i imaju svojstvo povratne funkcije
</p><p>		Recover(Pk)[Sign(Sk)[X]] = X
		za bilokoj n bajtni broj X.
</p><p>	Hashing algoritam Hash[] koji mapira poruku proizvoljne duljine na 20 bajtni hash kod.
</p><p>	<b>Generiranje potpisa</b>
</p><p>Izračun potpisa S na poruci MSG sastoji se od proizvoljnog broja L od najmanje N-21 bajtova koji zauzima mjesto na sljedeći način:
</p><p>1) Izračunaj 20 bajtnu hash vrijednost H:= Hash[Msg] poruke M
</p><p>2) Razdvoji MSG u dva dijela MSG=(MSG1 || MSG2) gdje se MSG1 sastoji od N-22 bajtova veće vrijednosti, a MSG2 od ostalih bajtova manje vrijednosti
</p><p>			L - N + 22 bajta od MSG
</p><p>3) Definiraj bajt B:= '6A'
</p><p>4) Definiraj bajt E:= 'BC'
</p><p>5) Definiraj N bajtni blok X kao povezani lanac blokova B, MSG1, H, i E tako da:
</p><p><br />
X:=(B||MSG1||H||E)
</p><p><br />
6) Digitalni potpis S je tada definiran kao N bajtni broj 
</p><p><br />
				S:= Sign(Sk)[X]
</p><p><br />
</p><p><b>Verifikacija potpisa</b>
</p><p>Verifikacija potpisa odvija se na sljedeći način:
</p><p>1. Provjeri da li se digitalni potpis S sastoji od N bajtova
</p><p>2. Vrati N bajtni broj X iz digitalnog potpisa S:
</p><p><br />
X= Recover(Pk)[S]
</p><p><br />
3. Razdjeli X kao X=(B||MSG1||H||E) gdje je:
</p><p>B dužine jedan bajt
</p><p>H dužine 20 bajta
</p><p>E dužine jedan bajt
</p><p>MSG1 se sastoji od ostatka N-22 bajta
</p><p><br />
4. Provjeri da li je bajt B jednak '6A'
</p><p>5. Provjeri da li je bajt E jednak 'BC'
</p><p>6. Izračunaj MSG = (MSG1||MSG2) i provjeri da li je H = Hash[MSG]
</p><p><br />
Jedino ako su sve ove provjere uredne poruka je izvorna.
</p>
<h2> <span class="mw-headline" id="6.4._Asimetri.C4.8Dni_algoritmi"> 6.4. Asimetrični algoritmi </span></h2>
<h2> <span class="mw-headline" id="6.4.1._RSA"> 6.4.1. RSA </span></h2>
<p>	RSA kriptirajući algoritam je odobreni kriptografski algoritam koji se koristi kod kriptiranja i generiranja digitalnog potpisa. Jedin dozvoljene vrijednosti za eksponent javnog ključa su 3 i 2^16+1
</p><p>	Algoritam generira kriptogram ili digitalni potpis čija je duljina jednaka veličini korištenog modula. Obavezna gornja granica modula određena je u tablici28:
</p><p><br />
		Duljina Certification Authority Public Key Modula - NCA
		Dulina Issuer Public Key Modul - NI
		Duljina ICC Public Key Modulu - NIC
		Duljina ICC PIN Encipherment Public Key Modula - NPE
</p><p>		moraju zadovoljavati sljedeći odnos:
</p><p>		NIC&lt;=NI&lt;=NCA i NPE&lt;=NI&lt;=NCA
</p><p>	U izboru duljina modula javnog ključa, treba uzeti u obzir životni vijek ključa u odnosu na očekivani napredak u korištenju ključa tijekom životnog ciklusa. Rasponi (gornja i donja granica) za duljine ključa obvezujući od strane svakog od platnih sustava specificiraju se u njihovim odgovarajućim vlasničkim specifikacijama.
</p><p>	Vrijednost Issuer Public Key eksponenta i ICC Public Key eksponenta određuje izdavač kartice, a Certification Authority, Issuer i ICC Public Key eksponenti moraju biti jednaki 3 ili 2^16+1.
</p><p><br />	
	U nastavku će biti specificirani ključevi, potpisne i povratne funkcije RSA algoritma sa neparnim brojem u eksponentu.
</p><p>		<b>KLJUČEVI</b>
</p><p>			Privatni ključ SK RSA digitalnog potpisa sheme sa neparnim brojem u eksponentu javnog ključa e sastoji se od dva prosta broja p i q takvih da su p-1 i q-1 relativno prosti u odnosu na e i tajni eksponent d kao:
</p><p>	ed= 1 mod (p-1)(q-1)
</p><p>		Javni ključ Pk sastoji se od javnog modula n=pq i javnog eksponenta e.
</p><p>		<b>Potpisna funkcija</b>
</p><p>		Potpisna funkcija za RSA algoritam sa neparnim brojem u eksponentu javnog ključa e definirana je:
</p><p>		S = Sign(Sk)[X]&#160;:= X^d mod n, 0&lt;X&lt;n, 
</p><p>gdje je X skup podataka koji trebaju biti potpisani i S odgovarajući digitalni potpis.
</p><p><b>Povratna funkcija</b>
</p><p>Povratna funkcija RSA algoritma sa neparnim brojem u eksponentu javnog ključa e odgovara:
</p><p><br />		
X = Recover(Pj)[S]:= S^e mod n
</p><p><br />		
</p><p><br />	
		Platni sustavi i izdavači kartica moraju biti odgovorni za sigurnost njihovih procesa za generiranje RSA javnih/privatnih ključeva.
</p>
<h2> <span class="mw-headline" id="6.4.2._Hash"> 6.4.2. Hash </span></h2>
<p><b>Secure Hash Algoritham SHA-1</b>
</p><p>Ovaj algoritam standardiziran je u ISO/IEC 10118-3. SHA-1 pretvara ulaznu poruku proizvoljne duljine u 20 bajtnu hash vrijednost.
</p>
<h2> <span class="mw-headline" id="7._Zaklju.C4.8Dak"> <b>7. Zaključak</b> </span></h2>
<p>Od početka korištenja EMV standarda pa sve do danas isti je znatno napredovao, no nije u potpunosti zaživio u svim dijelovima svijeta. 
</p><p>Kako se broj transakcija tj. korištenje kartica kao platnih sredstava povećava tako se i budi svijest o potrebi za zaštitom korisnika. Zbog toga se velika većina kartičnih kuća odlučuje za uvođenje EMV standarda na svoje kartice jer s time dobivaju na sigurnosti poslovanja i povjerenju svojih korisnika, a i sebe osiguravaju od bespotrebnih gubitaka.
</p><p>EMV standard pokazao se kao najsigurniji u kartičnom poslovanju, ali potrebno ga je dodatno poboljšavati kako bi se zadržao korak ispred ljudi koji se bave krađom i malverzacijama u kartičnom poslovanju.
</p><p>Mjesta za napredak svakako ima, no bitno je zadržati zadovoljstvo i povjerenje korisnika te pratiti najviše tehničke standarde vezane za sigurnost.
</p>
<h2> <span class="mw-headline" id="8._Literatura"> <b>8. Literatura</b> </span></h2>
<p>EMV book 2 - Security and Key Management_v4.3 - preuzeto sa EMVCo www.emvco.com
</p><p>Materijali sa UL tečaja "EMV"
</p><p>Seminarski rad EMV standard, Aleksandar Radovan 
</p><p><a href="http://os2.zemris.fer.hr/pk/2003_radovan/" class="external free" rel="nofollow">http://os2.zemris.fer.hr/pk/2003_radovan/</a> - pristupano 20.01.2016.
</p>
<!-- 
NewPP limit report
Preprocessor node count: 119/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key sisds:pcache:idhash:8680-0!*!0!!hr!2!edit=0 and timestamp 20190203204235 -->
<div class="printfooter">
Dobavljeno iz "<a href="EMV_protokol_u_kartičnom_poslovanju.html">http://security.foi.hr/wiki/index.php/EMV_protokol_u_karti%C4%8Dnom_poslovanju</a>"</div>
				<!-- /bodytext -->
								<!-- catlinks -->
				<div id='catlinks' class='catlinks catlinks-allhidden'></div>				<!-- /catlinks -->
												<div class="visualClear"></div>
			</div>
			<!-- /bodyContent -->
		</div>
		<!-- /content -->
		<!-- header -->
		<div id="mw-head" class="noprint">
			
<!-- 0 -->
<div id="p-personal" class="">
	<h5>Osobni alati</h5>
	<ul>
					<li  id="pt-login"><a href="http://security.foi.hr/wiki/index.php?title=Posebno:Prijava&amp;returnto=EMV_protokol_u_karti%C4%8Dnom_poslovanju" title="Predlažemo Vam da se prijavite, ali nije obvezno. [o]" accesskey="o">Prijavi se</a></li>
			</ul>
</div>

<!-- /0 -->
			<div id="left-navigation">
				
<!-- 0 -->
<div id="p-namespaces" class="vectorTabs">
	<h5>Imenski prostori</h5>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="EMV_protokol_u_kartičnom_poslovanju.html"  title="Pogledaj sadržaj [c]" accesskey="c">Članak</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="http://security.foi.hr/wiki/index.php?title=Razgovor:EMV_protokol_u_karti%C4%8Dnom_poslovanju&amp;action=edit&amp;redlink=1"  title="Razgovor o stranici [t]" accesskey="t">Razgovor</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-variants" class="vectorMenu emptyPortlet">
		<h5><span>Inačice</span><a href="EMV_protokol_u_kartičnom_poslovanju.html#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->
			</div>
			<div id="right-navigation">
				
<!-- 0 -->
<div id="p-views" class="vectorTabs">
	<h5>Pogledi</h5>
	<ul>
					<li id="ca-view" class="selected"><span><a href="EMV_protokol_u_kartičnom_poslovanju.html" >Čitaj</a></span></li>
					<li id="ca-viewsource"><span><a href="http://security.foi.hr/wiki/index.php?title=EMV_protokol_u_karti%C4%8Dnom_poslovanju&amp;action=edit"  title="Ova stranica je zaštićena. Možete pogledati izvorni kod. [e]" accesskey="e">Vidi izvor</a></span></li>
					<li id="ca-history" class="collapsible "><span><a href="http://security.foi.hr/wiki/index.php?title=EMV_protokol_u_karti%C4%8Dnom_poslovanju&amp;action=history"  title="Ranije izmjene na ovoj stranici. [h]" accesskey="h">Vidi stare izmjene</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-cactions" class="vectorMenu emptyPortlet">
	<h5><span>Radnje</span><a href="EMV_protokol_u_kartičnom_poslovanju.html#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->

<!-- 2 -->
<div id="p-search">
	<h5><label for="searchInput">Traži</label></h5>
	<form action="http://security.foi.hr/wiki/index.php" id="searchform">
		<input type='hidden' name="title" value="Posebno:Traži"/>
				<input id="searchInput" name="search" type="text"  title="Pretraži ovaj wiki [f]" accesskey="f"  value="" />
		<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Kreni" title="Idi na stranicu s ovim imenom ako ona postoji" />
		<input type="submit" name="fulltext" class="searchButton" id="mw-searchButton" value="Traži" title="Traži ovaj tekst na svim stranicama" />
			</form>
</div>

<!-- /2 -->
			</div>
		</div>
		<!-- /header -->
		<!-- panel -->
			<div id="mw-panel" class="noprint">
				<!-- logo -->
					<div id="p-logo"><a style="background-image: url(../../images/osslogo.png);" href="../../wiki.html"  title="Glavna stranica"></a></div>
				<!-- /logo -->
				
<!-- navigation -->
<div class="portal" id='p-navigation'>
	<h5>Orijentacija</h5>
	<div class="body">
				<ul>
					<li id="n-mainpage-description"><a href="../../wiki.html" title="Posjeti glavnu stranicu [z]" accesskey="z">Glavna stranica</a></li>
					<li id="n-portal"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Portal_zajednice" title="O projektu, što možete učiniti, gdje je što">Portal zajednice</a></li>
					<li id="n-currentevents"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Novosti" title="O trenutačnim događajima">Aktualno</a></li>
					<li id="n-recentchanges"><a href="./Posebno:Nedavne_promjene.html" title="Popis nedavnih promjena u wikiju. [r]" accesskey="r">Nedavne promjene</a></li>
					<li id="n-randompage"><a href="./Posebno:Slučajna_stranica.html" title="Učitaj slučajnu stranicu [x]" accesskey="x">Slučajna stranica</a></li>
					<li id="n-help"><a href="./Pomoć:Pomoć.html" title="Mjesto za pomoć suradnicima.">Pomoć</a></li>
				</ul>
			</div>
</div>

<!-- /navigation -->

<!-- SEARCH -->

<!-- /SEARCH -->

<!-- TOOLBOX -->
<div class="portal" id="p-tb">
	<h5>Traka s alatima</h5>
	<div class="body">
		<ul>
					<li id="t-whatlinkshere"><a href="http://security.foi.hr/wiki/index.php/Posebno:%C5%A0to_vodi_ovamo/EMV_protokol_u_karti%C4%8Dnom_poslovanju" title="Popis svih stranica koje sadrže poveznice ovamo [j]" accesskey="j">Što vodi ovamo</a></li>
						<li id="t-recentchangeslinked"><a href="http://security.foi.hr/wiki/index.php/Posebno:Povezane_promjene/EMV_protokol_u_karti%C4%8Dnom_poslovanju" title="Nedavne promjene na stranicama na koje vode ovdašnje poveznice [k]" accesskey="k">Povezane stranice</a></li>
																																										<li id="t-specialpages"><a href="./Posebno:Posebne_stranice.html" title="Popis posebnih stranica [q]" accesskey="q">Posebne stranice</a></li>
									<li id="t-print"><a href="http://security.foi.hr/wiki/index.php?title=EMV_protokol_u_karti%C4%8Dnom_poslovanju&amp;printable=yes" rel="alternate" title="Verzija za ispis ove stranice [p]" accesskey="p">Verzija za ispis</a></li>
						<li id="t-permalink"><a href="http://security.foi.hr/wiki/index.php?title=EMV_protokol_u_karti%C4%8Dnom_poslovanju&amp;oldid=37972" title="Trajna poveznica na ovu verziju stranice">Trajna poveznica</a></li>
						</ul>
	</div>
</div>

<!-- /TOOLBOX -->

<!-- LANGUAGES -->

<!-- /LANGUAGES -->
			</div>
		<!-- /panel -->
		<!-- footer -->
		<div id="footer">
											<ul id="footer-info">
																	<li id="footer-info-lastmod"> Datum zadnje promjene na ovoj stranici: 09:04, 22. siječnja 2016.</li>
																							<li id="footer-info-viewcount">Ova stranica je pogledana 1.972 puta.</li>
																							<li id="footer-info-copyright">Sadržaji se koriste u skladu s <a href="http://creativecommons.org/licenses/by-sa/3.0/" class="external ">Creative Commons Attribution Share Alike</a>.</li>
															</ul>
															<ul id="footer-places">
																	<li id="footer-places-privacy"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Za%C5%A1tita_privatnosti" title="SIS Wiki:Zaštita privatnosti">Zaštita privatnosti</a></li>
																							<li id="footer-places-about"><a href="./SIS_Wiki:O_projektu_SIS_Wiki.html" title="SIS Wiki:O projektu SIS Wiki">O projektu SIS Wiki</a></li>
																							<li id="footer-places-disclaimer"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:General_disclaimer" title="SIS Wiki:General disclaimer">Odricanje od odgovornosti</a></li>
															</ul>
											<ul id="footer-icons" class="noprint">
					<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="../skins/common/images/cc-by-sa.png" alt="Creative Commons Attribution Share Alike" width="88" height="31" /></a>
					</li>
					<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<!-- /footer -->
		
<script src="../load.php%3Fdebug=false&amp;lang=hr&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if ( window.mediaWiki ) {
	mediaWiki.config.set({"wgCanonicalNamespace": "", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 0, "wgPageName": "EMV_protokol_u_kartičnom_poslovanju", "wgTitle": "EMV protokol u kartičnom poslovanju", "wgAction": "view", "wgArticleId": 8680, "wgIsArticle": true, "wgUserName": null, "wgUserGroups": ["*"], "wgCurRevisionId": 37972, "wgCategories": [], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": []});
}
</script>
<script>if ( window.mediaWiki ) {
	mediaWiki.loader.load(["mediawiki.util", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax"]);
	mediaWiki.loader.go();
}
</script>

<script>if ( window.mediaWiki ) {
	mediaWiki.user.options.set({"ccmeonemails":0,"cols":80,"contextchars":50,"contextlines":5,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,
	"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"hr","language":"hr","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;mediaWiki.loader.state({"user.options":"ready"});
}
</script>		<!-- fixalpha -->
		<script type="text/javascript"> if ( window.isMSIE55 ) fixalpha(); </script>
		<!-- /fixalpha -->
		<!-- Served in 0.389 secs. -->			</body>
</html>
