<!DOCTYPE html>
<html lang="hr" dir="ltr">
<head>
<meta charset="UTF-8" />
<title>Sustavi za detekciju napada (Suricata) - SIS Wiki</title>
<meta name="generator" content="MediaWiki 1.17.0" />
<link rel="shortcut icon" href="http://security.foi.hr/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="../opensearch_desc.php" title="SIS Wiki (hr)" />
<link rel="EditURI" type="application/rsd+xml" href="../api.php%3Faction=rsd" />
<link title="Creative Commons" type="application/rdf+xml" href="http://security.foi.hr/wiki/index.php?title=Sustavi_za_detekciju_napada_(Suricata)&amp;action=creativecommons" rel="meta" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-sa/3.0/" />
<link rel="alternate" type="application/atom+xml" title="SIS Wiki Atom izvor" href="../index.php%3Ftitle=Posebno:Nedavne_promjene&amp;feed=atom" />
<link rel="stylesheet" href="../load.php%3Fdebug=false&amp;lang=hr&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cskins.vector&amp;only=styles&amp;skin=vector&amp;*.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/wiki/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr ns-0 ns-subject page-Sustavi_za_detekciju_napada_Suricata skin-vector">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<!-- content -->
		<div id="content">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<!-- firstHeading -->
			<h1 id="firstHeading" class="firstHeading">Sustavi za detekciju napada (Suricata)</h1>
			<!-- /firstHeading -->
			<!-- bodyContent -->
			<div id="bodyContent">
				<!-- tagline -->
				<div id="siteSub">Izvor: SIS Wiki</div>
				<!-- /tagline -->
				<!-- subtitle -->
				<div id="contentSub"></div>
				<!-- /subtitle -->
																<!-- jumpto -->
				<div id="jump-to-nav">
					Skoči na: <a href="Sustavi_za_detekciju_napada_(Suricata).html#mw-head">orijentacija</a>,
					<a href="Sustavi_za_detekciju_napada_(Suricata).html#p-search">traži</a>
				</div>
				<!-- /jumpto -->
								<!-- bodytext -->
				<pre>TIM: Aleksandra Sobodić, Dario Supan, Ivanko Zekić
</pre>
<hr />
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Sadržaj</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Uvod"><span class="tocnumber">1</span> <span class="toctext">Uvod</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Sustavi_za_detekciju_napada_.28IDS.29"><span class="tocnumber">2</span> <span class="toctext">Sustavi za detekciju napada (IDS)</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Podjela_IDS_sustava_prema_razli.C4.8Ditim_kriterijima"><span class="tocnumber">2.1</span> <span class="toctext">Podjela IDS sustava prema različitim kriterijima</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Sustavi_za_sprje.C4.8Davanje_napada_.28IPS.29"><span class="tocnumber">3</span> <span class="toctext">Sustavi za sprječavanje napada (IPS)</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Podjela_IPS_sustava"><span class="tocnumber">3.1</span> <span class="toctext">Podjela IPS sustava</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Op.C4.87enito_o_Suricati"><span class="tocnumber">4</span> <span class="toctext">Općenito o Suricati</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="Sustavi_za_detekciju_napada_(Suricata).html#IDS.2FIPS"><span class="tocnumber">4.1</span> <span class="toctext">IDS/IPS</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Vi.C5.A1edretvenost"><span class="tocnumber">4.2</span> <span class="toctext">Višedretvenost</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Razvoj_i_zna.C4.8Dajke"><span class="tocnumber">4.3</span> <span class="toctext">Razvoj i značajke</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Korisnost_Suricate"><span class="tocnumber">4.4</span> <span class="toctext">Korisnost Suricate</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Glavne_zna.C4.8Dajke"><span class="tocnumber">5</span> <span class="toctext">Glavne značajke</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Vi.C5.A1edretvenost_2"><span class="tocnumber">5.1</span> <span class="toctext">Višedretvenost</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Statistika_performansi"><span class="tocnumber">5.2</span> <span class="toctext">Statistika performansi</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Protokol_automatske_detekcije"><span class="tocnumber">5.3</span> <span class="toctext">Protokol automatske detekcije</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Gzip_dekompresija"><span class="tocnumber">5.4</span> <span class="toctext">Gzip dekompresija</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Neovisna_HTP_biblioteka"><span class="tocnumber">5.5</span> <span class="toctext">Neovisna HTP biblioteka</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Standardne_ulazne_metode"><span class="tocnumber">5.6</span> <span class="toctext">Standardne ulazne metode</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Unified2_izlaz"><span class="tocnumber">5.7</span> <span class="toctext">Unified2 izlaz</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Tokovne_varijable"><span class="tocnumber">5.8</span> <span class="toctext">Tokovne varijable</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Brzo_IP_podudaranje"><span class="tocnumber">5.9</span> <span class="toctext">Brzo IP podudaranje</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="Sustavi_za_detekciju_napada_(Suricata).html#HTTP_Log_modul"><span class="tocnumber">5.10</span> <span class="toctext">HTTP Log modul</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Flowint"><span class="tocnumber">5.11</span> <span class="toctext">Flowint</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-23"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Podr.C5.BEane_platforme"><span class="tocnumber">6</span> <span class="toctext">Podržane platforme</span></a></li>
<li class="toclevel-1 tocsection-24"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Suricata_-_Prakti.C4.8Dni_dio"><span class="tocnumber">7</span> <span class="toctext">Suricata - Praktični dio</span></a></li>
<li class="toclevel-1 tocsection-25"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Suricata_pravila"><span class="tocnumber">8</span> <span class="toctext">Suricata pravila</span></a>
<ul>
<li class="toclevel-2 tocsection-26"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Akcija"><span class="tocnumber">8.1</span> <span class="toctext">Akcija</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Protokol"><span class="tocnumber">8.2</span> <span class="toctext">Protokol</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Izvor_i_odredi.C5.A1te"><span class="tocnumber">8.3</span> <span class="toctext">Izvor i odredište</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Portovi_.28izvori.C5.A1ni_i_odredi.C5.A1ni_port.29"><span class="tocnumber">8.4</span> <span class="toctext">Portovi (izvorišni i odredišni port)</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Smjer"><span class="tocnumber">8.5</span> <span class="toctext">Smjer</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Opcije_pravila"><span class="tocnumber">8.6</span> <span class="toctext">Opcije pravila</span></a>
<ul>
<li class="toclevel-3 tocsection-32"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Meta-postavke_.28eng._Meta-settings.29"><span class="tocnumber">8.6.1</span> <span class="toctext">Meta-postavke  (eng. Meta-settings)</span></a></li>
<li class="toclevel-3 tocsection-33"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Klju.C4.8Dne_rije.C4.8Di_korisnog_tereta_.28eng._Payload_keywords.29"><span class="tocnumber">8.6.2</span> <span class="toctext">Ključne riječi korisnog tereta (eng. Payload keywords)</span></a></li>
<li class="toclevel-3 tocsection-34"><a href="Sustavi_za_detekciju_napada_(Suricata).html#HTTP-klju.C4.8Dne_rije.C4.8Di_.28eng._HTTP-keywords.29"><span class="tocnumber">8.6.3</span> <span class="toctext">HTTP-ključne riječi (eng. HTTP-keywords)</span></a></li>
<li class="toclevel-3 tocsection-35"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Tokovne_klju.C4.8Dne_rije.C4.8Di_.28eng._Flow-keywords.29"><span class="tocnumber">8.6.4</span> <span class="toctext">Tokovne ključne riječi (eng. Flow-keywords)</span></a></li>
<li class="toclevel-3 tocsection-36"><a href="Sustavi_za_detekciju_napada_(Suricata).html#IP_reputacijska_pravila_.28eng._IP_Reputation_Rule.29"><span class="tocnumber">8.6.5</span> <span class="toctext">IP reputacijska pravila (eng. IP Reputation Rule)</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-37"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Klju.C4.8Dne_rije.C4.8Di_zaglavlja_.28eng._Header_keywords.29"><span class="tocnumber">8.7</span> <span class="toctext">Ključne riječi zaglavlja (eng. Header keywords)</span></a>
<ul>
<li class="toclevel-3 tocsection-38"><a href="Sustavi_za_detekciju_napada_(Suricata).html#IP-klju.C4.8Dne_rije.C4.8Di_.28eng._IP-keywords.29"><span class="tocnumber">8.7.1</span> <span class="toctext">IP-ključne riječi (eng. IP-keywords)</span></a></li>
<li class="toclevel-3 tocsection-39"><a href="Sustavi_za_detekciju_napada_(Suricata).html#TCP-klju.C4.8Dne_rije.C4.8Di_.28eng._TCP-keywords.29"><span class="tocnumber">8.7.2</span> <span class="toctext">TCP-ključne riječi (eng. TCP-keywords)</span></a></li>
<li class="toclevel-3 tocsection-40"><a href="Sustavi_za_detekciju_napada_(Suricata).html#ICMP-klju.C4.8Dne_rije.C4.8Di_.28eng._ICMP-keywords.29"><span class="tocnumber">8.7.3</span> <span class="toctext">ICMP-ključne riječi (eng. ICMP-keywords)</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-41"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Datote.C4.8Dne_klju.C4.8Dne_rije.C4.8Di_.28eng._File-keywords.29"><span class="tocnumber">8.8</span> <span class="toctext">Datotečne ključne riječi (eng. File-keywords)</span></a></li>
<li class="toclevel-2 tocsection-42"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Rule-thresholding"><span class="tocnumber">8.9</span> <span class="toctext">Rule-thresholding</span></a></li>
<li class="toclevel-2 tocsection-43"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Lua_skriptiranje"><span class="tocnumber">8.10</span> <span class="toctext">Lua skriptiranje</span></a></li>
<li class="toclevel-2 tocsection-44"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Dodavanje_vlastitih_pravila"><span class="tocnumber">8.11</span> <span class="toctext">Dodavanje vlastitih pravila</span></a></li>
<li class="toclevel-2 tocsection-45"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Live_Rule_Swap"><span class="tocnumber">8.12</span> <span class="toctext">Live Rule Swap</span></a></li>
<li class="toclevel-2 tocsection-46"><a href="Sustavi_za_detekciju_napada_(Suricata).html#TLS_klju.C4.8Dne_rije.C4.8Di"><span class="tocnumber">8.13</span> <span class="toctext">TLS ključne riječi</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-47"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Upravljanje_pravilima_pomo.C4.87u_Oinkmaster"><span class="tocnumber">9</span> <span class="toctext">Upravljanje pravilima pomoću Oinkmaster</span></a></li>
<li class="toclevel-1 tocsection-48"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Performanse"><span class="tocnumber">10</span> <span class="toctext">Performanse</span></a>
<ul>
<li class="toclevel-2 tocsection-49"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Konfiguracija_visokih_performansi"><span class="tocnumber">10.1</span> <span class="toctext">Konfiguracija visokih performansi</span></a></li>
<li class="toclevel-2 tocsection-50"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Fino_pode.C5.A1avanje_performansi"><span class="tocnumber">10.2</span> <span class="toctext">Fino podešavanje performansi</span></a></li>
<li class="toclevel-2 tocsection-51"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Statistike"><span class="tocnumber">10.3</span> <span class="toctext">Statistike</span></a></li>
<li class="toclevel-2 tocsection-52"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Profiliranje_paketa"><span class="tocnumber">10.4</span> <span class="toctext">Profiliranje paketa</span></a></li>
<li class="toclevel-2 tocsection-53"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Modovi_za_izvo.C4.91enje"><span class="tocnumber">10.5</span> <span class="toctext">Modovi za izvođenje</span></a></li>
<li class="toclevel-2 tocsection-54"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Tcmalloc"><span class="tocnumber">10.6</span> <span class="toctext">Tcmalloc</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-55"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Usporedba_Suricate_i_Snorta"><span class="tocnumber">11</span> <span class="toctext">Usporedba Suricate i Snorta</span></a>
<ul>
<li class="toclevel-2 tocsection-56"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Opis_testiranja"><span class="tocnumber">11.1</span> <span class="toctext">Opis testiranja</span></a></li>
<li class="toclevel-2 tocsection-57"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Op.C4.87i_pregled"><span class="tocnumber">11.2</span> <span class="toctext">Opći pregled</span></a></li>
<li class="toclevel-2 tocsection-58"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Okru.C5.BEenje"><span class="tocnumber">11.3</span> <span class="toctext">Okruženje</span></a></li>
<li class="toclevel-2 tocsection-59"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Metodologija"><span class="tocnumber">11.4</span> <span class="toctext">Metodologija</span></a></li>
<li class="toclevel-2 tocsection-60"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Rezultati_testova"><span class="tocnumber">11.5</span> <span class="toctext">Rezultati testova</span></a></li>
<li class="toclevel-2 tocsection-61"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Zaklju.C4.8Dak_testiranja_Suricata_vs_Snort"><span class="tocnumber">11.6</span> <span class="toctext">Zaključak testiranja Suricata vs Snort</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-62"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Zaklju.C4.8Dak"><span class="tocnumber">12</span> <span class="toctext">Zaključak</span></a></li>
<li class="toclevel-1 tocsection-63"><a href="Sustavi_za_detekciju_napada_(Suricata).html#Literatura"><span class="tocnumber">13</span> <span class="toctext">Literatura</span></a></li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id="Uvod"> Uvod </span></h2>
<p>Sve češće se pokazuje da se zaštita kontrolom pristupa, mrežnim barijerama i softverom za sprječavanje infekcije zlonamjernim programima (virusi, crvi, trojanki konj) nije dovoljna. Javlja se potreba da se sustav obrani i od napada koji su dobro maskirani i skriveni, te koji su uspjeli prodrijeti kroz sve ostale zaštitne mehanizme. Treba napomenuti da su bitni i napadi koji potječu iznutra, odnosno od zaposlenika u poduzeću. Ti napadači (eng. <i>insider</i>) samostalno ili u dogovoru s nekim napadačem izvana pokušavaju da ugroze sustav iz različitih motiva. Kao odgovor na ove probleme pojavili su se sustavi za otkrivanje odnosno detekciju upada u mreže (eng. <i>Intrusion Detection Systems</i>, IDS) i sustavi za sprječavanje ili prevenciju upada u mreže (eng. <i>Intrusion Prevention Systems</i>, IPS). Te dvije grupe zaštitnih sustava predmet su ovog rada.<br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Ivanko.Zekic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Ivanko.Zekic (stranica ne postoji)">Ivanko Zekić</a> 10:45, 10. siječnja 2013. (CET)
<br />
</p>
<h2> <span class="mw-headline" id="Sustavi_za_detekciju_napada_.28IDS.29"> Sustavi za detekciju napada (IDS) </span></h2>
<p>Napad se može definirati kao bilo koji skup akcija koji pokušava da naruši integritet, povjerljivost ili raspoloživost resursa. Sustav za detekciju napada provjerava dolazeći ili odlazeći promet i identificira sumnjive uzorke koji mogu ukazati na postojanje napada na mrežu ili računalni sustav. Napadi se mogu izvesti na različite načine, na primjer, pomoću zlonamjernih programa, iskorištavanjem raznih propusta u aplikacijama, slanjem paketa koje mrežna barijera propušta, a koji mogu iskoristiti ranjivost neke aplikacije (na primjer Web servera) ili običnim lažiranjem IP adresa. [Pleskonjić, Maček, Đorđević, Carić, 2007] <br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Ivanko.Zekic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Ivanko.Zekic (stranica ne postoji)">Ivanko Zekić</a> 11:08, 10. siječnja 2013. (CET)
</p>
<h3> <span class="mw-headline" id="Podjela_IDS_sustava_prema_razli.C4.8Ditim_kriterijima"> Podjela IDS sustava prema različitim kriterijima </span></h3>
<p>Sustavi za detekciju napada mogu se klasificirati na više načina, zavisno o kriterijima za klasifikaciju [Pleskonjić, Maček, Đorđević, Carić, 2007]: što se detektira, gdje je IDS sustav smješten, kada otkriva napad i kako reagira na napad.<br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Ivanko.Zekic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Ivanko.Zekic (stranica ne postoji)">Ivanko Zekić</a> 11:16, 10. siječnja 2013. (CET)
</p>
<h2> <span class="mw-headline" id="Sustavi_za_sprje.C4.8Davanje_napada_.28IPS.29"> Sustavi za sprječavanje napada (IPS) </span></h2>
<p>Mrežne barijere i antivirusni programi pokušavaju blokirati napade, IDS pokušava identificirati napad dok je u tijeku, odnosno dok se događa. Ove tehnike su izuzetno bitne za obranu sustava, ali imaju određena ograničenja. Mrežna barijera može zaustaviti servis blokirajući određene portove, ali ne može ocijeniti promet koji koristi dozvoljene (otvorene) portove. Sam IDS može ocijeniti, odnosno analizirati promet koji prolazi kroz ove otvorene portove, ali ga ne može zaustaviti. Ovdje dolazimo do IPS koji može proaktivno blokirati napade.<br />
IDS sustavi zasnovani na potpisima, koncentrirani su na to kako napad radi odnosno kako se izvodi. U slučaju da napadač unese minimalne izmjene u napad pomoću različitih tehnika za izbjegavanje IDS-a, prethodno formirani potpisi neće više moći otkriti napad. IPS se zbog toga fokusira na to što napad radi, što je relativno nepromjenjivo. IPS sustavi ne predstavljaju ništa revolucionarno na području sigurnosti već oni samo integriraju postojeće sigurnosne tehnologije u jedan cjelovit sustav. IPS sustavi po svojoj prirodi sprječavaju poznate napade. Nove napade, koji su nepoznati, treba prvo identificirati i analizirati, pa na temelju toga napraviti potpis, tj. oznaku koja će biti dodana u bazu IPS sustava kako bi se omogućila detekcija napada. Jedan od osnovnih zahtjeva  koji se predstavljaju pred svaki budući IPS sustav je da obuhvaća i sprječava poznate i nepoznate napade na računalne sustave i mreže.<br />
Osim same detekcije poznatih napada na osnovu potpisa, IPS sustavi sadrže algoritme za otkrivanje napada na osnovu definiranih sigurnosnih politika i anomalija u sustavu. Osim detekcije napada od sustava za sprječavanje napada se očekuje da osigura automatizirani odgovor kojim će se spriječiti daljni tok napada. Sprječavanje napada najčešće se svodi na prekidanje veze sa onih adresa na kojima su primijećene zlonamjerne aktivnosti. [Pleskonjić, Maček, Đorđević, Carić, 2007]<br />
Osnovne funkcije IPS sustava su sljedeće [Pleskonjić, Maček, Đorđević, Carić, 2007]:<br />
- identifikacija neovlaštenih aktivnosti na osnovu potpisa<br />
- identifikacija neovlaštenih aktivnosti na osnovu detektiranih anomalija<br />
- vođenje evidencije i/ili slanje upozorenja administratorima zaduženim za sigurnost u realnom vremenu<br />
- prikupljanje forenzičkih podataka o detektiranim napadima<br />
- sprječavanje napada<br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Ivanko.Zekic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Ivanko.Zekic (stranica ne postoji)">Ivanko Zekić</a> 11:46, 10. siječnja 2013. (CET)
</p>
<h3> <span class="mw-headline" id="Podjela_IPS_sustava"> Podjela IPS sustava</span></h3>
<p>IPS sustavi se dijele na dva osnovna tipa [Pleskonjić, Maček, Đorđević, Carić, 2007]:<br />
1. IPS sustavi smješteni na računalu, koji štite računalo (eng. <i>host based IPS</i>, HIPS)<br />
2. mrežni IPS sustavi (eng. <i>network based IPS</i>, NIPS)<br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Ivanko.Zekic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Ivanko.Zekic (stranica ne postoji)">Ivanko Zekić</a> 11:51, 10. siječnja 2013. (CET)
</p>
<h2> <span class="mw-headline" id="Op.C4.87enito_o_Suricati"> Općenito o Suricati </span></h2>
<p><a href="http://security.foi.hr/wiki/index.php/Datoteka:Suricata.png" class="image"><img alt="Suricata.png" src="../images/9/94/Suricata.png" width="361" height="300" /></a><br />
<b>Suricata je IPS/IDS (eng. <i>Intrusion Prevention System/Intrusion Detection System</i>)</b> sustav otvorenog programskog koda, te je razvijen od strane Open Information Security fondacije (OISF). Beta verzija je puštena u prosincu 2009, a u srpnju 2010. godine se pušta prva standardna verzija Suricate, odnosno sustava za otkrivanje i sprječavanja napada.<br />
Suricata mehanizam spada u tzv. sljedeću generaciju mehanizama otvorenog koda za otkrivanje i sprječavanje napada. Ovaj alat nije napravljen u svrhe da zamijeni ili imitira postojeće alate u informatičkoj industriji već da iznese nove ideje i tehnologije na području informatike <a href="http://www.openinfosecfoundation.org/index.php/download-suricata" class="external autonumber" rel="nofollow">[1]</a>. <br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Aleksandra.sobodic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Aleksandra.sobodic (stranica ne postoji)">Aleksandra Sobodić</a> 17:45, 9. siječnja 2013. (CET)
</p>
<h3> <span class="mw-headline" id="IDS.2FIPS"> IDS/IPS </span></h3>
<p>Suricata se temelji na pravilima ID/IP mehanizma koji koristi vanjski razvijene setove pravila kako bi pratio mrežni promet i upozorio administratora sustava na sumnjive događaje. Dizajnirana je na način da bude kompatibilna s već postojećim mrežno-sigurnosnim komponentama. Suricata sadrži jedinstvenu izlaznu funkcionalnost i mogućnost priključivanja biblioteka kako bi prihvatila pozive iz drugih aplikacija. Prvotno izdanje Suricate može se pokretati na Linux 2.6 platformi koja podržava ugrađenu i pasivnu konfiguraciju za praćenje prometa, te koja je sposobna nositi se i s više gigabitnim razinama prometa. Linux 2.4 može isto podržavati Suricatu, ali sa smanjenim konfiguracijskim funkcionalnostima poput ugrađene opcije. Dostupna ispod verzije 2 Opće javne licence (General Public Licence), Suricata eliminira troškove ID/PS mehanizma i osigurava skalabilnu opciju za većinu kompleksnih sigurnosno mrežnih arhitektura. <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/What_is_Suricata" class="external autonumber" rel="nofollow">[2]</a><br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Aleksandra.sobodic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Aleksandra.sobodic (stranica ne postoji)">Aleksandra Sobodić</a> 17:45, 9. siječnja 2013. (CET)
</p>
<h3> <span class="mw-headline" id="Vi.C5.A1edretvenost"> Višedretvenost </span></h3>
<p>Suricata kao višedretveni mehanizam nudi veću brzinu i efikasnost prilikom analiziranja mrežnog prometa. Uz hardversku akceleraciju (uzimajući u obzir ograničenja hardvera i mrežne kartice), mehanizam je napravljen kako bi se mogla iskoristiti povećana procesorska snaga koju nude zadnji višejezgreni  CPU sa čip-setovima. Suricatina implementacija je vrlo jednostavno i popraćena korak-po-korak dokumentacijom i korisničkim priručnikom.<a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/What_is_Suricata" class="external autonumber" rel="nofollow">[3]</a><br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Aleksandra.sobodic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Aleksandra.sobodic (stranica ne postoji)">Aleksandra Sobodić</a> 17:45, 9. siječnja 2013. (CET)
</p>
<h3> <span class="mw-headline" id="Razvoj_i_zna.C4.8Dajke"> Razvoj i značajke </span></h3>
<p>Cilj prve faze razvoja Suricata projekta je bio da se ostvari distributivan i funkcionalan IDS/IPS mehanizam. Mehanizam podržava i omogućava sljedeće funkcionalnosti:  zadnji Snort VRT, Snort prijavljivanje, pravilo jezičnih mogućnosti, višedretvenost, hardverska akceleracija (s ovisnostima i ograničenjima hardvera i mrežne kartice), jedinstveni izlaz koji omogućuje interakciju sa sustavom za upravljanje s vanjskim zapisima, IPv6, IP reputacija bazirana na pravilima, biblioteke s mogućnošću priključka za interakciju s drugim aplikacijama, izvođenje statističkih izlaza i jednostavan početnički korisnički priručnik.
Uključivanjem otvorenog programskog koda u zajednicu i omogućavajući joj vodeći IDS/IPS set pravila dostupnim, OISF je izgradio Suricatin mehanizam kako bi pojednostavio proces održavanja optimalne razine sigurnosti. Kroz strateška partnerstva, OISF utječe na stručnost prijetnji (eng. Emerging Threats – www.emergingthreats.net) i druge istaknute resurse u industriji osiguravajući pritom najnovije i sveobuhvatne setove pravila dostupnima. <br />
<b>HTP biblioteka</b> je HTTP normalizator i parser koju je napisao Ivan Ristić tvorac Mod Security za OISF. Ova biblioteka integrira i pruža vrlo naprednu obradu HTTP tokova za Suricatu. HTP biblioteka je potrebna ovom mehanizmu, ali se može koristiti i neovisno o njemu na širokom rasponu aplikacija i alata.<a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/What_is_Suricata" class="external autonumber" rel="nofollow">[4]</a>  <br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Aleksandra.sobodic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Aleksandra.sobodic (stranica ne postoji)">Aleksandra Sobodić</a> 17:46, 9. siječnja 2013. (CET)
</p>
<h3> <span class="mw-headline" id="Korisnost_Suricate">Korisnost Suricate</span></h3>
<p>Postoji nekoliko  razloga za korištenje Suricate, višedretvenog programa za nadziranje mrežnog prometa:
</p><p><b>1. Visoka skalabilnost </b><a href="http://suricata-ids.org/" class="external autonumber" rel="nofollow">[5]</a><br />
Suricata je (multi) višedretvena. To znači da se može pokrenuti jedna instanca koja će uravnotežiti opterećenje obrade kroz svaki procesor na senzor Suricate koja je ovisno o tome konfigurirana za korištenje. To omogućuje da komad hardvera postigne, odnosno dosegne 10 gigabita brzine u stvarnom prometu bez žrtvovanja skupih pravila za pokrivenost.
</p><p><b>2. Identifikacija protokola </b> <a href="http://suricata-ids.org/" class="external autonumber" rel="nofollow">[6]</a><br />
Suricata automatski prepoznaje najčešće korištene protokole već pri samom pokretanju novoga prijenosa (eng. <i>stream</i>), omogućavajući onom koji piše pravila za protokole da ih odmah napiše, a ne da prije toga čeka na pristup (eng. <i>port</i>) i to čini Suricatu „<i>Malware Command &amp; Control Channel Hunter</i>“. Prekid pristupa HTTP CnC kanala, koji se inače normalno prikazuju od strane većine IDS sustava, su dječja igra za Suricatu. Nadalje, zahvaljujući određenim ključnim riječima može se odgovarati na područje protokola koje se kreće od http URI do SSL identifikatora certifikata.
</p><p><b>3. Identifikacija datoteka, MD5 kontrolne sume (eng. <i>Checksums</i>) i otpakiravanje datoteka </b><a href="http://suricata-ids.org/" class="external autonumber" rel="nofollow">[7]</a><br />
Suricata može identificirati tisuće vrsta datoteka prilikom prolaska kroz određenu mrežu. Ne samo da ih se može identificirati već korisnik može odlučiti da li želi dublje istražiti, odnosno želi li ih označiti za otpakiravanje. U tom slučaju će se određena datoteka zapisati na disk zajedno s meta podacima koji opisuju zatečeno stanje i protok. Datotečna MD5 kontrolna suma se izračunava u tijeku prijenosa na način da ako se ima popis MD5 <i>hasheova</i> koje korisnik želi zadržati u svojoj mreži ili se želi zaštiti od njih, Suricata ih može naći.
</p><p><b>4. IDS/IPS (sustav za otkrivanje i sprječavanja napada) </b><a href="http://suricata-ids.org/features/" class="external autonumber" rel="nofollow">[8]</a><br />
Suricata implementira kompletni signaturni jezik kako bi prepoznala poznate prijetnje, kršenje pravila i zlonamjerno ponašanje. Suricata će također otkriti mnoge nepravilnosti u prometu kojeg nadzire. Suricata je sposobna koristiti specijaliziran skup pravila za nastale prijetnje (eng. Emerging Threats) i VRT skup pravila.
</p><p><b>5. Visoke perfomanse </b><a href="http://suricata-ids.org/features/" class="external autonumber" rel="nofollow">[9]</a><br />
Jedna Suricatina instanca je sposobna nadzirati multi-gigabitski promet. Jezgra je izgrađena kao multidretvena,  moderna, čista, a kod baze je visoko skalabilan. Posjeduje i podršku za hardversko ubrzanje od nekoliko dobavljača  i kroz PF_RING i AF_PACKET. Eksperimentalni GPU akcelerator prenosi neke CPU intenzivne zadaće na grafičku karticu.
</p><p><b>6. Automatska detekcija protokola </b><a href="http://suricata-ids.org/features/" class="external autonumber" rel="nofollow">[10]</a><br />
Suricata će automatski detektirati protokole kao što su HTTP na bilo kojem portu i primijenit će odgovarajuću detekciju i logiku prijave. To uvelike pomaže u pronalaženju malicioznog koda  i CnC kanala.
</p><p><b>7. Nadgledanje mrežne sigurnosti - NSM (eng. Network Security Monitoring): Više od IDS-a </b><a href="http://suricata-ids.org/features/" class="external autonumber" rel="nofollow">[11]</a><br />
Suricata može prijaviti HTTP zahtjeve, prijavljivati i trgovati TLS certifikatima, otpakiravati datoteke iz tokova, te ih pohraniti na disk. Cijela pcap (eng. <i>Packet capture</i>) podrška dozvoljava i omogućuje laganu analizu. Sve navedeno čini Suricatu snažnim mehanizmom za nadgledanje mrežne sigurnosti (NSM) ekosustava.
</p><p><b><i>TLS / SSL evidencija i analiza </i>:</b> Ne samo da se može uskladiti s većinom aspekata SSL/TLS razmjene unutar jezičnog skupa pravila zahvaljujući Suricatovom TLS parseru, već se također mogu evidentirati sve razmjene ključa u svrhu analize. To je zapravo odličan način osiguranja mreže od toga da postane žrtva slabo renomiranih potvrda.
</p><p><b><i>HTTP evidentiranje</i>:</b> Zašto dodati više hardvera u vlastitu mrežu samo da bi se prijavila http aktivnost kada se pomoću IDS već to vidi? Suricata će prijaviti sve HTTP veze na bilo koji port kako bi pridonijela kasnijoj analizi.
</p><p><b>8. Lua skriptiranje </b><a href="http://suricata-ids.org/features/" class="external autonumber" rel="nofollow">[12]</a><br />
Napredna analiza i funkcionalnost dostupna za otkrivanje stvari nije moguća bez sintaksnog skupa pravila.
</p><p><b>9. Industrijski standardni izlazi </b><a href="http://suricata-ids.org/features/" class="external autonumber" rel="nofollow">[13]</a><br />
Putem Unified2 izlaznog formata i Barnyard2 alata, Suricata se može koristiti s BASE, Snorby, Sguil, SQueRT i drugim sličnim alatima.
</p><p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Ivanko.Zekic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Ivanko.Zekic (stranica ne postoji)">Ivanko Zekić</a> 17:43, 9. siječnja 2013. (CET)
</p>
<h2> <span class="mw-headline" id="Glavne_zna.C4.8Dajke">Glavne značajke</span></h2>
<h3> <span class="mw-headline" id="Vi.C5.A1edretvenost_2">Višedretvenost</span></h3>
<p>Zapravo,korištenje višedretvenosti u sustavima za otkrivanje napada predstavlja novitet na tom području. Obrada paketa se odvija unutar jedne ili više dretvi. Dretve koriste jednu ili više dretvenih modula prilikom toga. Dretve imaju u ulaznom redu rukovatelja i u izlaznom redu rukovatelja. Oni se koriste prilikom preuzimanja paketa od drugih dretvi ili iz globalnog bazena paketa. Dretva se može postaviti tako da ostane na CPU/jezgri. Dretveni moduli su pohranjeni u <i>ThreadVars</i> strukturi. Trenutačno postoji kod za posjedovanje dretve s 1,2,3 ili varijabilnim brojem modula. Postoji velika vjerojatnost da će na kraju ostati samo varijabilan kod. Kreirana dretva pod nazivom „<i>Detect1</i>“ pokupi pakete iz reda „<i>stream-queue1</i>“ te pritom koristi za to rukovatelja redom „<i>simple</i>“. Nakon što se paket obradi stavlja se u red „<i>verdict-queue</i>“ pomoću rukovatelja redom „<i>simple</i>“. Tip dretve je <i>1slot</i> što znači da samo jedan modul može biti korišten. Modul „<i>Detect</i>“ je postavljen kao slot funkcija s unaprijed postavljenim kontekstom detekcijskog mehanizma kao pokazivača.<br />
</p><p><b>Opis modula dretve</b> kaže da modul dretve definira jedinicu paketa za obradu. Modul može svašta raditi od nabavke paketa preko dekodiranja i detekcije do upozoravanja. Jedan ili više tih modula mogu biti pokrenuti unutar dretve. Modul može proizvesti više od jednog paketa za izlaz npr. u tunelu dekodiranje ili u NFQ stječu module koji mogu čitati više od jednog paketa iz kernela po čitanju.<br />
<b>Opis reda</b> kaže da ako više dretvi se koristi prilikom serijske obrade paketa, redovi se koriste kako bi se ti paketi transferirali. Dretve imaju funkciju rukovatelja redom kako bi se utvrdio način na koji se paket pribavio i/ili iskopao. Najjednostavnijim riječima ovo je FIFO red. Prvi red uvijek predstavlja „bazen paketa“, odnosno bazen unaprijed alociranih paketa. Zadnji red je također bazen paketa, pa se tako paketi vraćaju na njega.<br />
<b>Opis rukovatelja redom</b> kaže da funkcija rukovatelja redom se poziva od strane dretve kako bi ona stekla ili kako bi se riješila paketa od prethodne ili sljedeće dretve. Najjednostavniji rukovatelj se naziva „simple“ i on jest FIFO rukovatelj. Mogu biti razvijeni i komeplesniji primjeri rukovatelja redom kao što je npr. razdvajanje IPv4 i IPv6 paketa, te njihovo slanje različitim putevima. <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Multi_Threading" class="external autonumber" rel="nofollow">[14]</a> <br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Aleksandra.sobodic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Aleksandra.sobodic (stranica ne postoji)">Aleksandra Sobodić</a> 21:25, 11. siječnja 2013. (CET)
</p>
<h3> <span class="mw-headline" id="Statistika_performansi">Statistika performansi</span></h3>
<p>Postoje dvije osnovne komponente kod izvođenja statistike performansi. Prvo, modul doista broji stavke, kao što <i>stream</i> modul broji nove <i>streamove</i>/sek. A kao drugo postoji modul koji skuplja sva ta stanja i čini ih dostupnima administratoru na određeni način (<i>log</i>, <i>snmp msg</i>, itd.) Statistika performansi mehanizma koja se prikuplja: <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Performance_Statistics" class="external autonumber" rel="nofollow">[15]</a>
</p><p>• bajtovi/sek <br />
• paketi/sek <br />
• novi tok/sek <br />
• trajanje toka <br />
• veličina toka <br />
• novi <i>stream</i>/sek <br />
• trajanje <i>stream</i> <br />
• veličina <i>stream</i> <br />
• upozorenja/sek <br />
• prekid protokola <br />
• ispušteni paketi <br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Aleksandra.sobodic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Aleksandra.sobodic (stranica ne postoji)">Aleksandra Sobodić</a> 21:25, 11. siječnja 2013. (CET)
</p>
<h3> <span class="mw-headline" id="Protokol_automatske_detekcije">Protokol automatske detekcije</span></h3>
<p>Mehanizam ima ključne riječi za IP, TCP, UDP i ICMP, ali i za HTTP, TLS, FTP i SMB. Korisnik prema tome može napisati pravilo koje će uočiti podudarnost unutar HTTP <i>streama</i>, npr. bez obzira na port stream se nastavlja odvijati. To će revolucionizirati detekciju i kontrolu malicioznog koda. U budućnosti se planira napraviti detekcija za još više slojeva protokola. <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Automatic_Protocol_Detection" class="external autonumber" rel="nofollow">[16]</a> <br />
</p>
<h3> <span class="mw-headline" id="Gzip_dekompresija">Gzip dekompresija</span></h3>
<p>HTP parser će dekodirati Gzip kompresirane streamove, dozvoljavajući još više detaljnijih podudaranja unutar mehanizma. <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Gzip_Decompression" class="external autonumber" rel="nofollow">[17]</a> <br />
</p>
<h3> <span class="mw-headline" id="Neovisna_HTP_biblioteka">Neovisna HTP biblioteka</span></h3>
<p>HTP parser će biti vrlo koristan i mnogim drugim aplikacijama poput proxyjima, filterima, itd. Parser je dostupan kao biblioteka također i pod GPLv2 zbog lakše integracije u druge alate. <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Independent_HTP_Library" class="external autonumber" rel="nofollow">[18]</a>
</p>
<h3> <span class="mw-headline" id="Standardne_ulazne_metode">Standardne ulazne metode</span></h3>
<p>Korisnik može koristiti NFQueue, IPFRing i standardni LibPcap za hvatanje prometa. Iz Suricate najavljuju i skoro pojavljivanje IPFW podrške.
<a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Standard_Input_Methods" class="external autonumber" rel="nofollow">[19]</a>
</p>
<h3> <span class="mw-headline" id="Unified2_izlaz">Unified2 izlaz</span></h3>
<p>Korisnik može koristiti vlastite alate za standardne izlaze i metode novog mehanizma Suricate jer su provjereno 100% kompatibilni međusobno. <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Unified2_Output" class="external autonumber" rel="nofollow">[20]</a>
</p>
<h3> <span class="mw-headline" id="Tokovne_varijable">Tokovne varijable</span></h3>
<p>Moguće je uhvatiti informacije izvan streama i pohraniti ih u varijablu čija se podudarnost može i kasnije ponovno provjeriti. 
<a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Flow_Variables" class="external autonumber" rel="nofollow">[21]</a>
</p>
<h3> <span class="mw-headline" id="Brzo_IP_podudaranje">Brzo IP podudaranje</span></h3>
<p>Mehanizam Suricate će automatski preuzeti pravila koja odgovoraju IP (kao što je RBN i ugrožena IP lista od Emerging Threats) i stavit će u odgovarajući posebno brz pretprocesor. <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Fast_IP_Matching" class="external autonumber" rel="nofollow">[22]</a>
</p>
<h3> <span class="mw-headline" id="HTTP_Log_modul">HTTP Log modul</span></h3>
<p>Svi HTTP zahtjevi mogu biti automatski prosljeđeni  u apache-stil log formatu datoteke. Ta značajka je vrlo korisna za nadgledanje i prijavljivanje aktivnosti koje su posve neovisne o setu pravila i podudaranju. U tom slučaju se mehanizam može koristiti samo kao HTTP <i>logging sniffer</i>. <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/HTTP_Log_Module" class="external autonumber" rel="nofollow">[23]</a>
</p>
<h3> <span class="mw-headline" id="Flowint">Flowint</span></h3>
<p>Flowint predstavlja nešto poput globalne varijable koja omogućuje pohranu podataka nad kojima se onda mogu obavljati razne matematičke operacije. Na taj način se mogu uspoređivati podaci iz paketa koji se nalaze u različitim streamovima. Uobičajena upotreba ove mogućnosti je brojanje određene pojave u sustavu. Nakon što pojava desegne broj koji smo sami definirali sustav nam šalje konfiguriranu obavijest. Primjer se može naći u zadnjem poglavlju kod testiranja višekratnih pokušaja unosa nekorektnih podataka za logiranje.
</p>
<h2> <span class="mw-headline" id="Podr.C5.BEane_platforme">Podržane platforme</span></h2>
<p>Suricata se može pokretati na Linux, BSD, Mac OS X i Windows platformi. Podržava ugrađenu i pasivnu konfiguraciju za praćenje prometa koja je sposobna nositi se i s više gigabitnim razinama prometa. Za više informacija o podržanim platformama mogu se pogledati sljedeći linkovi:
</p><p>Ubuntu instalacija <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Ubuntu_Installation" class="external autonumber" rel="nofollow">[24]</a><br />
Debian instalacija <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Debian_Installation" class="external autonumber" rel="nofollow">[25]</a><br />
CentOS5 instalacija <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/CentOS5" class="external autonumber" rel="nofollow">[26]</a><br />
CentOS 5.6 instalacija <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/CentOS_56_Installation" class="external autonumber" rel="nofollow">[27]</a><br />
Fedora Core instalacija <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Fedora_Core" class="external autonumber" rel="nofollow">[28]</a><br />
FreeBSD 8 instalacija <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/FreeBSD_8" class="external autonumber" rel="nofollow">[29]</a><br />
Mac OS X (10.6.x) instalacija <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Mac_OS_X_106x" class="external autonumber" rel="nofollow">[30]</a><br />
Windows instalacija <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Windows" class="external autonumber" rel="nofollow">[31]</a><br />
</p><p><b>Hardver podrška</b>:
</p><p>Endace DAG<br />
Napatech<br />
Myricom<br />
</p><p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Aleksandra.sobodic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Aleksandra.sobodic (stranica ne postoji)">Aleksandra Sobodić</a> 21:26, 11. siječnja 2013. (CET)
</p>
<h2> <span class="mw-headline" id="Suricata_-_Prakti.C4.8Dni_dio">Suricata - Praktični dio</span></h2>
<p>Praktični dio Suricate započinje njezinom instalacijom na Windows XP Professional operacijskom sustavu koji se nalazi na virtualnoj mašini VMware® Workstation <a href="https://my.vmware.com/web/vmware/info/slug/desktop_end_user_computing/vmware_workstation/9_0" class="external autonumber" rel="nofollow">[32]</a>. <br />
<i>Savjet</i>: Obaviti testiranje softvera na virtualnoj mašini! <br />
Instalacija Suricate zaista ovisi o kojem operacijskom sustavu je riječ (poglavlje u ovom seminaru: <i>Podržane platforme</i>). <br /><br />
<b>1. Instalirati Cygwin</b> kako bi se dobilo "linuxoidno" okruženje za Windowse jer je u njemu moguće pisati programe koji koriste Linux biblioteke.  <br />
- direktan link na instalacijsku datoteku sa Cygwin stranice <a href="http://cygwin.com/setup.exe" class="external autonumber" rel="nofollow">[33]</a> <br />
</p>
<div class="thumb tnone"><div class="thumbinner" style="width:544px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:1cy.png" class="image"><img alt="" src="../images/8/85/1cy.png" width="542" height="401" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:1cy.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 1.</b> Početak instalacije Cygwin.</div></div></div><br />
<div class="thumb tnone"><div class="thumbinner" style="width:542px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:2cy.png" class="image"><img alt="" src="../images/b/bb/2cy.png" width="540" height="396" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:2cy.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 2.</b> Početak instalacije Cygwin.</div></div></div><br />
<div class="thumb tnone"><div class="thumbinner" style="width:543px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:3cy.png" class="image"><img alt="" src="../images/2/23/3cy.png" width="541" height="396" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:3cy.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 3.</b> U proizvoljan direktorij na disku je potrebno instalirati Cygwin (<i>preporuka</i>: C:\cygwin).</div></div></div> <br />
<div class="thumb tnone"><div class="thumbinner" style="width:540px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:4cy.png" class="image"><img alt="" src="../images/6/61/4cy.png" width="538" height="401" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:4cy.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 4.</b> Potrebno odabrati i/ili kreirati direktorij u koji će <i>Setup</i> pohraniti instalacijske datoteke koje je preuzeo s Interneta (<i>preporuka</i>: C:\work\Downloads). Ostale opcije ostaviti po <i>defaultu</i> i stisnuti <i>Next</i>.</div></div></div><br /> 
<div class="thumb tnone"><div class="thumbinner" style="width:542px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:5cy.png" class="image"><img alt="" src="../images/f/f4/5cy.png" width="540" height="399" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:5cy.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 5.</b> Povezivanje na Internet ostavit po <i>defaultu</i> na Direct Connection.</div></div></div><br />
<div class="thumb tnone"><div class="thumbinner" style="width:544px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:6cy.png" class="image"><img alt="" src="../images/e/e0/6cy.png" width="542" height="399" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:6cy.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 6.</b> Cygwin Setup se distribuira slobodno putem Interneta. Može ga se cijeloga prenijeti s bilo kojeg od njihovih <i>mirrora</i> (odabrati prema želji).</div></div></div><br />
<div class="thumb tnone"><div class="thumbinner" style="width:546px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:7cy.png" class="image"><img alt="" src="../images/c/c3/7cy.png" width="544" height="394" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:7cy.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 7.</b> Instalacija Cygwina</div></div></div> <br />
<div class="thumb tnone"><div class="thumbinner" style="width:468px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:8cy.png" class="image"><img alt="" src="../images/0/05/8cy.png" width="466" height="318" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:8cy.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 8.</b> Nakon što započne instalacija Cygwin-a moguće je dobiti <i>upozorenje</i>. Međutim, kao što i samo upozorenje kaže ako je to prvi put da se instalira Cygwin slobodno ga se može ignorirati i stisnuti na OK i Next.</div></div></div><br /> 
<div class="thumb tnone"><div class="thumbinner" style="width:602px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:9cy.png" class="image"><img alt="" src="../images/thumb/9/9d/9cy.png/600px-9cy.png" width="600" height="427" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:9cy.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 9.</b> Po <i>defaultu</i> postoje već označeni paketi koji dolaze instalacijom Cygwin-a.</div></div></div> 
<p>Međutim za potrebe Suricate potrebno je odabrati dodatne pakete, te ih ovim putem instalirati na način da se u Search upiše ime paketa. Tražilica će automatski vratiti rezultat, odnosno traženi paket kojeg je moguće odabrati pritiskom na Skip, čime se u kvadratić u ravnini s nazivom paketa upisuje oznaka x što znači da je paket odabran. Potrebno je pronaći sve navedene pakete (<b>slika 10.</b>) i označiti ih, a tek onda pritisnuti Next. Nakon što su svi paketi odabrani potrebno je <i>očistiti</i> Search, pritisnuti na View tipku sve dok se desno od nje ne prikaže tekst <i>Pending</i>. U tom prikazu se može vidjeti da li su odabrani svi željeni paketi. <br />
</p>
<div class="thumb tnone"><div class="thumbinner" style="width:602px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:10cy.png" class="image"><img alt="" src="../images/thumb/b/bc/10cy.png/600px-10cy.png" width="600" height="366" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:10cy.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 10.</b> Prikaz potrebnih (dodatnih) paketa</div></div></div><br /> 
<div class="thumb tnone"><div class="thumbinner" style="width:602px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:11cy.png" class="image"><img alt="" src="../images/thumb/5/59/11cy.png/600px-11cy.png" width="600" height="439" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:11cy.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 11.</b> Nakon što se stisnuo Next potrebno je ostaviti kvačicu na opciji "Select required packages (RECOMMENDED)".</div></div></div><br />
<div class="thumb tnone"><div class="thumbinner" style="width:602px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:12cy.png" class="image"><img alt="" src="../images/thumb/0/0b/12cy.png/600px-12cy.png" width="600" height="438" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:12cy.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 12.</b> Instalacija traje između 10 - 20 minuta.</div></div></div><br /> 
<div class="thumb tnone"><div class="thumbinner" style="width:602px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:13cy.png" class="image"><img alt="" src="../images/thumb/1/1f/13cy.png/600px-13cy.png" width="600" height="439" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:13cy.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 13.</b> Preporuka je kreirati ikonicu na <i>Desktopu</i>.</div></div></div><br />  
<p><b>2. Dodati stazu (<i>path</i>) sustavskim varijablama</b> (Control Panel\System\Advanced\Environment Variables): <br />
</p>
<pre>C:\windows\system32;C:\cygwin\bin;C:\cygwin\lib\pkgconfig;
</pre>
<div class="thumb tnone"><div class="thumbinner" style="width:432px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:14xp.png" class="image"><img alt="" src="../images/3/38/14xp.png" width="430" height="494" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:14xp.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 14.</b> <i>Edit System Variable</i></div></div></div> <br />
<p><b>3. Instalirati libyaml</b> <a href="http://pyyaml.org/wiki/LibYAML" class="external autonumber" rel="nofollow">[34]</a> <br />
- direktan link za instalaciju yaml paketa (trenutačna verzija je yaml-0.1.4.tar.gz)<a href="http://pyyaml.org/download/libyaml/yaml-0.1.4.tar.gz." class="external autonumber" rel="nofollow">[35]</a> <br />
Potrebno ga je raspakirati unutar:
</p>
<pre>C:\cygwin\tmp
</pre>
<p>Nakon raspakiravanja dobije se sljedeći direktorij:
</p>
<pre>C:\cygwin\tmp\yaml-0.1.4
</pre>
<p><br />
<b>4. Instalirati libpcap</b> <a href="http://www.winpcap.org/install/default.htm" class="external autonumber" rel="nofollow">[36]</a> i preuzeti WinPcap instalaciju za Windowse (trenutačna verzija je WinPcap Version 4.1.2) <br />
Instalacija WinPcap je <i>kliketuša</i> Next po <i>default</i> opcijama.  <br />
Nakon toga je potrebno preuzeti razvojni paket (WinPcap 4.1.2 Developer's Pack)<a href="http://www.winpcap.org/devel.htm" class="external autonumber" rel="nofollow">[37]</a> koji je potreban kako bi se mogla Suricata pokrenuti na Windowsima. <br />
Potrebno je prekopirati biblioteke iz neraspakirane preuzete datoteke: <br />
- Kopirati sav sadržaj iz <b>WpdPack\Lib\</b> u <b>C:\cygwin\lib\</b> <br />
- Kopirati sav sadržaj iz <b>WpdPack\Include\</b> u <b>C:\cygwin\usr\include\</b> <br />
- U C:\cygwin\lib  potrebno je preimenovati <b>“libwpcap”</b> u <b>“libpcap”</b> <br /> <br />
<b>5. Pokrenuti Cygwin ikonu i pokrenuti yaml datoteku.</b> <br />
</p>
<div class="thumb tnone"><div class="thumbinner" style="width:592px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:15xp.png" class="image"><img alt="" src="../images/0/06/15xp.png" width="590" height="329" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:15xp.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 15.</b> Pokrenut Linux/bash kao <i>command prompt</i></div></div></div><br />
<p>Potrebno je upisati sljedeće naredbe (nakon svake upisane naredbe stisnuti Enter): <br />
</p>
<pre>cd /tmp
cd yaml-0.1.4
./configure --prefix=/usr &amp;&amp; make &amp;&amp; make install
</pre>
<p>Pomoću prethodnih naredbi napravljena je konfiguracija i instalacija yaml paketa koji su potrebni za rad u Suricati.<br />
</p>
<div class="thumb tnone"><div class="thumbinner" style="width:602px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:16yaml.png" class="image"><img alt="" src="../images/thumb/f/fc/16yaml.png/600px-16yaml.png" width="600" height="427" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:16yaml.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 16.</b> Izgled Cygwin cmd-a nakon dovršene instalacije yaml paketa</div></div></div> <br />
<p>Zatim, potrebno je vratiti se u direktorij <i>/tmp</i> pomoću naredbe:
</p>
<pre>cd .. 
</pre>
<p><b>6. Kompajlirati Suricatu iz <i>git</i>-a</b> (ako se želi Stable verzija Suricate <i>trenutačno</i> 1.4 onda prijeći na sljedeću točku 7.) <br />
U Cygwin cmd-u potrebno je upisati sljedeću naredbu:
</p>
<pre>git clone <a href="git://phalanx.openinfosecfoundation.org/oisf.git" class="external free" rel="nofollow">git://phalanx.openinfosecfoundation.org/oisf.git</a>
</pre>
<p>Pomoću prethodne naredbe inicijalizirao se prazan Git repozitorij u cygwin/tmp/oisf/.git, odnosno kreirao se lokalni direktorij s nazivom oisf.  Direktorij oisf sadržava datoteke koje imaju isti sadržaj te povijest kao i repozitorij koji je netom kloniran naredbom <i>clone</i>, međutim (da ne bi bilo zabune) oni ne komuniciraju međusobno osim ako se ne da izričita naredba za to. <br />
</p>
<div class="thumb tnone"><div class="thumbinner" style="width:592px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:17oisf.png" class="image"><img alt="" src="../images/8/82/17oisf.png" width="590" height="331" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:17oisf.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 17.</b> Prikaz Cygwin cmd-a prije izvođenja sljedeće naredbe:</div></div></div><br />
<pre>dos2unix.exe libhtp/configure.ac &amp;&amp; dos2unix.exe libhtp/htp.pc.in &amp;&amp; dos2unix.exe libhtp/Makefile.am
</pre>
<p><br />
</p>
<div class="thumb tnone"><div class="thumbinner" style="width:594px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:18oisf.png" class="image"><img alt="" src="../images/f/f2/18oisf.png" width="592" height="328" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:18oisf.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 18.</b> Prikaz Cygwin cmd-a netom nakon izvedene prethodne naredbe,a prije izvođenja sljedeće kojom se završava postupak konfiguracije i kompajliranje Suricate.</div></div></div><br />
<pre>./autogen.sh &amp;&amp; ./configure &amp;&amp; make
</pre>
<p>Instalacija traje cca 10 - 15 minuta. <br />
</p>
<div class="thumb tnone"><div class="thumbinner" style="width:602px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:19oisf.png" class="image"><img alt="" src="../images/thumb/3/37/19oisf.png/600px-19oisf.png" width="600" height="424" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:19oisf.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 19.</b> Nakon završenog kompajliranja Suricate iz <i>git</i>-a.</div></div></div><br />
<p><b>7. Kompajlirati Suricatu stable 1.4.</b> <br />
- direktni link na preuzimanje Suricata stable zadnje verzije <a href="http://suricata-ids.org/download/" class="external autonumber" rel="nofollow">[38]</a> <br />
Preuzetu instalacijsku datoteku  <i>suricata-1.4.tar.gz</i> potrebno je spremiti u direktorij <i>C:\cygwin\tmp</i>. <br />
Međutim, ako se želi izbjeći ručno spremanje datoteke moguće je i pomoću naredbi pohraniti i raspakirati, te na kraju i pokrenuti datoteku pomoću sljedećih naredbi:
(Naredbu <i>wget</i> potrebno je prethodno instalirati, odnosno dodati na isti način kao što su se dodavali i ostali paketi u Cygwin - objašnjeno u točki 2.)
</p>
<pre>wget <a href="http://www.openinfosecfoundation.org/download/suricata-1.4.tar.gz" class="external free" rel="nofollow">http://www.openinfosecfoundation.org/download/suricata-1.4.tar.gz</a>
tar –zxf suricata-1.4.tar.gz
cd suricata-1.4
dos2unix.exe libhtp/configure.ac &amp;&amp; dos2unix.exe libhtp/htp.pc.in &amp;&amp; dos2unix.exe libhtp/Makefile.am
libtoolize -c &amp;&amp; autoreconf -fv --install &amp;&amp; ./configure &amp;&amp; make
</pre>
<p><br />
<b>8. Postaviti Suricatu da radi u Windows okruženju.</b> <br />
- Potrebno je kreirati novi direktorij <b>C:\Suricata</b>, te kopirati Suricata.exe datoteku iz C:\cygwin\tmp\oisf\src\.libs u C:\Suricata. <br />
- Zatim je potrebno kreirati direktorij <b>C:\Suricata\log</b> i <b>C:\Suricata\rules</b> (sadržavat će pravila Suricate).<br />
- Na ovom linku <a href="http://rules.emergingthreats.net/open/suricata/emerging.rules.tar.gz" class="external autonumber" rel="nofollow">[39]</a> moguće je preuzeti set pravila. Također, moguće je i sa ovog linka <a href="http://www.snort.org/" class="external autonumber" rel="nofollow">[40]</a>, ali Emerging Threats (prvi link) je razvio set pravila upravo za Suricatu kako bi se u potpunosti iskoristile njezine mogućnosti. <br />
- Preuzeta datoteka <i>emerging.rules.tar.gz</i> se raspakira unutar C:\Suricata\rules direktorija. <br />
- Zatim se ode u C:\cygwin\tmp\oisf i kopira se <i>classification.config</i> , <i>reference.config</i> i <i>suricata.yaml</i> u C:\Suricata <br />
- Kopira se C:\cygwin\usr\share\misc\magic.mgc, odnosno magic.mgc u C:\Suricata direktorij
- Nakon toga se otvori suricata.yaml s NotePad-om, WordPad-om i sl., te se nadopune sljedeće linije:
</p>
<pre>default-log-dir: C:\Suricata\log
………
- file:
enabled: yes
filename: C:\Suricata\suricata.log
……….
default-rule-path: C:\Suricata\rules\
classification-file: C:\Suricata\classification.config
reference-config-file: C:\Suricata\reference.config
HOME_NET: "[192.168.152.129]" (postaviti mrežu za koju se želi da je Suricata pregledava)
</pre>
<div class="thumb tnone"><div class="thumbinner" style="width:602px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:20yaml.png" class="image"><img alt="" src="../images/thumb/7/7b/20yaml.png/600px-20yaml.png" width="600" height="393" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:20yaml.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 20.</b> Primjer promjene linije u suricata.yaml datoteci</div></div></div><br />
<p><b>9. Pokretanje Suricate</b><br />
Pokrenuti cmd kao administrator i navigirati do C:\Suricata, a zatim pokrenuti pomoću naredbe:
</p>
<pre>suricata.exe -c suricata.yaml -i 192.168.152.129
//-i 192.168.152.129 je IP/sučelje za koje se želi da ga Suricata osluškuje, za primjer je uzeta naša mrežna kartica
</pre>
<div class="thumb tnone"><div class="thumbinner" style="width:602px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:21yaml.png" class="image"><img alt="" src="../images/thumb/6/6d/21yaml.png/600px-21yaml.png" width="600" height="515" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:21yaml.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 21.</b> Pokrenuta Suricata</div></div></div><br />
<p><b>10. Primjer konfiguriranja Suricate</b> <br />
Konfiguriranje Suricate da detektira jpeg slike.
U suricata.yaml datoteci promijeniti sljedeće linije:
</p>
<pre>- file-store:
    enabled: yes
………
- reassembly:
    memcap: 64mb
    depth: 10mb
………
- rule-files:
    - files.rules  #dodati novo pravilo
………
magic-file: C:\Suricata\magic.mgc
</pre>
<p>Zatim je potrebno otići u C:\Suricata\rules i pronaći datoteku <i>files</i>. Sadržaj datoteke se mijenja na način da se pronađe linija:   <br />
</p>
<pre># Same for JPEG's 
#alert http any any -&gt; any any (msg: "FILEMAGIC jpg(1)"; flow:established, to server; filemagic:"JPEG image data"; filestore; sid:10; rev1;)
</pre>
<p>I ispravi na sljedeći način:
</p>
<pre># Same for JPEG's 
alert http any any -&gt; any any (msg: "FILEMAGIC jpg(1)"; flow:established; filemagic:"JPEG image data"; filestore; sid:10; rev1;)
</pre>
<div class="thumb tnone"><div class="thumbinner" style="width:602px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:Files.png" class="image"><img alt="" src="../images/thumb/0/04/Files.png/600px-Files.png" width="600" height="404" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:Files.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 22.</b> Prikaz ispravljene <i>files</i> datoteke</div></div></div> <br />
<p>Ako se želi isprobati dorađena konfiguracija upiše se ponovno sljedeća naredba unutar cmd-a:
</p>
<pre>suricata.exe -c suricata.yaml -i 192.168.152.129
</pre>
<p><br />
Nakon što se Suricata mehanizam pokrenuo, potrebno je otvoriti novi Command Prompt i upisati sljedeće naredbe:
</p>
<pre>wget <a href="http://......jpg" class="external free" rel="nofollow">http://......jpg</a> //izabrati po želji web stranicu s jpg slikom s web-a
</pre>
<div class="thumb tnone"><div class="thumbinner" style="width:602px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:22cmd.png" class="image"><img alt="" src="../images/thumb/0/03/22cmd.png/600px-22cmd.png" width="600" height="467" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:22cmd.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 23.</b> Prikaz naredbe <i>wget</i> u Command Promptu</div></div></div> <br />
<div class="thumb tnone"><div class="thumbinner" style="width:602px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:Slike.png" class="image"><img alt="" src="../images/thumb/f/f9/Slike.png/600px-Slike.png" width="600" height="427" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:Slike.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 24.</b> Prikaz preuzetih slika pomoću wget s određenih web stranica <br /></div></div></div>
<p>Zatim, opet u novom Command Promptu navigira se do C:\Suricata\log, te upiše naredba za ispis sadržaja datoteke fast.log
</p>
<pre>cat fast.log
</pre>
<div class="thumb tnone"><div class="thumbinner" style="width:602px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:23cat.png" class="image"><img alt="" src="../images/thumb/f/fd/23cat.png/600px-23cat.png" width="600" height="393" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:23cat.png" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div><b>Slika 25.</b> Prikaz cat naredbe u Command Promptu</div></div></div> <br />
<p>Prilikom pretraživanja koju ćemo sliku preuzeti, u nekoliko navrata stranica se nije htjela učitati s upozorenjem da je pristup toj web stranici (odnosno jpg slici) zabranjen. U <i>fast.log</i> datoteci je otkriven uzrok tome:
</p>
<pre>01/19/2013-12:45:31.384280 [**] [1:2014726:14] ET POLICY Outdated Windows Flash Version IE 
[**] [Classification: Potential Corporate Privacy Violation] [Priority: 1] {TCP} 192.168.152.129:1445 -&gt; 173.194.35.6:80
</pre>
<p>S obzirom na definirana i konfigurirana pravila Suricata će dopuštati i zabranjivati pristup web stranicama našim podacima, ali i nama u slučaju ako "smatra" da bi se mogli izložiti određenim opasnostima Interneta. <br />
<b>Zaključak:</b> Suricata se u potpunosti može prilagoditi potrebama osobe koja je želi koristiti, jedino što je potrebno jest znanje o njezinim mogućnostima konfiguracije (poglavlje ovog seminara: <i>Performanse</i>) te pravilima (poglavlja ovog seminara: <i>Suricata pravila</i>/<i>Upravljanje pravilima pomoću Oinkmaster</i>).<br />
Ostale mogućnosti konfiguriranja Suricate za vlastite potrebe se mogu pogledati na ovom linku <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Suricatayaml" class="external autonumber" rel="nofollow">[41]</a>. <br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Aleksandra.sobodic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Aleksandra.sobodic (stranica ne postoji)">Aleksandra Sobodić</a> 15:47, 19. siječnja 2013. (CET)
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Ivanko.Zekic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Ivanko.Zekic (stranica ne postoji)">Ivanko Zekić</a> 15:48, 19. siječnja 2013. (CET)
</p>
<h2> <span class="mw-headline" id="Suricata_pravila">Suricata pravila</span></h2>
<p>Potpisi imaju važnu ulogu u Suricati. U većini slučajeva ljudi koriste već postojeće setove pravila. Najčešće korišteni su: Emerging Threats <a href="http://www.emergingthreats.net/" class="external autonumber" rel="nofollow">[42]</a>, Emerging Threats Pro <a href="http://www.emergingthreats.net/" class="external autonumber" rel="nofollow">[43]</a> i od  <i>SourceFire</i>a VRT <a href="http://www.snort.org/vrt/" class="external autonumber" rel="nofollow">[44]</a>. U poglavlju Upravljanje pravilima pomoću Oinkmastera bit će opisan način instalacije pravila.
<br />
Pravilo/potpis se sastoji od sljedećeg: 
<b>akcije</b> (eng. <i>action</i>), <b>zaglavlja</b> (eng. <i>header</i>) i <b>opcija za pravilo</b> (eng. <i>rule-options</i>). <br />
Primjer potpisa <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Suricata_Rules" class="external autonumber" rel="nofollow">[45]</a>: <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Primjer_potpisa.png" class="image"><img alt="Primjer potpisa.png" src="../images/1/12/Primjer_potpisa.png" width="331" height="266" /></a><br />
</p>
<h4> <span class="mw-headline" id="Akcija">Akcija</span></h4>
<p>Svi potpisi imaju različita svojstva. Jedan od njih jest i <i>Action property</i>. On definira što će se dogoditi kada se potpisi podudaraju. <br />
Postoje četiri vrste akcije (eng. <i>Action</i>) <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Suricatayaml#Action-order" class="external autonumber" rel="nofollow">[46]</a>:<br />
1) <b>Pass</b> - ako se potpis podudara i sadrži propusnicu, Suricata će prestati skenirati paket i preskače na kraj svih pravila, ali samo za taj paket. <br />
2) <b>Drop</b> - ovo obuhvaća samo <i>IPS/inline</i> način. Ako program pronađe potpis koji se podudara sadržavajući drop, odmah se zaustavlja, te taj paket neće biti dalje poslan. Nedostatak: Primatelj neće primiti poruku o tome što se dogodilo, već će sesija rezultirati istekom vremena (svakako s TCP). Suricata generira upozorenje za ovakav paket.<br />
3) <b>Reject</b> - ovo je aktivno odbijanje paketa. I pošiljatelj i primatelj će primiti odbačeni paket. Postoje dvije vrste odbačenih paketa koji će biti automatski odabrani. Ako vrijeđajući (eng. <i>offending</i>) paket zabrinjava TCP pojavit će se ponovljeni (eng. <i>reset</i>) paket. Za sve ostale protokole pojavit će se ICMP-pogreška (eng. <i>error</i>) paket. Suricata također generira upozorenje. Međutim u inline/IPS načinu, <i>offending</i> paket će biti odbačen kao i u "drop" akciji. <br />
4) <b>Alert</b> - ako se potpis podudara i sadržava upozorenje, paket će biti tretiran kao i bilo koji drugi ne-ugroženi paket, osim za ovog gdje će upozorenje biti generirano od Suricate. Jedino administrator sustava može primjetiti ovo upozorenje.<br />
Inline/IPS može blokirati mrežni promet na dva načina. Prvi način je pomoću drop-a, a drugi pomoću reject-a.
<br />
Pravila će biti učitana redoslijedom kojim se nalaze u datoteci. Ali, će biti obrađena drugačijim redoslijedom. Potpisi imaju različite prioritete. Najvažniji potpisi, odnosno potpisi visokog prioriteta će biti prvi skenirani. Moguće je promijeniti redoslijed prioriteta. Po defaultu redoslijed je ovakav: pass, drop, reject, alert. <br />
</p>
<pre>action-order:
- pass
- drop
- reject
- alert
</pre>
<p>To znači <i>da se pass pravilo uzima u obzir prije drop pravila, a drop pravilo prije reject pravila itd</i>.
</p><p>Primjer akcije <i>drop</i>: <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Suricata_Rules" class="external autonumber" rel="nofollow">[47]</a> <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Primjer_akcije.png" class="image"><img alt="Primjer akcije.png" src="../images/b/bf/Primjer_akcije.png" width="337" height="131" /></a> <br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Aleksandra.sobodic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Aleksandra.sobodic (stranica ne postoji)">Aleksandra Sobodić</a> 21:26, 11. siječnja 2013. (CET)
</p>
<h4> <span class="mw-headline" id="Protokol">Protokol</span></h4>
<p>Ključna riječ protokol u potpisu će reći Suricati na koji se to protokol odnosi. Korisnik može birati između četiri postavke: TCP(za tcp-promet), UDP, ICM i IP. <br /> IP se odnosi na 'all' ili 'any'. <br />
Suricata dodaje nekoliko protokola: HTTP, FTP, TLS (uključuje SSL), SMB (tzv. protokoli aplikacijskog sloja ili sedmi sloj protokola). Ako korisnik ima npr. potpis s HTTP protokolom, Suricata će se pobrinuti da potpis se može podudarati samo ako se radi o HTTP prometu. <br />
Primjer s protokolom <i>tcp</i>: <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Suricata_Rules" class="external autonumber" rel="nofollow">[48]</a><br /><a href="http://security.foi.hr/wiki/index.php/Datoteka:Primjer_protokola.png" class="image"><img alt="Primjer protokola.png" src="../images/8/86/Primjer_protokola.png" width="372" height="136" /></a> <br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Aleksandra.sobodic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Aleksandra.sobodic (stranica ne postoji)">Aleksandra Sobodić</a> 21:28, 11. siječnja 2013. (CET)
</p>
<h4> <span class="mw-headline" id="Izvor_i_odredi.C5.A1te">Izvor i odredište</span></h4>
<p>U izvoru korisnik može dodijeliti IP-adrese; IPv4 i IPv6 se mogu kombinirati, ali mogu biti i zasebno odvojene. Također, može postaviti varijable kao što je HOME_NET. <br />
U Yaml-datoteci korisnik može postaviti IP adrese za varijable kao što su EXTERNAL_NET i HOME_NET. Ove postavke će biti korištene kada korisnik iskoriste te varijable u pravilu.<br /> U izvorištu i odredištu korisnik može koristiti i znakove kao što su&#160;! i []. <br />
Kao primjer:
</p>
<pre>! 1.1.1.1                     (Every IP address but 1.1.1.1)
![1.1.1.1, 1.1.1.2]           (Every IP address but 1.1.1.1 and 1.1.1.2)    
$HOME_NET                     (Your setting of HOME_NET in yaml)
[$EXTERNAL_NET,&#160;!$HOME_NET]   (EXTERNAL_NET and not HOME_NET)
[10.0.0.0/24,&#160;!10.0.0.5]      (10.0.0.0/24 except for 10.0.0.5) 
[…..,[....]]
[…. ,![.....]]
</pre>
<p>Potrebno je obratiti pažnju ako su postavke u Yaml sljedeće:
</p>
<pre>HOME_NET: any
EXTERNAL_NET:&#160;! $HOME_NET 
</pre>
<p>U ovom slučaju se ne može napisati potpis koristeći EXTERNAL_NET zato što se odnosi na 'not_any'. Ovo je nevažeća postavka.<br />
Primjer izvora i odredišta u potpisu: <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Suricata_Rules" class="external autonumber" rel="nofollow">[49]</a><br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Home_net.png" class="image"><img alt="Home net.png" src="../images/7/7f/Home_net.png" width="381" height="138" /></a>  <br />
<i>crveno označeni dio primjera predstavlja izvor</i><br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:External_net.png" class="image"><img alt="External net.png" src="../images/7/78/External_net.png" width="375" height="136" /></a> <br />
<i>crveno označeni dio primjera predstavlja odredište</i><br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Aleksandra.sobodic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Aleksandra.sobodic (stranica ne postoji)">Aleksandra Sobodić</a> 21:29, 11. siječnja 2013. (CET)
</p>
<h4> <span class="mw-headline" id="Portovi_.28izvori.C5.A1ni_i_odredi.C5.A1ni_port.29">Portovi (izvorišni i odredišni port)</span></h4>
<p>Promet dolazi i odlazi kroz portove, a različiti portovi imaju različite brojeve (eng. <i>port number</i>). Na primjer, HTTP-port koristi port 80, dok HTTPS koristi 443, a MSN 1863. Zajednički port će biti postavljen na 'any', a to će biti pod utjecajem protokola. Izvorišni port je nasumično određen od strane operacijskog sustava. U postavkama portova korisnik može koristiti i posebne znakove: <br />
</p>
<pre>!       iznimka/negacija
:       raspon
[]      znakovi kako bi se razjasnilo koji dijelovi pripadaju zajedno
,       odvajanje
</pre>
<p>Primjer:
</p>
<pre>[80, 81, 82]    (port 80, 81 i82)
[80: 82]        (raspon od 80 do 82)
[1024: ]        (od 1024 do najvećeg broja porta)
!80             (svaki port osim 80)
[80:100,!99]    (raspon od 80 do 100 bez 99)
[1:80,![2,4]]
[….[.....]]
</pre>
<p>Primjer portova u potpisu (<i>crveno označeni dio primjera predstavlja port</i>): <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Suricata_Rules" class="external autonumber" rel="nofollow">[50]</a> <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Primjer_porta.png" class="image"><img alt="Primjer porta.png" src="../images/8/8a/Primjer_porta.png" width="339" height="279" /></a> <br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Aleksandra.sobodic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Aleksandra.sobodic (stranica ne postoji)">Aleksandra Sobodić</a> 21:31, 11. siječnja 2013. (CET)
</p>
<h4> <span class="mw-headline" id="Smjer">Smjer</span></h4>
<p>Smjer kaže u kojem smjeru, odnosno na koji način se potpis mora podudarati. Skoro svaki potpis ima strelicu  u desno što znači da se samo paketi u istom smjeru mogu podudarati.<br />
</p>
<pre>source -&gt; destination
source &lt;- destionation
source &lt;&gt; destionation (both directions)
</pre>
<p>Primjer: <br />
</p>
<pre>alert tcp 1.2.3.4. 1024 - &gt; 5.6.7.8 80
</pre>
<p>Primjer 1 tcp-sesije <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Suricata_Rules" class="external autonumber" rel="nofollow">[51]</a> <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Tcp_sesija.png" class="image"><img alt="Tcp sesija.png" src="../images/3/3c/Tcp_sesija.png" width="524" height="328" /></a>
<br />
U prethodnom primjeru doći će do podudarnosti jedino u slučaju ako potpis ima isti redoslijed/smjer kao korisni teret (eng. <i>payload</i>). <br />
Primjer smjera u potpisu: <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Suricata_Rules" class="external autonumber" rel="nofollow">[52]</a> <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Primjer_smjera.png" class="image"><img alt="Primjer smjera.png" src="../images/5/5f/Primjer_smjera.png" width="373" height="136" /></a> <br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Aleksandra.sobodic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Aleksandra.sobodic (stranica ne postoji)">Aleksandra Sobodić</a> 21:32, 11. siječnja 2013. (CET)
</p>
<h4> <span class="mw-headline" id="Opcije_pravila">Opcije pravila</span></h4>
<p>Ključne riječi imaju postavljen format:
</p>
<pre>name: settings;
</pre>
<p>Ponekad može stajati i samo ime postavke 'settings' iza čega slijedi&#160;; .
Postoje specifične postavke za: <br />
- meta-informacije (eng. <i>meta-information</i>)<br />
- zaglavlja (eng. <i>headers</i>)<br />
- korisne terete (eng. <i>payloads</i>)<br />
- tokove (eng. <i>flows</i>)<br />
</p>
<h5> <span class="mw-headline" id="Meta-postavke_.28eng._Meta-settings.29"> Meta-postavke  (eng. <i>Meta-settings</i>) </span></h5>
<p>Meta-postavke nemaju efekta na Suricatina očekivanja, već imaju efekt na način na koji Suricata izvještava o događajima. <br />
<br />
<b>1. msg (message)</b> <br />
Ključna riječ msg daje više informacije o potpisu i mogućem upozorenju. Prvi dio pokazuje ime datoteke potpisa. To je konvencija u kojoj je taj dio napisan velikim slovima.<br />
Format msg je:
</p>
<pre>msg: "..........";
</pre>
<p>Primjer: <br />
</p>
<pre>msg: "ATTACK-RESPONSES 403 Forbidden";
msg: "ET EXPLOIT SMB-DS DCERPC PnP bind attempt";
</pre>
<pre>To je konvencija u kojoj je msg uvijek prva ključna riječ potpisa.
</pre>
<p>Sljedeći primjer msg u potpisu: <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Meta-settings" class="external autonumber" rel="nofollow">[53]</a> <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Primjer_msg.png" class="image"><img alt="Primjer msg.png" src="../images/5/55/Primjer_msg.png" width="373" height="129" /></a><br />
</p><p><br />
<b>2. Sid (signature id)</b> <br />
Ključna riječ <i>sid</i> daje svakom potpisu svoj vlastiti id. Taj id se navodi s brojem.
Format <i>sid</i> je <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Meta-settings" class="external autonumber" rel="nofollow">[54]</a>:
</p>
<pre>sid:123;
</pre>
<p>Primjer <i>sid</i> u potpisu: <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Meta-settings" class="external autonumber" rel="nofollow">[55]</a><br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Primjer_sid.png" class="image"><img alt="Primjer sid.png" src="../images/a/a7/Primjer_sid.png" width="341" height="136" /></a><br />
</p><p><br />
<b>3. Rev (Revision)</b> <br />
<i>Sid</i> ključna riječ je skoro uvijek popraćena rječju <i>rev</i>. Rev predstavlja verziju potpisa. Ako je potpis modificiran, broj <i>rev</i>-ova će porasti potpisom pisaca.<br />
Format rev je:
</p>
<pre>rev:123; 
</pre>
<pre>To je konvencija u kojoj <i>sid</i> uvijek dolazi prije <i>rev</i>, a oboje su na kraju svih drugih ključnih riječi.
</pre>
<p>Primjer <i>rev</i> u potpisu: <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Meta-settings" class="external autonumber" rel="nofollow">[56]</a> <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Primjer_rev.png" class="image"><img alt="Primjer rev.png" src="../images/9/9f/Primjer_rev.png" width="346" height="134" /></a>
</p><p><br />
<b>4. Gid (group id)</b> <br />
<i>Gid</i> ključna riječ može se koristiti kako bi se različitim grupama potpisa dala druga <i>id</i> vrijednost (kao što je <i>sid</i>). Suricata <i>po defaultu</i> koristi <i>gid</i> 1. Međutim, to je moguće modificirati. Nije uobičajeno da se mijenja, ali njegovo mijenjanje nema tehničke implikacije. Jedino je promjenu moguće primjetiti u upozorenju.<br />
Primjer gid u potpisu <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Meta-settings" class="external autonumber" rel="nofollow">[57]</a>:<br />
Primjer je prikazan iz fast.log. U dijelu [1:2008124:2], 1 je <i>gid</i> (2008124 je <i>sid</i> and 2 je <i>rev</i>). <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Primjer_gid.png" class="image"><img alt="Primjer gid.png" src="../images/8/8d/Primjer_gid.png" width="342" height="87" /></a>
</p><p><br />
<b>5. Classtype</b> <br />
<i>Classtype</i> ključna riječ daje informacije o klasifikaciji pravila i upozorenja. Sastoji se od kratkog imena, dugačkoga imena i prioriteta. Na primjer, pomoću njega se može reći da li je pravilo samo informativno, itd. Za svaki <i>classtype</i>, classification.config ima prioritet koji će se koristiti u pravilu.
</p>
<pre>To je konvencija u kojoj <i>classtype</i> dolazi prije <i>sid</i> i <i>rev</i>, ali poslije ostalih ključnih riječi.
</pre>
<p>Primjer <i>classtype</i>:
</p>
<pre>config classification: web-application-attack,Web Application Attack,1
config classification: not-suspicious,Not Suspicious Traffic,3
</pre>
<p><br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Classtype.png" class="image"><img alt="Classtype.png" src="../images/a/aa/Classtype.png" width="428" height="223" /></a>
</p><p>U ovom primjeru se može vidjeti na koji način se <i>classtype</i> pojavljuje u potpisu, classification.config i upozorenje.
</p><p>Sljedeći primjer <i>classtype</i> u potpisu <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Meta-settings" class="external autonumber" rel="nofollow">[58]</a>: <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Primjer_classtype.png" class="image"><img alt="Primjer classtype.png" src="../images/5/50/Primjer_classtype.png" width="338" height="131" /></a>
</p><p><br />
<b>6. Reference</b> <br />
<i>Reference</i> ključna riječ se nalazi direktno na mjestima gdje se može naći informacija o potpisu i o problemu kojeg potpis nastoji riješit. Reference ključna riječ se može pojaviti i više puta u potpisu. Ova ključna riječ je namijenjenja piscima potpisa i analitičarima koji istražuju zašto se potpis podudara. Format jest:
</p>
<pre>reference: url, www.info.nl
</pre>
<p>U ovom primjeru <i>url</i> je vrsta <i>reference</i>. 
Postoji nekoliko vrsta <i>reference</i>:
</p>
<pre>system             URL Prefix
bugtraq            <a href="http://www.securityfocus.com/bid" class="external free" rel="nofollow">http://www.securityfocus.com/bid</a>
cve                <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=" class="external free" rel="nofollow">http://cve.mitre.org/cgi-bin/cvename.cgi?name=</a>
nessus             <a href="http://cgi.nessus.org/plugins/dump.php3?id=" class="external free" rel="nofollow">http://cgi.nessus.org/plugins/dump.php3?id=</a>
arachnids          (No longer available but you might still encounter this in signatures.) 
                   <a href="http://www.whitehats.com/info/IDS" class="external free" rel="nofollow">http://www.whitehats.com/info/IDS</a>
mcafee             <a href="http://vil.nai.com/vil/dispVirus.asp?virus_k=" class="external free" rel="nofollow">http://vil.nai.com/vil/dispVirus.asp?virus_k=</a>
url                http://
</pre>
<p>Na primjer <i>bugtraq</i> će biti zamijenjen potpunim <i>url</i>:
</p>
<pre>reference: bugtraq, 123; <a href="http://www.securityfocus.com/bid" class="external free" rel="nofollow">http://www.securityfocus.com/bid</a>
</pre>
<p>Primjer <i>reference</i> u potpisu <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Meta-settings" class="external autonumber" rel="nofollow">[59]</a>:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Primjer_reference.png" class="image"><img alt="Primjer reference.png" src="../images/9/9a/Primjer_reference.png" width="333" height="125" /></a>
</p><p><br />
<b>7. Priority</b> <br />
<i>Priority</i> ključna riječ dolazi s obveznom brojčanom vrijednošću koja može biti u rasponu od 1 do 255. Najčešće se koriste brojevi od 1 do 4. Potpisi s višim prioritetom će biti prvi ispitani. Najveći prioritet je 1. Normalni potpisi imaju već prioritet koji su dobili putem <i>class type</i>. To može biti nadglasano s ključnom riječi <i>priority</i>. <br />
Format prioriteta je: <br />
</p>
<pre>priority:1;
</pre>
<p><br />
<b>8. Metadata</b> <br />
Suricata ignorira riječi iza <i>meta data</i>. Suricata podržava ovu ključnu riječ zato što je dio potpisnog jezika. <br />
Format je:
</p>
<pre>metadata:......;
</pre>
<p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Aleksandra.sobodic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Aleksandra.sobodic (stranica ne postoji)">Aleksandra Sobodić</a> 00:55, 13. siječnja 2013. (CET)
</p>
<h5> <span class="mw-headline" id="Klju.C4.8Dne_rije.C4.8Di_korisnog_tereta_.28eng._Payload_keywords.29">Ključne riječi korisnog tereta (eng. <i>Payload keywords</i>)</span></h5>
<p><i>Payload</i> ključne riječi pregledavaju sadržaj korisnog tereta paketa ili <i>stream</i>-a. <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Payload_keywords" class="external autonumber" rel="nofollow">[60]</a>
<br /> <br />
<b>1. Content</b> <br />
<i>Content</i> ključna riječ je vrlo važna u potpisima. U navodnicima se može napisati s čim bi se potpis trebao podudarati. Najjednostavniji format <i>content</i>-a je: 
</p>
<pre>content: ”............”;
</pre>
<p>Moguće je koristiti nekoliko vrste <i>content</i>-a u potpisu. <i>Contents</i> se podudaraju prema bajtovima. Postoji 256 različitih vrijednosti bajtova (0-255). Mogu se podudarati i u svim znakovima, što zapravo znači da će se podudarati u slovima od a do z, velikim i malim slovima, a čak i u posebnim znakovima. Međutim, nije moguće sve bajtove ispisati, pa se u tom slučaju koristi heksadecimalna notacija. Također, bitno je naglasiti da se sljedeća vrsta notacije može koristiti i kod znakova koje je moguće napisati.<br />
Primjer:
</p>
<pre>0x61 je a  
0x41 je A 
0x21 je&#160;! 
0x0D je povrat pokazivača
0x0A je redak
</pre>
<p>0x označava da se u obzir uzima posebna notacija. U potpisu se ne može koristiti 0x. Postoje određeni znakovi koji se ne mogu koristiti u <i>content</i>-u jer već predstavljaju važan dio potpisa. Kako bi se vršilo podudaranje kod takvih znakova potrebno je koristiti heksadecimalnu notaciju, poput:
</p>
<pre>“    22
;    3B
:    3A
|    7C

To je konvencija u kojoj se heksadecimalna notacija zapisuje velikim slovima.
</pre>
<p>Na primjer, ako se želi zapisati "http://" u <i>content</i> potpisa, to se može napraviti na način da se napiše: “http|3A|//”;
Potrebno je pripaziti da ako se koristi heksadecimalni zapis u potpisu, da ga se uvijek smješta između | | jer će u suprotnom notacija biti shvaćena doslovno kao dio <i>content</i>-a. Nekoliko primjera ukazuje na sljedeće:
</p>
<pre>content:“a|0D|bc”;
content:”|61 0D 62 63|";
content:”a|0D|b|63|”;
</pre>
<p>Moguće je dopustiti potpisu da provjeri čitav korisni teret da li se podudara s <i>content</i>-om ili dopustiti provjeru, ali samo za određene dijelove korisnog tereta. Ako se ništa posebno ne stavlja u potpis, on će nastojati pronaći podudaranja u svim bajtovima korisnog tereta (eng. <i>payload</i>). <br />
Primjer <i>content</i> <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Payload_keywords" class="external autonumber" rel="nofollow">[61]</a>: <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Primjer_content.png" class="image"><img alt="Primjer content.png" src="../images/4/41/Primjer_content.png" width="336" height="131" /></a><br />
Po defaultu uzorak podudaranja je vrlo osjetljiv na velika i mala slova. <i>Content</i> mora biti točan jer u suprotnom neće doći do podudaranja.<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Content_match.png" class="image"><img alt="Content match.png" src="../images/f/f0/Content_match.png" width="288" height="242" /></a> 
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Legend_content.png" class="image"><img alt="Legend content.png" src="../images/4/44/Legend_content.png" width="238" height="151" /></a><br />
Primjer:
</p>
<pre>alert http $HOME_NET any -&gt; $EXTERNAL_NET any (msg:"Outdated Firefox on
Windows"; content:"User-Agent|3A| Mozilla/5.0 |28|Windows|3B| ";
content:"Firefox/3."; distance:0; content:!"Firefox/3.6.13";
distance:-10; sid:9000000; rev:1;)
</pre>
<p>U <i>content</i>-u je moguće koristiti&#160;! za iznimke kao što je napravljeno i u prethodnom primjeru&#160;!”Firefox/3.6.13”;, to znači da će se generirati upozorenje ako se ne koristi verzija <i>Firefox</i>-a 3.6.13.
</p><p><br />
<b>2. Nocase</b><br />
U slučaju kada se ne želi raditi razlika između velikih i malih slova koristi se ključna riječ <i>nocase</i> koja je <i>content</i> modifikator. <br />
Format:
</p>
<pre>nocase;
</pre>
<p>Ključnu riječ <i>nocase</i> potrebno je postaviti iza <i>content</i> riječi koja se želi modificirati kao što je prikazano u sljedećem primjeru: <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Payload_keywords" class="external autonumber" rel="nofollow">[62]</a><br />
</p>
<pre> content: “abc”; nocase;
</pre>
<p><a href="http://security.foi.hr/wiki/index.php/Datoteka:Nocase.png" class="image"><img alt="Nocase.png" src="../images/5/5d/Nocase.png" width="261" height="236" /></a>
</p><p><br />
<b>3. Depth</b><br />
Ključna riječ <i>depth</i> je apsolutni <i>content</i> modifikator. Dolazi nakon ključne riječi <i>content</i> s obveznom brojčanom vrijednošću kao i u primjeru ispod: 
</p>
<pre>depth:12;
</pre>
<p>Broj napisan nakon riječi <i>depth</i> označava koliko će se bajtova provjeravati od početka korisnog tereta. <br />
Primjer <i>depth</i> <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Payload_keywords" class="external autonumber" rel="nofollow">[63]</a>: <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Depth.png" class="image"><img alt="Depth.png" src="../images/4/45/Depth.png" width="299" height="262" /></a> 
</p><p><br />
<b>4. Offset</b><br />
Ključna riječ <i>offset</i> označava iz kojeg bajta u korisnom teretu će se provjeravati podudaranje. Na primjer, ako se postavi "offset:3", to znači da se provjerava od četvrtog bajta, pa nadalje.<br />
Primjer <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Payload_keywords" class="external autonumber" rel="nofollow">[64]</a>: <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Offset.png" class="image"><img alt="Offset.png" src="../images/6/6b/Offset.png" width="291" height="207" /></a> <br />
</p><p>Važno je napomenuti da se ključne riječi <i>offset</i> i <i>depth</i> često kombiniraju i koriste zajedno. U sljedećem primjeru se može vidjeti da ako se te dvije ključne riječi koriste zajedno, to bi zapravo značilo da će se provjera korisnog tereta vršiti od četvrtog bajta, pa sve do 6 bajta (uključujući i provjeru 6. bajta).<br />
Primjer korištenja <i>offset</i> i <i>depth</i>:
</p>
<pre>content; “def”; offset:3; depth:6;
</pre>
<p><br />
<b>5. Distance</b><br />
Ključna riječ <i>distance</i> je relativni <i>content</i> modifikator. To zapravo znači da indicira relaciju između ključne riječi <i>content</i> i <i>content</i>-u koji mu je prethodio. <i>Distance</i> ima utjecaj nakon prethodnog podudaranja (eng. preceding match). Ta ključna riječ dolazi obvezno s brojčanom vrijednošću. S vrijednošću kojom se zadaje udaljenost se određuje bajt u korisnom teretu iz kojeg će biti provjerena podudarnost relativno s prethodnim podudaranjem. <i>Distance</i> jedino određuje gdje da Suricata započne s traženjem uzorka. Prema tome ako se stavi da je "distance:5", to znači da uzorak može biti bilo gdje nakon prethodnog podudaranja + 5 bajtova. Za ograničavanje koliko daleko nakon posljednjeg podudaranja Suricata treba tražiti se koristi <i>within</i>. <br />
Primjer <i>distance</i> <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Payload_keywords" class="external autonumber" rel="nofollow">[65]</a>: <br />
Objašnjenje primjera -&gt; Ključna riječ <i>distance</i> (3), kaže kako se drugi (2) <i>content</i> povezuje na prvi (1) <i>content</i>. <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Distance.png" class="image"><img alt="Distance.png" src="../images/4/40/Distance.png" width="245" height="86" /></a> <br />
</p><p><br />
</p><p><br />
<b>6. Within</b><br />
Ključna riječ <i>within</i> je relativna s obzirom na prethodno podudaranje. Ta ključna riječ dolazi obvezno s brojčanom vrijednošću. Korištenjem riječi <i>within</i> se povećava vjerojatnost da će do podudaranja doći jedino ako se content podudara s korisnim teretom unutar (<i>within</i>) postavljenog seta količine bajtova. <i>Within</i> nikad ne može biti 0. <br />
Primjer <i>within</i> <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Payload_keywords" class="external autonumber" rel="nofollow">[66]</a>: <br />
Objašnjenje primjera -&gt; Ključna riječ <i>within</i> (3), kaže kako se drugi (2) <i>content</i> povezuje na prvi (1) content. <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Within.png" class="image"><img alt="Within.png" src="../images/4/46/Within.png" width="263" height="68" /></a> <br />
</p><p><br />
<b>7. Isdataat</b><br />
Pomoću ključne riječi <i>isdataat</i> se može provjeriti postoje li još uvijek podaci o određenom dijelu korisnog tereta. Ključna riječ započinje prvo s brojem pozicije, a zatim sirovim brojem bajtove. Na kraju se opcionalno može dodati i 'relative' odvojen od njih zarezom, ako se želi provjeriti da li još uvijek postoje podaci o određenom dijelu korisnog tereta u odnosu na zadnje podudaranje. <br />
Primjer <i>isdataat</i>:
</p>
<pre>isdataat:512; //potpis traži korisni teret veličine 512 bajtova
isdataat:50, relative; // potpis traži 50 bajtova od zadnjeg podudaranja
</pre>
<p><br />
<br />
<b>8. Dsize</b><br />
S ključnom riječi <i>dsize</i> se može provjeriti podudarnost veličine paketa korisnog tereta. Na primjer, <i>dsize</i> se može koristiti kao ključna riječ pomoću koje se žele pronaći korisni tereti abnormalne veličine što je vrlo poželjno kod detekcije prelijevanja međuspremnika. <br />
Format:
</p>
<pre>dsize:&lt;number&gt;;
</pre>
<p>Primjer <i>dsize</i> u pravilu <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Payload_keywords" class="external autonumber" rel="nofollow">[67]</a>: <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Dsize.png" class="image"><img alt="Dsize.png" src="../images/0/01/Dsize.png" width="315" height="97" /></a>
</p><p><br />
<b>9. rpc</b><br />
Ključna riječ <i>rpc</i> se koristi kod podudaranja sa SUNRPC CALL u RPC proceduri brojeva i RPC verziji. RPC (eng. <i>Remote Procedure Call</i>) je aplikacija koja dopušta računalnom programu da izvodi procedure na drugom računalu ili u drugom adresnom prostoru, te se koristi kao međuprocesna komunikacija (IPC - eng. <i>Inter-process communication</i>). <br />
Format <i>rpc</i>:
</p>
<pre>rpc:&lt;application number&gt;, [&lt;version number&gt;|*], [&lt;procedure number&gt;|*]&gt;;
</pre>
<p>Primjer ključne riječi <i>rpc</i> u pravilu <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Payload_keywords" class="external autonumber" rel="nofollow">[68]</a>: <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Rpc.png" class="image"><img alt="Rpc.png" src="../images/1/11/Rpc.png" width="328" height="73" /></a>
</p><p><br />
<b>10. pcre</b><br />
Ključna riječ <i>pcre</i> (eng. <i>Perl Compatible Regular Expressions</i>) se koristi kod podudaranja regularnih izraza. Kompleksnost ove ključne riječi odražava se u smislu negativnih posljedica na performanse Suricate. Prema tome, kako bi se izbjeglo prečesto provjeravanje pcre, ta ključna riječ se onda najčešće kombinira s <i>content</i> na način da se content prvi provjerava i ako se on podudara tek se onda prelazi na provjeravanje pcre.<a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/HTTP-keywords#Pcre-Perl-Compatible-Regular-Expressions" class="external autonumber" rel="nofollow">[69]</a> <br />
Format <i>pcre</i>:
</p>
<pre>“/&lt;regex&gt;/opts”;
</pre>
<p>Primjer <i>pcre</i>:
</p>
<pre>pcre:”/[0-9]{6}/”;
</pre>
<h5> <span class="mw-headline" id="HTTP-klju.C4.8Dne_rije.C4.8Di_.28eng._HTTP-keywords.29">HTTP-ključne riječi (eng. <i>HTTP-keywords</i>)</span></h5>
<p>Ključne riječi HTTP omogućavaju da potpis provjerava određeni dio mrežnog prometa, pa tako na primjer može provjeravati pojedinosti uri, kolačića (eng.cookies), HTTP body itd. <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/HTTP-keywords" class="external autonumber" rel="nofollow">[70]</a> <br />
</p><p><br />
<b>1. HTTP-zahtjev (eng. <i>HTTP-request</i>)</b><br />
</p>
<pre>GET /index. html/ HTTP/1.0\r\n
</pre>
<p>Objašnjenje primjera -&gt; GET je metoda. Metode su: GET, POST, PUT, HEAD itd. Uri je /index.html i HTTP/1.0 je  HTTP verzija. Od ovih verzija 0.9, 1.0, 1.1, najčešće se koriste 1.0 i 1.1.
<br />
<b>2. HTTP-odgovor (eng. <i>HTTP-response</i>)</b><br />
</p>
<pre>HTTP/1.0 200 OK\r\n
&lt;html&gt;
&lt;title&gt; some page &lt;/title&gt;
&lt;/HTML&gt;
</pre>
<p>Objašnjenje primjera -&gt; HTTP/1.0 je HTTP verzija, 200 je odgovor-kod, a OK je odgovor-poruka. <br />
Detaljniji primjer <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/HTTP-keywords" class="external autonumber" rel="nofollow">[71]</a>: <br />
<b>Zahtjev:</b><br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Request.png" class="image"><img alt="Request.png" src="../images/3/38/Request.png" width="349" height="388" /></a><br />
<b>Odgovor:</b><br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Response.png" class="image"><img alt="Response.png" src="../images/3/3e/Response.png" width="351" height="468" /></a> <br />
<b>Zahtjev:</b><br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Request2.png" class="image"><img alt="Request2.png" src="../images/8/8a/Request2.png" width="344" height="314" /></a><br />
Iako je kolačić zaglavlje ne može se podudarati s <i>http_header</i> jer ima svoju vlastitu ključnu riječ tzv. <i>http_cookie</i>. <br />
</p><p>Svaki dio tablice pripada tzv. međuspremniku (eng. <i>buffer</i>). Prema tome, HTTP_method pripada method_buffer, HTTP-headers pripada header buffer itd. Međuspremnik je dio koji Suricata drži u memoriji. Sve prethodno opisane ključne riječi se mogu koristiti u kombinaciji s <i>buffer</i>-om u potpisu. Ključne riječi <i>distance</i> i <i>within</i> su relativne, stoga se one mogu koristiti samo unutar istog međuspremnika. Znači, različiti međuspremnici se ne mogu povezati  s relativnim ključnim riječima.
</p><p><br />
<b>3. http_method</b><br />
S <i>http_method</i> <i>content</i> modifikatorom moguće je naći posebna podudaranja i to samo na <i>method_buffer</i>-u. Ključna riječ <i>http_method</i> se može koristiti u kombinaciji sa svim prethodno navedenim <i>content</i> modifikatorima poput: <i>depth, distance, offset, nocase i within.</i> Methode su: GET, POST, PUT, HEAD, DELETE, TRACE, OPTIONS, CONNECT i PATCH. <br />
Primjer metode u HTTP-zahtjevu: <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Method_request.png" class="image"><img alt="Method request.png" src="../images/1/1a/Method_request.png" width="340" height="106" /></a><br />
Primjer namjene metode: <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/HTTP-keywords" class="external autonumber" rel="nofollow">[72]</a> <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Purpose1.png" class="image"><img alt="Purpose1.png" src="../images/1/1f/Purpose1.png" width="303" height="464" /></a> 
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Purpose2.png" class="image"><img alt="Purpose2.png" src="../images/f/f7/Purpose2.png" width="305" height="268" /></a> <br />
</p><p><br />
<b>4. http_uri i http_raw_uri</b><br />
S http_uri i http_raw_uri <i>content</i> modifikatorima moguće je naći posebna podudaranja i to samo na <i>uri-buffer</i>-u. Ove ključne riječi mogu se koristiti u kombinaciji sa svim prethodno spomenutim <i>content</i> modifikatorima poput: <i>depth, distance, offset, nocase i within.</i> <br />
Primjer <i>uri</i> u HTTP-zahtjevu:
</p>
<pre>GET<b>/index.html</b> HTTP/1.0\r\n 
</pre>
<p>Primjer namjene http_uri <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/HTTP-keywords" class="external autonumber" rel="nofollow">[73]</a>: <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Http_uri.png" class="image"><img alt="Http uri.png" src="../images/6/6b/Http_uri.png" width="340" height="231" /></a> <br />
</p><p><br />
<b>5. http_header</b><br />
S http_header <i>content</i> modifikatorom moguće je naći posebna podudaranja i to samo na <i>header-buffer</i>-u. Ova ključna riječ može se koristiti u kombinaciji sa svim prethodno spomenutim <i>content</i> modifikatorima poput: <i>depth, distance, offset, nocase i within.</i> <br />
Primjer <i>header</i> u HTTP-zahtjevu <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/HTTP-keywords" class="external autonumber" rel="nofollow">[74]</a>: <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Header.png" class="image"><img alt="Header.png" src="../images/a/a6/Header.png" width="330" height="91" /></a> <br />
Primjer namjene http_header: <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Purpose_header.png" class="image"><img alt="Purpose header.png" src="../images/9/9b/Purpose_header.png" width="351" height="415" /></a>
</p><p><br />
<b>6. http-cookie</b><br />
S http_cookie <i>content</i> modifikatorom moguće je naći posebna podudaranja i to samo na <i>cookie-buffer</i>-u. Ova ključna riječ može se koristiti u kombinaciji sa svim prethodno spomenutim <i>content</i> modifikatorima poput: <i>depth, distance, offset, nocase i within.</i> <br />
Primjer <i>cookie</i> u HTTP-zahtjevu <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/HTTP-keywords" class="external autonumber" rel="nofollow">[75]</a>: <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Http_cookie.png" class="image"><img alt="Http cookie.png" src="../images/b/b6/Http_cookie.png" width="324" height="168" /></a> <br />
Primjer namjene http_cookie: <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Purpose_cookie.png" class="image"><img alt="Purpose cookie.png" src="../images/4/4c/Purpose_cookie.png" width="347" height="283" /></a>
</p><p><br />
<b>7. http_user_agent</b><br />
S ključnom riječi http_user_agent <i>content</i> modifikatorom moguće je naći posebna podudaranja na temelju vrijednosti <i>User-Agent header</i>-a. Ova ključna riječ može se koristiti u kombinaciji sa svim prethodno spomenutim <i>content</i> modifikatorima poput: <i>depth, distance, offset, nocase i within.</i> <i>Pcre</i> također može pregledati ovaj međuspremnik s /V modifikatorom.
</p><p><br />
<b>8. http_client_body</b><br />
S http_client_body <i>content</i> modifikatorom moguće je naći posebna podudaranja i to samo na <i>request-body</i>-ju. Ova ključna riječ može se koristiti u kombinaciji sa svim prethodno spomenutim <i>content</i> modifikatorima poput: <i>distance, offset, nocase i within.</i> <br />
Primjer <i>client_body</i> u HTTP-zahtjevu <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/HTTP-keywords" class="external autonumber" rel="nofollow">[76]</a>: <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Client_body.png" class="image"><img alt="Client body.png" src="../images/f/fd/Client_body.png" width="238" height="109" /></a> <br />
Primjer namjene <i>http_client_body</i>:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Purpose_client.png" class="image"><img alt="Purpose client.png" src="../images/3/39/Purpose_client.png" width="329" height="285" /></a>
<br />
</p><p><b>9. http_stat_code</b><br />
S http_stat_body <i>content</i> modifikatorom moguće je naći posebna podudaranja i to samo na <i>stat-code-buffer</i>-om. Ova ključna riječ može se koristiti u kombinaciji sa svim prethodno spomenutim <i>content</i> modifikatorima poput: <i>distance, offset, nocase i within.</i> <br />
Primjer <i>http_stat_code</i> u HTTP-zahtjevu <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/HTTP-keywords" class="external autonumber" rel="nofollow">[77]</a>: <br />
</p>
<pre>HTTP/1.1.<b>302</b> Found
</pre>
<p>Primjer namjene <i>http_stat_code</i>:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Http_stat_code.png" class="image"><img alt="Http stat code.png" src="../images/a/ad/Http_stat_code.png" width="331" height="254" /></a>
<br />
</p><p><b>10. http_stat_msg</b><br />
S http_stat_msg <i>content</i> modifikatorom moguće je naći posebna podudaranja i to samo na <i>stat-msg-buffer</i>-u. Ova ključna riječ može se koristiti u kombinaciji sa svim prethodno spomenutim <i>content</i> modifikatorima poput: <i>depth, distance, offset, nocase i within.</i> <br />
Primjer <i>http_stat_msg</i> u HTTP-zahtjevu <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/HTTP-keywords" class="external autonumber" rel="nofollow">[78]</a>: <br />
</p>
<pre>HTTP/1.1.302 <b>Found</b>
</pre>
<p>Primjer namjene <i>http_stat_msg</i>:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Http_stat_msg.png" class="image"><img alt="Http stat msg.png" src="../images/e/e1/Http_stat_msg.png" width="343" height="275" /></a>
<br />
</p><p><b>11. http-server_body</b><br />
S http_server_body <i>content</i> modifikatorom moguće je naći posebna podudaranja i to samo na <i>response-body</i>-ju. Ova ključna riječ može se koristiti u kombinaciji sa svim prethodno spomenutim <i>content</i> modifikatorima poput: <i>distance, offset, nocase i within.</i> <br />
</p><p><b>12. file_data</b><br />
S file_data se pregledava tijelo HTTP odgovora, kao što se radi s <i>http_server_body</i>. Ključna riječ file_data radi na malo drugačiji način od ostalih modifikatora <i>content</i>-a. Kada se koristi u pravilu sav popratni sadržaj (<i>content</i>) je pogođen njegovim "djelovanjem".
</p>
<pre>alert http any any -&gt; any any (file_data; content:"abc"; content:"xyz";)
</pre>
<p><br />
<b>13. fast_pattern</b><br />
Samo jedan <i>content</i> potpisa se koristi kao <i>Multi Pattern Matcher</i> (MPM). Ako postoji nekoliko <i>content</i>-a, Suricata će izabrati najsnažniji <i>content</i> po tome što će ocijeniti kombinaciju duljine i raznolikost sadržaja. Što je sadržaj dulji i raznolikiji to je jači. Ponekad pisac potpisa želi uključiti drugačiji <i>content</i> od onoga koji je zadan po <i>defaultu</i> u Suricati. <br />
Na primjer:
</p>
<pre>content:”User-Agent|3A|”;
content:”Badness”; distance:0; fast_pattern;
</pre>
<p>Iako je prvi sadržaj duži i raznolikiji od drugog, pomoću <i>fast_pattern</i> se ipak može "natjerati" Suricatu da koristi drugi <i>content</i>.<br />
</p><p><b>14. fast_pattern:only</b><br />
Ponekad potpis sadrži samo jedan <i>content</i>. Ako se podudaranje pronašlo pomoću MPM nije potrebno više da Suricata dalje traži. U slučaju samo jednog <i>content</i>-a čitav potpis će se podudarati, te će biti označen s 'fast_pattern:only;', a to će Suricata automatski prepoznati. Iako takvo označavanje više nije potrebno, ali Suricata ga još uvijek prepoznaje, odnosno podržava.
</p><p><br />
<b>15. fast_pattern: 'chop'</b><br />
U slučaju kada se ne želi da MPM koristi čitav content koristi se <i>fast_pattern 'chop'</i> kao što je prikazano u sljedećem primjeru:
</p>
<pre>content: “aaaaaaaaabc”; fast_pattern:8,4;
</pre>
<p>U ovom primjeru MPM koristi samo zadnja četiri znaka.
</p><p><br />
<b>16. urilen</b><br />
Ključna riječ urilen koristi za podudaranje po dužini <i>uri</i>-ja. Također, moguće je koristiti &lt; i &gt; ako je potrebno. <br />
Format urilen:
</p>
<pre>urilen:3;
urilen:1;
urilen:&gt;1;
urilen:&lt;10;
urilen:10&lt;&gt;20;    //(veće od 10, manje od 20)
</pre>
<p><br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Aleksandra.sobodic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Aleksandra.sobodic (stranica ne postoji)">Aleksandra Sobodić</a> 23:10, 14. siječnja 2013. (CET)
</p>
<h5> <span class="mw-headline" id="Tokovne_klju.C4.8Dne_rije.C4.8Di_.28eng._Flow-keywords.29">Tokovne ključne riječi (eng. <i>Flow-keywords</i>)</span></h5>
<p><b>1. Flowbits</b><br />
<i>Flowbits</i> se sastoje od dva dijela. Prvi dio opisuje akciju koja će se izvesti, a drugi dio je naziv <i>flowbit</i>-a.
Nekoliko paketa pripada jednom <i>flow</i>-u. Suricata te <i>flows</i> drži u memoriji. <i>Flowbits</i> osigurava da će upozorenje biti generirano kada na primjer se dva različita paketa budu podudarala. Upozorenje će biti jedino generirano ako se oba paketa podudaraju. Stoga, kada se drugi paket podudara, Suricata mora znati da li se i prvi paket podudara. <i>Flowbits</i> označava <i>flow</i> ako se paket podudara, pa tako Suricata "zna" da mora generirati upozorenje kada se drugi paket isto podudara. <br />
<i>Flowbits</i> imaju različite akcije. To su:    
</p>
<pre>flowbits: set, name                Will set the condition/'name', if present, in the flow.
flowbits: isset, name              Can be used in the rule to make sure it generates an alert                          
                                   when the rule matches and the condition is set in the flow.
flowbits: toggle, name             Reverses the present setting. So for example if a condition is set, 
                                   it will be unset and vice-versa.
flowbits: unset, name              Can be used to unset the condition in the flow.
flowbits: isnotset, name           Can be used in the rule to make sure it generates an alert
                                   when it matches and the condition is not set in the flow.
</pre>
<p>Primjer <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Flow-keywords" class="external autonumber" rel="nofollow">[79]</a>:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Primjer_flowbits.png" class="image"><img alt="Primjer flowbits.png" src="../images/0/03/Primjer_flowbits.png" width="334" height="347" /></a>
</p><p><br />
<b>2. Flow</b><br />
<i>Flow</i> ključna riječ se može koristiti prilikom podudaranja smjera <i>flow</i>-a prema klijentu ili serveru, te ako je <i>flow</i> uspostavljen ili ne.
Prema tome, flow ključna riječ odgovara:
</p>
<pre>To_client                       established                
to_server                       stateless
</pre>
<p>Ove opcije se mogu kombinirati. Može se koristiti jedna od svakog para opcija. Primjer <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Flow-keywords" class="external autonumber" rel="nofollow">[80]</a>: <br />
</p>
<pre>flow:to_client, established;
</pre>
<p><a href="http://security.foi.hr/wiki/index.php/Datoteka:Flow1.png" class="image"><img alt="Flow1.png" src="../images/8/84/Flow1.png" width="352" height="302" /></a>
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Flow2.png" class="image"><img alt="Flow2.png" src="../images/f/fb/Flow2.png" width="331" height="310" /></a>
</p><p><br />
<b>3. Flowint</b><br />
<i><b>stream_size</b></i><br />
Stream_size opcija odgovara prometu prema registriranoj količini bajtova od slijednih brojeva.
Postoji nekoliko modifikatora ove ključne riječi:
</p>
<pre>&gt;      veće od 
&lt;      manje od
=      jednako
!=     različito
&gt;=     veće od ili jednako
&lt;=     manje od ili jednako
</pre>
<p>Format <br />
</p>
<pre>stream_size:&lt;server|client|both|either&gt;, &lt;modifier&gt;, &lt;number&gt;;
</pre>
<h5> <span class="mw-headline" id="IP_reputacijska_pravila_.28eng._IP_Reputation_Rule.29">IP reputacijska pravila (eng. <i>IP Reputation Rule</i>)</span></h5>
<p>IP Reputation se može koristiti u pravilima kroz direktivu novog pravila "iprep".<br />
</p><p><b>1. iprep</b> <br />
<i>Iprep</i> direktiva se podudara prema IP reputation informaciji za host.
</p>
<pre>iprep:&lt;side to check&gt;,&lt;cat&gt;,&lt;operator&gt;,&lt;value&gt;
side to check: &lt;any|src|dst|both&gt;
cat: the category short name
operator: &lt;, &gt;, =
value: 1-127
</pre>
<p>Primjer <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/IPReputationRules" class="external autonumber" rel="nofollow">[81]</a>:
</p>
<pre>alert ip $HOME_NET any -&gt; any any (msg:"IPREP internal  host talking to CnC server"; flow:to_server; iprep:dst,CnC,&gt;,30; sid:1; rev:1;)
</pre>
<p><b>2. IP-only</b><br />
"Iprep" ključna riječ je kompatibilna s "IP-only" pravilima. To znači da pravilo izgleda ovako:
</p>
<pre>alert ip any any -&gt; any any (msg:"IPREP High Value CnC"; iprep:src,CnC,&gt;,100; sid:1; rev:1;)
</pre>
<p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Aleksandra.sobodic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Aleksandra.sobodic (stranica ne postoji)">Aleksandra Sobodić</a> 15:34, 13. siječnja 2013. (CET)
</p>
<h4> <span class="mw-headline" id="Klju.C4.8Dne_rije.C4.8Di_zaglavlja_.28eng._Header_keywords.29">Ključne riječi zaglavlja (eng. <i>Header keywords</i>)</span></h4>
<h5> <span class="mw-headline" id="IP-klju.C4.8Dne_rije.C4.8Di_.28eng._IP-keywords.29">IP-ključne riječi (eng. <i>IP-keywords</i>)</span></h5>
<p><br />
<b>1. ttl</b><br />
TTL (eng. <i>time-to-live</i>) ključna riječ se koristi kako bi se provjerila određena IP TTL vrijednost u zaglavlju paketa.<br />
Format je:<br />
</p>
<pre>ttl:&lt;number&gt;
</pre>
<p><br />
Na primjer:<br />
</p>
<pre>ttl:10;
</pre>
<p>TTL vrijednost određuje maksimalno vrijeme unutar kojega se paket nalazi u internet-sustavu. Ako je ovo polje postavljeno na 0, onda paket mora biti uništen. TTL se temelji na <i>hop count</i>. Svaki hop/router paket koji prođe se oduzima od paketa TTL brojača. Svrha ovog mehanizma je ograničiti postojanje paketa na taj način da paketi ne završe u beskonačnim usmjeravajućim petljama.<br />
Primjer TTL ključne riječi u pravilu:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Ttl.jpg" class="image"><img alt="Ttl.jpg" src="../images/2/25/Ttl.jpg" width="362" height="76" /></a>
<br />
<b>2. Ipopts</b><br />
Sa ipopts ključnom riječi može se provjeriti da li je određena IP opcija postavljena. Ipopts se treba koristiti na početku pravila. Može se odgovarati samo jednoj opciji po pravilu. Postoji nekoliko opcija koje mogu biti podudarane. To su: <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Header_keywords" class="external autonumber" rel="nofollow">[82]</a><br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Ip_options.jpg" class="image"><img alt="Ip options.jpg" src="../images/6/65/Ip_options.jpg" width="352" height="266" /></a>
<br />
Format od ipopts ključne riječi:<br />
</p>
<pre>ipopts: &lt;name&gt;
</pre>
<p>Primjer:<br />
</p>
<pre>ipopts: lsrr;
</pre>
<p>Primjer ipopts-a u pravilu: <br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Ipopts.jpg" class="image"><img alt="Ipopts.jpg" src="../images/4/4b/Ipopts.jpg" width="345" height="63" /></a>
<br />
<b>3. sameip</b><br />
Svaki paket ima izvorišnu i odredišnu IP adresu. Može biti da su izvorišna i odredišna adresa jednake, identične. Sa sameip ključnom riječi može se provjeriti da li je IP adresa izvora ista kao i IP adresa odredišta.<br />
Format sameip ključne riječi je:<br />
</p>
<pre>sameip;
</pre>
<p>Primjer sameip ključne riječi u pravilu:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Sameip.jpg" class="image"><img alt="Sameip.jpg" src="../images/5/5e/Sameip.jpg" width="347" height="84" /></a>
<br />
<b>4. ip_proto</b><br />
Sa ključnom riječi ip_proto može se naći odgovarajući IP protokol u zaglavlju paketa. U ovom slučaju može se koristiti naziv ili broj protokola. Mogu se uskladiti primjerice sljedeći protokoli:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Protokoli_ip_proto.jpg" class="image"><img alt="Protokoli ip proto.jpg" src="../images/9/9c/Protokoli_ip_proto.jpg" width="654" height="120" /></a>
<br />
Primjer ip_proto ključne riječi u pravilu:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Proto_rule.jpg" class="image"><img alt="Proto rule.jpg" src="../images/5/5f/Proto_rule.jpg" width="364" height="73" /></a>
<br />
<b>5. id</b><br />
Sa id ključnom riječi može se podudarati specifična IP ID vrijednost. ID identificira svaki paket poslan od strane hosta i inkrementira se za jedan svakim paketom koji je sljedeći poslan. IP ID se koristi kao fragment identifikacijskog broja. Svaki paket posjeduje IP ID, te kada postane fragmentiran, svi njegovi fragmenti imaju isti ID. Na taj način primatelj paketa zna koji fragmenti pripadaju istom paketu. S obzirom da se IP ID ne brine o poretku u tom slučaju se onda koristi <i>offset</i> koji će razjasniti poredak fragmenata.<br />
Format id:<br />
</p>
<pre>id:&lt;number&gt;;
</pre>
<p>Primjer id ključne riječi u pravilu:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Id.jpg" class="image"><img alt="Id.jpg" src="../images/1/1c/Id.jpg" width="367" height="155" /></a>
<br />
<b>6. Fragbits</b><br />
Sa ključnom riječi fragbits može se provjeriti da li su fragmentacija i rezervirani bitovi postavljeni u IP zaglavlju. Ova ključna riječ mora biti smještena na početku pravila. Fragbits se koristi u svrhu modifikacije fragmentacijskog mehanizma. Tijekom usmjeravanja poruka od jednog internet modula k drugome može se dogoditi da paket koji je veći od pakata maksimalne veličine kojeg mreža može obraditi, u tom slučaju paket će biti poslan u fragmentima. Maksimalna veličina paketa se zove Maximal Transmit Unit (MTU).<br />
Mogu se podudarati sljedeći bitovi:<br />
</p>
<pre>M - More Fragments 
D - Do not Fragment 
R - Reserved Bit
</pre>
<p>Podudaranje na sljedećim bitovima se može detaljnije odrediti sa sljedećim modifikatorima:<br />
</p>
<pre>+         match on the specified bits, plus any others 
*         match if any of the specified bits are set 
!         match if the specified bits are not set
</pre>
<p>Format:<br />
</p>
<pre>fragbits:[*+!]&lt;[MDR]&gt;;
</pre>
<p>Primjer fragbits  u pravilu:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Fragbits.jpg" class="image"><img alt="Fragbits.jpg" src="../images/9/90/Fragbits.jpg" width="333" height="133" /></a>
<br />
<b>7. Fragoffset</b><br />
Sa fragoffset ključnom riječi može se provjeriti specifična decimalna vrijednost od IP fragmenta offset polja. Ako se želi provjeriti prvi fragment sesije potrebno je kombinirati fragoffset 0 sa More Fragment opcijom. Fragmentacijsko offset polje je podobno za rastavljanje. Id se pri tom koristi kako bi se odredilo koji fragmenti pripadaju kojem paketu a fragmentacijsko offset polje će razjasniti poredak fragmenata.<br />
</p>
<pre>&lt;       match if the value is smaller than the specified value
&gt;       match if the value is greater than the specified value
!       match if the specified value is not present
</pre>
<p>Format fragoffset:<br />
</p>
<pre>fragoffset:[!|&lt;|&gt;]&lt;number&gt;;
</pre>
<p>Primjer fragoffset u pravilu:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Fragoffset.jpg" class="image"><img alt="Fragoffset.jpg" src="../images/6/69/Fragoffset.jpg" width="342" height="135" /></a>
</p>
<h5> <span class="mw-headline" id="TCP-klju.C4.8Dne_rije.C4.8Di_.28eng._TCP-keywords.29">TCP-ključne riječi (eng. <i>TCP-keywords</i>)</span></h5>
<p><br />
<b>1. seq</b><br />
Ključna riječ seq se koristi u potpisu kako bi se provjerio specifičan TCP slijedni broj. Slijedni broj je broj koji se nasumično generira od strane krajnjih čvorova TCP konekcije. I klijent i server kreiraju slijedan broj koji se povećava za jedan svakim poslanim bajtom. Stoga je slijedni broj različit za klijenta i za servera odnosno za obje strane. Međutim slijedni broj mora biti potvrđen s obje strane konekcije. Kroz slijedne brojeve TCP rukuje potvrdama, redoslijedom i retransmisijom. seq drži zapis o tome na kojem mjestu se nalazi bajt u podatkovnom prijenosu. Ako je SYN zastavica postavljena na 1 tada je slijedni broj prvog bajta podatka je taj broj plus 1, što na kraju iznosi 2.
Primjer:<br />
</p>
<pre>seq:0;
</pre>
<p>Primjer seq u potpisu:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Seq.jpg" class="image"><img alt="Seq.jpg" src="../images/e/e7/Seq.jpg" width="345" height="88" /></a>
<br />
<b>2. ack</b><br />
Ključna riječ ack je potvrda primitka svih prethodno poslanih podataka u bajtovima poslanih s druge strane konekcije. U većini slučajeva svaki paket TCP konekcije ima ack zastavicu nakon prve SYN i ack broj koji se povećava s primitkom svakog novog podatka u bajtovima. Ključna riječ ack koristi se u potpisu kako bi se provjerio TCP broj potvrde.<br />
Format ack:<br />
</p>
<pre>ack:1;
</pre>
<p>Primjer ack u potpisu:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Ack.jpg" class="image"><img alt="Ack.jpg" src="../images/d/d9/Ack.jpg" width="327" height="91" /></a>
<br />
<b>3. Window</b><br />
Ključna riječ window koristi se za provjeru TCP veličine prozora. TCP veličina prozora je mehanizam koji ima kontrolu nad protokom podataka. Prozor je postavljen od primatelja  i upućuje na količinu bajtova koja može biti primljena. Ta količina podataka mora biti prvo potvrđena od strane primatelja prije nego li pošiljatelj može poslati istu količinu novih podataka. Ovaj mehanizam se koristi kako bi se spriječilo da primatelj bude zatrpan podacima. Vrijednost veličine prozora je ograničena i može iznositi od 2 do 65.535 bjtova.
Format window:<br />
</p>
<pre>window:[!]&lt;number&gt;;
</pre>
<p>Primjer window u pravilu:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Window.jpg" class="image"><img alt="Window.jpg" src="../images/7/77/Window.jpg" width="343" height="88" /></a>
</p>
<h5> <span class="mw-headline" id="ICMP-klju.C4.8Dne_rije.C4.8Di_.28eng._ICMP-keywords.29">ICMP-ključne riječi (eng. <i>ICMP-keywords</i>)</span></h5>
<p><br />
ICMP (<i>Internet Control Message Protocol</i>) je dio IP koji sam po sebi nije vrlo pouzdan ako se radi o isporučivanju podataka (podatkovni dijagram). ICMP daje povratnu informaciju u slučaju da dođe do određenih problema, što znači da on ne spriječava da se problem dogodi već samo pomaže u razumijevanju onoga što se dogodilo. Ako je pouzdanost potrebna, protokoli koji koriste IP moraju sami preuzeti tu pouzdanost. U različitim situacijama ICMP poruke će biti poslane kao što na primjer je to u slučaju da je odredište nedostupno ili ako ne postoji  dovoljno kapaciteta u međuspremniku za prosljeđivanje podataka ili kada  je dijagram podataka poslan fragmentirano u trenutku kada to ne bi trebao biti itd. Postoje 4 važna sadržaja ICMP poruke koja odgovaraju ICMP ključnim riječima - tip, kod, id i slijed poruke.<br />
<b>1. itype</b><br />
Ključna riječ itype služi za podudaranje s posebnom ICMP vrstom (broja). ICMP ima nekoliko vrsta poruka i koristi kodove da bi razjasnio te poruke. Različite poruke se razlikuju po drugačijim imenima ali ono što je najvažnije je da se razlikuju po brojčanim vrijednostima.<br />
Format itype:<br />
</p>
<pre>itype:min&lt;&gt;max; 
itype:[&lt;|&gt;]&lt;number&gt;;
</pre>
<p>Primjer itype u potpisu:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Itype.jpg" class="image"><img alt="Itype.jpg" src="../images/f/f6/Itype.jpg" width="350" height="65" /></a>
<br />
<b>2. icode</b><br />
Sa ključnom riječi icode može se provjeriti podudaranje s ICMP kodom. Kod ICMP poruke pojašnjava poruku. Zajedno sa ICMP-tipom ukazuje na određeni problem koji se pojavio. S obzirom na ICMP-tip kod će imati različitu namjenu.<br />
Format icode ključne riječi:<br />
</p>
<pre>icode:min&lt;&gt;max; 
icode:[&lt;|&gt;]&lt;number&gt;;
</pre>
<p>Primjer icode ključne riječi u pravilu:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Icode.jpg" class="image"><img alt="Icode.jpg" src="../images/6/65/Icode.jpg" width="357" height="52" /></a>
<br />
<b>3. icmp_id</b><br />
S icmp_id ključnom riječi može se naći odgovarajuća ICMP id-vrijednost. Svaki ICMP-paket dobiva id u trenutku slanja. U trenutku kada primatelj zaprimi paket, poslat će odgovor koristeći isti id kako bi ga pošiljatelj prepoznao i povezao ga s ispravnim ICMP-zahtjevom.<br />
Format icmp_id ključne riječi:<br />
</p>
<pre>icmp_id:&lt;number&gt;;
</pre>
<p>Primjer icmp_ključne riječi u pravilu:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Icmp_id.jpg" class="image"><img alt="Icmp id.jpg" src="../images/c/c7/Icmp_id.jpg" width="352" height="69" /></a>
<br />
<b>4. icmp_seq</b><br />
Ključna riječ icmp_seq se koristi za provjeru ICMP slijednog broja. Sve ICMP poruke imaju slijedne brojeve što može biti vrlo korisno (zajedno s id-em) za provjeravanje koja poruka odgovora pripada kojoj poruci zahtjeva.<br />
Format icmp_seq ključne riječi:<br />
</p>
<pre>icmp_seq:&lt;number&gt;;
</pre>
<p>Primjer icmp_ključne riječi u pravilu:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Icmp_seq.jpg" class="image"><img alt="Icmp seq.jpg" src="../images/f/f7/Icmp_seq.jpg" width="364" height="66" /></a><br />
Tipovi poruka i brojevi:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Tipovi_poruka.jpg" class="image"><img alt="Tipovi poruka.jpg" src="../images/c/c7/Tipovi_poruka.jpg" width="258" height="458" /></a><br />
Značenje tipova brojeva i kodova u kombinaciji:<br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Kombinacije.jpg" class="image"><img alt="Kombinacije.jpg" src="../images/0/08/Kombinacije.jpg" width="500" height="752" /></a>
<br />
<a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Header_keywords" class="external autonumber" rel="nofollow">[83]</a>
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Ivanko.Zekic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Ivanko.Zekic (stranica ne postoji)">Ivanko Zekić</a> 22:04, 14. siječnja 2013. (CET)
</p>
<h4> <span class="mw-headline" id="Datote.C4.8Dne_klju.C4.8Dne_rije.C4.8Di_.28eng._File-keywords.29">Datotečne ključne riječi (eng. <i>File-keywords</i>)</span></h4>
<p>Suricata dolazi s nekoliko pravila vezanih uz svojstva datoteka. <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/File-keywords" class="external autonumber" rel="nofollow">[84]</a>
</p>
<table border="1">
<tr>
<td align="middle"><b>keyword</b>
</td>
<td align="middle"><b>sintaksa</b>
</td>
<td align="middle"><b>primjer</b>
</td></tr>
<tr>
<td> <b>filename</b>
</td>
<td align="middle"> filename:&lt;string&gt;;
</td>
<td align="middle"> filename:"secret";
</td></tr>
<tr>
<td> <b>fileext</b>
</td>
<td align="middle"> fileext:&lt;string&gt;;
</td>
<td align="middle"> fileext:"jpg";
</td></tr>
<tr>
<td> <b>filemagic</b>
</td>
<td align="middle"> filemagic:&lt;string&gt;;
</td>
<td align="middle"> filemagic:"executable for MS Windows";
</td></tr>
<tr>
<td> <b>filestore</b>
</td>
<td align="middle"> filestore:&lt;direction&gt;,&lt;scope&gt;;
</td>
<td align="middle"> direction: &lt;request/to_server, response/to_client, both&gt;
<p>scope: &lt;file, tx, ssn/flow&gt;
</p>
</td></tr>
<tr>
<td> <b>filemd5</b>
</td>
<td align="middle"> filemd5:[!]filename;
</td>
<td align="middle"> filemd5:md5-blacklist;
<p>filemd5:!md5-whitelist;
</p>
</td></tr>
<tr>
<td> <b>filesize</b>
</td>
<td align="middle"> filesize:&lt;value&gt;;
</td>
<td align="middle"> filesize:100; # točno 100 bajtova
<p>filesize:100&lt;&gt;200; # veća od 100 i manja od 200
</p><p>filesize:&gt;100; # veća od 100
</p><p>filesize:&lt;100; # manja od 100
</p>
</td></tr></table>
<p><br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Dario.Supan&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Dario.Supan (stranica ne postoji)">Dario Supan</a> 18:01, 13. siječnja 2013. (CET)
</p>
<h4> <span class="mw-headline" id="Rule-thresholding">Rule-thresholding</span></h4>
<p>Tresholding predstavljanji oblik grupiranja odnosno segmentacije. Suricata koristi ključnu riječ <b>threshold</b> za kontrolu učestalosti aktiviranja upozorenja. Threshold može biti konfiguriran za svako pravilo posebno ili se može dodijeliti globalno. Sintaksa:
</p>
<pre>threshold: type &lt;threshold|limit|both&gt;, track &lt;by_src|by_dst&gt;, count &lt;N&gt;, seconds &lt;T&gt;
</pre>
<p>Iz sintakse je vidljivo da možemo birati između 3 moda - <b>treshold</b>, <b>limit</b> i <b>both</b>. Detaljnije ćemo pojasniti na primjerima. 
</p><p>Tip <i>threshold</i> (postavljamo željenu vrijednost N, kada pravilo bude pogođeno N puta Suricata šalje upozorenje):
</p>
<pre>alert tcp&#160;!$HOME_NET any -&gt; $HOME_NET 25 (msg:"ET POLICY Inbound Frequent Emails - Possible Spambot Inbound"; \
    flow:established; content:"mail from|3a|"; nocase;                                                       \
    threshold: type threshold, track by_src, count 10, seconds 60;                                           \
    reference:url,doc.emergingthreats.net/2002087; classtype:misc-activity; sid:2002087; rev:10;)
</pre>
<p>U navedenom primjeru, upozorenje se dobiva ukoliko s istog servera, u roku od 1 minute, primimo 10 ili više mailova.
</p><p>Tip <i>limit</i> (upotrebljava se kad ne želimo da nas sustav preplavi s upozorenjima):
</p>
<pre>alert http $HOME_NET any -&gt; any $HTTP_PORTS (msg:"ET USER_AGENTS Internet Explorer 6 in use - Significant Security Risk"; \
    flow:to_server,established; content:"|0d 0a|User-Agent|3a| Mozilla/4.0 (compatible|3b| MSIE 6.0|3b|";                \
    threshold: type limit, track by_src, seconds 180, count 1;                                                           \
    reference:url,doc.emergingthreats.net/2010706; classtype:policy-violation; sid:2010706; rev:7;)
</pre>
<p>U ovom slučaju ćemo dobivati maksimalno 1 mail po <i>hostu</i> u periodu od 3 minute.
</p><p>Tip <i>both</i> (kombinacija prva dva tipa):
</p>
<pre>alert tcp $HOME_NET 5060 -&gt; $EXTERNAL_NET any (msg:"ET VOIP Multiple Unauthorized SIP Responses TCP"; \
    flow:established,from_server; content:"SIP/2.0 401 Unauthorized"; depth:24;                      \
    threshold: type both, track by_src, count 5, seconds 360;                                        \
    reference:url,doc.emergingthreats.net/2003194; classtype:attempted-dos; sid:2003194; rev:6;)
</pre>
<p>U ovom slučaju će biti poslano upozorenje ako se u 6 minuta pojavi 5 ili više <b>SIP/2.0 401 Unauthorized</b> odgovora. Javiti će se samo 1 upozorenje u tih 6 minuta.
</p><p>U ovom području nam je važna još jedna ključna riječ - <b>detection_filter</b>. Služi za istu stvar kao threshold, ali radi na malo drugačiji način. Ukoliko postavimo da nam se upozorenje šalje nakon što je neko pravilo pogođeno 6 puta onda će nam se upozorenje poslati nakon što se pravilo pogodilo 6., 7., 8. put itd. Sintaksa 
</p>
<pre>detection_filter: track &lt;by_src|by_dst&gt;, count &lt;N&gt;, seconds &lt;T&gt;
</pre>
<p>Primjer:
</p>
<pre>alert http $EXTERNAL_NET any -&gt; $HOME_NET any \
    (msg:"ET WEB_SERVER WebResource.axd access without t (time) parameter - possible ASP padding-oracle exploit"; \
    flow:established,to_server; content:"GET"; http_method; content:"WebResource.axd"; http_uri; nocase;          \
    content:!"&amp;t="; http_uri; nocase; content:!"&amp;amp|3b|t="; http_uri; nocase;                                    \
    detection_filter:track by_src,count 15,seconds 2;                                                             \
    reference:url,netifera.com/research/; reference:url,www.microsoft.com/technet/security/advisory/2416728.mspx; \
    classtype:web-application-attack; sid:2011807; rev:5;)
</pre>
<p>Upozorenje se šalje kada u roku od 2 sekunde nastane 15 ili više pogodaka. <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Rule-Thresholding" class="external autonumber" rel="nofollow">[85]</a>
</p><p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Dario.Supan&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Dario.Supan (stranica ne postoji)">Dario Supan</a> 17:33, 13. siječnja 2013. (CET)
</p>
<h4> <span class="mw-headline" id="Lua_skriptiranje">Lua skriptiranje</span></h4>
<p>Lua je naziv za jezik koji nam služi za izradu skripti (eng. scripting language). <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Lua_scripting" class="external autonumber" rel="nofollow">[86]</a> <br /> Sintaksa glasi:
</p>
<pre>luajit:[!]&lt;scriptfilename&gt;;
</pre>
<p>Ime skripte se automatski dodaje na mjesto gdje smo dali da nam se nalaze pravila. Skripta se sastoji od 2 dijela <b>init</b>(inicijalizacija) i <b>match</b>(provjera da li nešto odgovara traženom uzorku). <i>Init</i> funkcija:
</p>
<pre>function init (args)
   local needs = {}
   needs["http.request_line"] = tostring(true)
   return needs
end
</pre>
<p>Navedena funkcija registrira spremnike (eng. buffers) koji trebaju inspekciju. Popis trenutačno dostunih spremnika (HTTP spremnici mogu u jednom trenutku biti ispitivani od strane samo jedne skripte):
</p>
<pre>   packet -- entire packet, including headers
   payload -- packet payload (not stream)
   http.uri
   http.uri.raw
   http.request_line
   http.request_headers
   http.request_headers.raw
   http.request_cookie
   http.request_user_agent
   http.request_body
   http.response_headers
   http.response_headers.raw
   http.response_body
   http.response_cookie
</pre>
<p><i>Match</i> funkcija:
</p>
<pre>function match(args)
   a = tostring(args["http.request_line"])
   if #a &gt; 0 then
       if a:find("^POST%s+/.*%.php%s+HTTP/1.0$") then
           return 1
       end
   end
   return 0
end
</pre>
<p>Ukoliko su uvjeti zadovoljeni funkcija vraća vrijednost 1, inače vraća 0.
</p><p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Dario.Supan&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Dario.Supan (stranica ne postoji)">Dario Supan</a> 16:35, 13. siječnja 2013. (CET)
</p>
<h4> <span class="mw-headline" id="Dodavanje_vlastitih_pravila">Dodavanje vlastitih pravila</span></h4>
<p>Ako se želi kreirati pravilo te ga koristiti sa Suricatom, ovaj vodič bi trebao pomoći:<a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Adding_Your_Own_Rules" class="external autonumber" rel="nofollow">[87]</a><br />
Prvo treba stvoriti datoteku za pravilo. Primjer je u sljedećoj konzoli:<br />
</p>
<pre>sudo nano local.rules<br />
</pre>
<p>Potom napisati pravilo, te ga spremiti.<br />
Otvoriti yaml datoteku:<br />
</p>
<pre>sudo nano /etc/suricata/suricata.yaml<br />
</pre>
<p>Pobrinite se da <i>local.rules</i> datoteka se dodaje na popis pravila.<br />
Na kraju, pokrenuti Suricatu i vidjeti da li je pravilo učitano.<br />
</p>
<pre>suricata -c /etc/suricata/suricata.yaml -i wlan0<br />
</pre>
<p>U slučaju da se pravilo nije uspjelo učitati, treba provjeriti da li se pogriješilo tijekom pisanja pravila. Tražiti greške kod posebnih znakova, praznih prostora itd.<br />
Nadalje, treba provjeriti <i>log-files</i> dali su uključeni u suricata.yaml.<br />
Ako se pravilo mijenjalo i/ili nadogradilo u yaml-u, Suricatu je potrebno ponovno pokrenuti (<i>restart</i>).<br />
Ako se pravilo uspješno učitalo, možemo ga nekoliko puta provjeriti tako što napravimo nešto što bi ga nekoliko puta pokrenulo.<br />
Unesite:<br />
</p>
<pre>tail -f /var/log/suricata/fast.log<br />
</pre>
<p>Ako kreirate pravilo na ovaj način:<br />
</p>
<pre>alert http any any -&gt; any any (msg:"Do not read gossip during work"; 
content:"Scarlett"; nocase; classtype:policy-violation; sid:1; rev:1;)<br />
</pre>
<p>Vaša obavijest treba izgledati ovako:<br />
</p>
<pre>09/15/2011-16:50:27.725288  [**] [1:1:1] Do not read gossip during  work [**] 
[Classification: Potential Corporate Privacy Violation] [Priority: 1] {TCP} 192.168.0.32:55604 -&gt; 68.67.185.210:80<br />
</pre>
<p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Ivanko.Zekic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Ivanko.Zekic (stranica ne postoji)">Ivanko Zekić</a> 16:35, 13. siječnja 2013. (CET)
</p>
<h4> <span class="mw-headline" id="Live_Rule_Swap">Live Rule Swap</span></h4>
<p>Suricata podržava pravila <i>swapa</i>. Drugim riječima, ako se odluči za promjenu/ažuriranje/uklanjanje/dodavanje pravila to se može učiniti u tijeku bez zaustavljanja Suricate. <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Live_Rule_Swap" class="external autonumber" rel="nofollow">[88]</a><br />
</p><p>Ovo je način kako se može to učiniti.<br />
Prvo, treba se uvjeriti da su <i>live rule reloads</i> omogućena u konfiguraciji:<br />
</p>
<pre>detect-engine:
  - profile: medium
  - custom-values:
     toclient-src-groups: 2
     toclient-dst-groups: 2
     toclient-sp-groups: 2
     toclient-dp-groups: 3
     toserver-src-groups: 2
     toserver-dst-groups: 4
     toserver-sp-groups: 2
     toserver-dp-groups: 25
 - sgh-mpm-context: auto
 - inspection-recursion-limit: 3000
 # When rule-reload is enabled, sending a USR2 signal to the Suricata process
 # will trigger a live rule reload. Experimental feature, use with care.
 - rule-reload: true<br />
</pre>
<p>Recimo da je Suricata regularno pokrenuta s oko 11.000 pravila:<br />
</p>
<pre>root@ubuntu32:~/Downloads/oisf# suricata -c /etc/suricata/suricata.yaml -i eth0
[10571] 28/6/2012 -- 18:39:29 - (suricata.c:1194) &lt;Info&gt; (main) -- 
 This is Suricata version 1.3dev (rev 7109a05)
[10571] 28/6/2012 -- 18:39:34 - (detect.c:678) &lt;Info&gt; (SigLoadSignatures) -- 
 1 rule files processed. 11084 rules succesfully loaded, 0 rules failed
[10571] 28/6/2012 -- 18:39:39 - (detect.c:2627) &lt;Info&gt; (SigAddressPrepareStage1) -- 
 11092 signatures processed. 4 are IP-only rules, 3617 are inspecting packet payload, 8937 inspect application layer, 0 are decoder event only
[10571] 28/6/2012 -- 18:39:39 - (detect.c:2630) &lt;Info&gt; (SigAddressPrepareStage1) -- 
 building signature grouping structure, stage 1: adding signatures to signature source  addresses... complete
[10571] 28/6/2012 -- 18:39:40 - (detect.c:3254) &lt;Info&gt; (SigAddressPrepareStage2) -- 
 building signature grouping structure, stage 2: building source address list... complete
[10571] 28/6/2012 -- 18:39:41 - (detect.c:3914) &lt;Info&gt; (SigAddressPrepareStage3) -- 
 building signature grouping structure, stage 3: building destination address lists...  complete
[10571] 28/6/2012 -- 18:39:43 - (util-profiling.c:668) &lt;Info&gt; (SCProfilingInitRuleCounters) -- 
 Registered 11092 rule profiling counters.
[10571] 28/6/2012 -- 18:39:43 - (tm-threads.c:1961) &lt;Info&gt; (TmThreadWaitOnThreadInit) -- 
 all 2 packet processing threads, 3 management threads initialized, engine started.<br />
</pre>
<p>Postoji novi set ažuriranih pravila i ako su se napravile neke nove promjene na nekim pravilima i/ili ste dodali nova pravila i želite napraviti <i>live swap</i>.<br />
</p>
<pre>root@ubuntu32:~/Downloads# ps -af |grep suricata
root     10571  1786 19 18:39 pts/0    00:00:13 suricata -c /etc/suricata/suricata.yaml -i eth0
root     10583  1902  0 18:40 pts/1    00:00:00 grep --color=auto suricata<br />
</pre>
<p>Pošalji signal:<br />
</p>
<pre>root@ubuntu32:~/Downloads# kill -USR2 10571<br />
</pre>
<p>Suricata će ponovno učitati pravila:<br />
</p>
<pre>[10584] 28/6/2012 -- 18:40:48 - (detect-engine.c:80) &lt;Info&gt; (DetectEngineLiveRuleSwap) -- 
 ===== Starting live rule swap triggered by user signal USR2 =====
[10584] 28/6/2012 -- 18:40:52 - (detect.c:678) &lt;Info&gt; (SigLoadSignatures) -- 
 37 rule files processed. 10942 rules succesfully loaded, 0 rules failed
[10584] 28/6/2012 -- 18:40:57 - (detect.c:2627) &lt;Info&gt; (SigAddressPrepareStage1) -- 
 10950 signatures processed. 4 are IP-only rules, 3500 are inspecting packet payload, 8910 inspect application layer, 0 are decoder event only
[10584] 28/6/2012 -- 18:40:57 - (detect.c:2630) &lt;Info&gt; (SigAddressPrepareStage1) -- 
 building signature grouping structure, stage 1: adding signatures to signature source addresses... complete
[10584] 28/6/2012 -- 18:40:57 - (detect.c:3254) &lt;Info&gt; (SigAddressPrepareStage2) -- 
 building signature grouping structure, stage 2: building source address list... complete
[10584] 28/6/2012 -- 18:40:59 - (detect.c:3914) &lt;Info&gt; (SigAddressPrepareStage3) -- 
 building signature grouping structure, stage 3: building destination address lists... complete
[10584] 28/6/2012 -- 18:41:00 - (util-threshold-config.c:927) &lt;Info&gt; (SCThresholdConfParseFile) -- 
 Threshold config parsed: 0 rule(s) found
[10584] 28/6/2012 -- 18:41:00 - (detect-engine.c:230) &lt;Info&gt; (DetectEngineLiveRuleSwap) -- 
 Live rule swap has swapped 1 old det_ctx's with new ones, along with the new de_ctx
[10584] 28/6/2012 -- 18:41:01 - (detect.c:3941) &lt;Info&gt; (SigAddressCleanupStage1) -- 
 cleaning up signature grouping structure... complete
[10584] 28/6/2012 -- 18:41:01 - (detect-engine.c:290) &lt;Info&gt; (DetectEngineLiveRuleSwap) --
 ===== Live rule swap DONE =====
</pre>
<p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Ivanko.Zekic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Ivanko.Zekic (stranica ne postoji)">Ivanko Zekić</a> 15:46, 13. siječnja 2013. (CET)
</p>
<h4> <span class="mw-headline" id="TLS_klju.C4.8Dne_rije.C4.8Di">TLS ključne riječi</span></h4>
<p>Suricata dolazi s nekoliko ključnih riječi za pravila kako bi se podudarala na raznim svojstvima TLS/SSH rukovanja (eng. handshake). Podudaranja su <i>string inclusion matches</i>. <br />
<b>tls.verzija</b><br />
Podudaranje sa  pregovaračkom TLS/SSL verzijom.
</p>
<pre>primjer vrijednosti: „1.0“, „1.1“, „1.2“<br />
</pre>
<p><b>tls.subject</b><br />
Podudaranje TLS/SSL sa poljem predmeta certifikata.
</p>
<pre>primjer:
tls.subject: „.CN=“ googleusercontent.com“
</pre>
<p><b>tls.issuerdn</b><br />
Podudaranje TLS/SSL sa <i>issuerDN</i> poljem certifikata.
</p>
<pre>primjer:
tls.issuerdn:&#160;!“CN= Google.internet-Authority“
</pre>
<p><b>tls.fingerprint</b><br />
Podudaranje TLS/SSL certifikat SHA1 otisak.
</p>
<pre>primjer:
tls.fingerprint:!“f3:40:21:48:70:2c:31:bc:b5:aa:22:ad:63:d6:bc:2e:46:e2:5a“
</pre>
<p><b>tls.store</b><br />
pohraniti TLS/SSL certifikat na disk
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Ivanko.Zekic&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Ivanko.Zekic (stranica ne postoji)">Ivanko Zekić</a> 15:04, 13. siječnja 2013. (CET)
</p>
<h2> <span class="mw-headline" id="Upravljanje_pravilima_pomo.C4.87u_Oinkmaster">Upravljanje pravilima pomoću Oinkmaster</span></h2>
<p>Pravila su važan dio Suricate. Ona se mogu posebno skinuti i ručno instalirati no to nije potrebno jer postoji puno brži i lakši način. Razvijeni su posebni programi koji se mogu koristiti za skidanje i instaliranje pravila. Kao dobre primjere možemo navesti  <b>Pulled Pork</b> <a href="http://code.google.com/p/pulledpork/" class="external autonumber" rel="nofollow">[89]</a> i <b>Oinkmaster</b> <a href="http://oinkmaster.sourceforge.net/" class="external autonumber" rel="nofollow">[90]</a>. Nakon instalacije Oinkmastera potrebno je odrediti direktorij gdje će se spremati nova pravila. Preko Oinkmastera također možemo pogledati koja sve pravila imamo te ih po želji omogućiti ili onemogućiti. Uz sve to pravila možemo i modificirati kako bismo ih bolje prilagodili našim potrebama. Ukoliko bismo, na primjer, željeli da nam Suricata umjesto obavijesti da se paket s nečim podudara, jednostavno odbaci taj paket bez slanja upozorenja, napravili bismo nešto slično sljedećem:
</p>
<pre>sudo nano oinkmaster.conf
modifysid 2010495 “alert” | “drop”
</pre>
<p>Dakle, otvorili bismo konfiguracijsku datoteku, unijeli naredbu za modificiranje i broj pravila te samu modifikaciju. Promjena bi se trebala vidjeti nakon ponovnog pokretanja Oinkmastera. Više detalja na: <a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Rule_Management_with_Oinkmaster" class="external autonumber" rel="nofollow">[91]</a>
</p><p>Ovaj dio nije toliko vezan uz sam Oinkmaster koliko uz upravljanje pravilima i razumijevanje upozorenja. Kada se pojavi neko upozorenje vrlo je važno u relativno kratkom roku saznati na što se ono odnosi. Kada vidimo koje je pravilo uzrokovalo upozorenje najbolje je pogledati kako je to pravilo definirano. Pogledajmo to na primjeru.
</p>
<pre>alert tcp $HOME_NET any -&gt; $EXTERNAL_NET $HTTP_PORTS (msg:"ET CURRENT_EVENTS Adobe 0day Shovelware"; \
 flow:established,to_server; content:"GET "; nocase; depth:4; content:!"|0d 0a|Referer\:"; nocase; \
 uricontent:"/ppp/listdir.php?dir="; pcre:"/\/[a-z]{2}\/[a-z]{4}01\/ppp\/listdir\.php\?dir=/U"; \
 classtype:trojan-activity; reference:url,isc.sans.org/diary.html?storyid=7747; reference:url,doc.emergingthreats.net/2010496; \
 reference:url,www.emergingthreats.net/cgi-bin/cvsweb.cgi/sigs/CURRENT_EVENTS/CURRENT_Adobe; sid:2010496; rev:2;)
</pre>
<p>Ključna riječ na koju trebamo obratiti pažnju je <i>reference</i>. Ona nam daje do znanja da bismo za više informacije trebali pogledati sljedeća 3 URL-a:
</p>
<pre>isc.sans.org/diary.html?storyid=7747
doc.emergingthreats.net/2010496
www.emergingthreats.net/cgi-bin/cvsweb.cgi/sigs/CURRENT_EVENTS/CURRENT_Adobe
</pre>
<p>U dosta slučajeva stvari nisu toliko jednostavne. U takvim slučajevima se preporuča da iskoristimo takozvani <i>signature support list</i> za Emerging Threats: <a href="http://lists.emergingthreats.net/mailman/listinfo/emerging-sigs" class="external autonumber" rel="nofollow">[92]</a> i za VRT: <a href="https://lists.sourceforge.net/lists/listinfo/snort-sigs" class="external autonumber" rel="nofollow">[93]</a>.
Analiziranje upozorenja i paketa koji ga je izazvao, često neće uroditi plodom. Zato je IDS sustave poput Suricate preporučljivo kombinirati s potpunim hvatanjem paketa.
</p><p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Dario.Supan&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Dario.Supan (stranica ne postoji)">Dario Supan</a> 21:03, 12. siječnja 2013. (CET)
</p>
<h2> <span class="mw-headline" id="Performanse">Performanse</span></h2>
<h3> <span class="mw-headline" id="Konfiguracija_visokih_performansi">Konfiguracija visokih performansi</span></h3>
<p>Kod određivanja veličina grupa (za što nam one služe je više pojašnjeno u slijedećem potpoglavlju moramo biti vrlo pažljivi. Postavljene vrijednosti za low, medium i high su:
</p>
<pre>ENGINE_PROFILE_LOW:
     toclient-src-groups: 2
     toclient-dst-groups: 2
     toclient-sp-groups: 2
     toclient-dp-groups: 3
     toserver-src-groups: 2
     toserver-dst-groups: 4
     toserver-sp-groups: 2
     toserver-dp-groups: 25
</pre>
<pre>default and MEDIUM profiles:
     toclient-src-groups: 4
     toclient-dst-groups: 4
     toclient-sp-groups: 4
     toclient-dp-groups: 6
     toserver-src-groups: 4
     toserver-dst-groups: 8
     toserver-sp-groups: 4
     toserver-dp-groups: 30
</pre>
<pre>ENGINE_PROFILE_HIGH:
     toclient-src-groups: 15
     toclient-dst-groups: 15
     toclient-sp-groups: 15
     toclient-dp-groups: 20
     toserver-src-groups: 15
     toserver-dst-groups: 15
     toserver-sp-groups: 15
     toserver-dp-groups: 40
</pre>
<p>Navedene vrijednosti se mogu koristiti kod obične uporabe no ovdje govorimo o visokim performansama. Ako imamo dovoljno RAM-a i želimo dodatno rasteretiti procesor možemo postaviti slijedeće vrijednosti:
</p>
<pre>detect-engine:
 - profile: medium
 - custom-values:
     toclient-src-groups: 200
     toclient-dst-groups: 200
     toclient-sp-groups: 200
     toclient-dp-groups: 300
     toserver-src-groups: 200
     toserver-dst-groups: 400
     toserver-sp-groups: 200
     toserver-dp-groups: 200
 - sgh-mpm-context: auto
 - inspection-recursion-limit: 3000
</pre>
<p>Uz prosječno definirana pravila, ovako konfiguriran sustav glatko će raditi samo sa 32GB+ memorije. Prilikom slaganja hardvera za ovakav sustav, treba uvijek imati na umu da je bolje uložiti u više procesorske nego memorijske snage jer općenito Suricata troši dosta procesorskih resursa.
</p>
<h3> <span class="mw-headline" id="Fino_pode.C5.A1avanje_performansi">Fino podešavanje performansi</span></h3>
<p>Kako bi se Suricata lakše prilagodila potencijalnim korisnicima postoji nekoliko područja čijim konfiguriranjem možemo znatno utjecati na njezinu brzinu odnosno performanse. Jedno od tih područja je <b>max-pending-packets: &lt;number&gt;</b>. Navedena opcija kontrolira broj paketa s kojima aplikacija u jednom trenutku može odnosno smije rukovati. Preporučena postavka je <b>1000</b> ili više. Maksimalna vrijednost koju možemo postaviti je oko <b>65000</b>.
</p><p>Slijedeća postavka je<b> mpm-algo: &lt;ac|ac-gfbs|ac-bs|b2g|b3g|wumanber&gt;</b>. Ova stavka kontrolira algoritam za spajanje uzoraka. Navedene su sve dostupne opcije. Po originalnim postavkama koristi se AC i to je najbolji izbor u većini slučajeva.
</p><p>Slijedeća postavka je <b>detect-engine.profile: &lt;low|medium|high|custom&gt;</b>. Ovdje se radi o pokušaju grupiranja pojedinih potpisa tako da se paketi uspoređuju samo s potpisima za koje postoji šansa da odgovaraju paketu. Postoji vrlo mnogo varijacija potpisa zbog čega bi se napravio iznimno velik broj grupa ukoliko ne bi postojalo određeno kontrole. Izborom između low, medium i high mi zapravo kontroliramo koliko agresivno se grupe stvaraju. Veći broj grupa daje bolje rezultate, ali rezultira većom potrošnjom memorije. Custom opcija nam omogućava da sami konfiguriramo veličinu pojedinih grupa:
</p>
<pre> - custom-values:
     toclient-src-groups: 2
     toclient-dst-groups: 2
     toclient-sp-groups: 2
     toclient-dp-groups: 3
     toserver-src-groups: 2
     toserver-dst-groups: 4
     toserver-sp-groups: 2
     toserver-dp-groups: 25
</pre>
<p>Zadnja postavka koju ćemo spomenuti je <b>detect-engine.sgh-mpm-context: &lt;auto|single|full&gt;</b>. Mpm je kratica za multi pattern matcher. Nude nam se tri opcije. Preporučeno je ostaviti na auto. Ukoliko ostavimo postavku na auto onda će nam Suricata sama, ovisno o tome kako smo prethodno postavili mpm-algo, konfigurirati ovu postavku. Za ac, ac-gfbs i ac-bs će postavljena vrijednost biti <i>single</i>, a za ostale <i>full</i>. Treba napomenuti da ukoliko nam je detect-engine.sgh-mpm-context: &lt;<b>full</b>&gt;, a mpm-algo: &lt;<b>ac</b>&gt; sustav će za normalan rad (ukoliko su sve ostale postavke postavljene na neke prosječne vrijednosti) zahtijevati minimalno 32GB memorije.
</p>
<h3> <span class="mw-headline" id="Statistike">Statistike</span></h3>
<p>Suricata je sustav koji neprestano motri na naš sustav i na promet s drugim sustavima te nas upozorava na određene radnje, ovisno kako smo ju konfigurirali. Ako se negdje dogodila neka nepravilnost bilo bi lijepo da mi to znamo te da to možemo kasnije pogledati. Upravo zato, Suricata ima<b> stats.log</b> gdje možemo vidjeti razne statističke podatke koji se osvježavaju u fiksnom intervalu. Prema originalnim postavkama interval je 8 sekundi.
</p>
<pre>-------------------------------------------------------------------
Counter                   | TM Name                   | Value
-------------------------------------------------------------------
flow_mgr.closed_pruned    | FlowManagerThread         | 154033
flow_mgr.new_pruned       | FlowManagerThread         | 67800
flow_mgr.est_pruned       | FlowManagerThread         | 100921
flow.memuse               | FlowManagerThread         | 6557568
flow.spare                | FlowManagerThread         | 10002
flow.emerg_mode_entered   | FlowManagerThread         | 0
flow.emerg_mode_over      | FlowManagerThread         | 0
decoder.pkts              | RxPcapem21                | 450001754
decoder.bytes             | RxPcapem21                | 409520714250
decoder.ipv4              | RxPcapem21                | 449584047
decoder.ipv6              | RxPcapem21                | 9212
decoder.ethernet          | RxPcapem21                | 450001754
decoder.raw               | RxPcapem21                | 0
decoder.sll               | RxPcapem21                | 0
decoder.tcp               | RxPcapem21                | 448124337
decoder.udp               | RxPcapem21                | 542040
decoder.sctp              | RxPcapem21                | 0
decoder.icmpv4            | RxPcapem21                | 82292
decoder.icmpv6            | RxPcapem21                | 9164
decoder.ppp               | RxPcapem21                | 0
decoder.pppoe             | RxPcapem21                | 0
decoder.gre               | RxPcapem21                | 0
decoder.vlan              | RxPcapem21                | 0
decoder.avg_pkt_size      | RxPcapem21                | 910
decoder.max_pkt_size      | RxPcapem21                | 1514
defrag.ipv4.fragments     | RxPcapem21                | 4
defrag.ipv4.reassembled   | RxPcapem21                | 1
defrag.ipv4.timeouts      | RxPcapem21                | 0
defrag.ipv6.fragments     | RxPcapem21                | 0
defrag.ipv6.reassembled   | RxPcapem21                | 0
defrag.ipv6.timeouts      | RxPcapem21                | 0
tcp.sessions              | Detect                    | 41184
tcp.ssn_memcap_drop       | Detect                    | 0
tcp.pseudo                | Detect                    | 2087
tcp.invalid_checksum      | Detect                    | 8358
tcp.no_flow               | Detect                    | 0
tcp.reused_ssn            | Detect                    | 11
tcp.memuse                | Detect                    | 36175872
tcp.syn                   | Detect                    | 85902
tcp.synack                | Detect                    | 83385
tcp.rst                   | Detect                    | 84326
tcp.segment_memcap_drop   | Detect                    | 0
tcp.stream_depth_reached  | Detect                    | 109
tcp.reassembly_memuse     | Detect                    | 67755264
tcp.reassembly_gap        | Detect                    | 789
detect.alert              | Detect                    | 14721
</pre>
<p>Isto tako, prilikom gašenja, Suricata nam javlja koliko je detektirala izgubljenih paketa. Statistiku slaže prema informacijama koje dobije od strane <i>pcapa</i>, <i>pfringa</i> i <i>afpacketa</i>.
</p>
<pre>[18088] 30/5/2012 -- 07:39:18 - (RxPcapem21) Packets 451595939, bytes 410869083410
[18088] 30/5/2012 -- 07:39:18 - (RxPcapem21) Pcap Total:451674222 Recv:451596129 Drop:78093 (0.0%).
</pre>
<h3> <span class="mw-headline" id="Profiliranje_paketa">Profiliranje paketa</span></h3>
<p>Profiliranje paketa je jedna od opcija koju Suricata nudi. Koristi se kada se želi saznati koliko vremena je potrebno za obradu pojedinog paketa. Na taj način možemo saznati zašto se neki paketi obrađuju brže ili sporije od ostalih i zbog toga je vrlo koristan dodatak Suricati.
</p>
<h3> <span class="mw-headline" id="Modovi_za_izvo.C4.91enje">Modovi za izvođenje</span></h3>
<p>Suricata se sastoji od nekoliko djelova. Razlikujemo dretve, dretvene module i redove (eng. qeues). Ne zaboravimo da je Suricata višedretveni sustav što znači da u isto vrijeme aktivno više dretvi. Modul dretve je samo dio njezine funkcionalnosti. Jedan modul se recimo koristi za dekodiranje paketa, drugi za detekciju a treći nalazi svoju ulogu kao output. Paket stoga možemo biti procesuiran od strane više dretvi. Kad jedna dretva završi s obradom paketa ona ga stavlja u red za drugu dretvu, ukoliko neka druga dretva želi izvršiti određenu operaciju nad tim paketom. Jedna dretva može u jednom trenutku procesuirati samo jedan paket, ali pošto je Suricata višedretveni sustav, više paketa se može obrađivati u jednom trenutku. Dretva može imati jedan ili više modula s tim da ako ih ima više, u jednom trenutku može biti aktivan samo jedan od tih modula. Način na koji su dretve, njihovi moduli i redovi organizirani nazivamo <b>runmode</b>(mod izvođenja).
</p><p>Suricata nudi mogućnost izabiranja između nekoliko preddefiniranih modova izvođenja. Unošenjem naredbe <b>--list runmodes</b> možemo vidjeti sve dostupne modove. Primjer moda izvođenja postavljenog kao <i>default</i>:
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Runmode_default.png" class="image"><img alt="Runmode default.png" src="../images/8/84/Runmode_default.png" width="416" height="258" /></a>
</p><p>Možemo navesti još jedan primjer. Uzeti ćemo <b>pfring</b> mod izvođenja. U ovom načinu izvođenja paketi imaju fiksno određen put kretanja. Slikovito prikazano to izgleda ovako:
<a href="http://security.foi.hr/wiki/index.php/Datoteka:Pfringmode.png" class="image"><img alt="Pfringmode.png" src="../images/7/78/Pfringmode.png" width="458" height="368" /></a>
</p>
<h3> <span class="mw-headline" id="Tcmalloc">Tcmalloc</span></h3>
<p><i>Tcmalloc</i> je biblioteka koju je Google napravio kao dio jednog svog paketa za poboljšanje upravljanjem memorije kod upravljanja procesima odnosno njihovim dretvama. Spominjemo ju jer je vrlo jednostavna za korištenje i kompatibilna sa Suricatom.Na Ubuntu se instalira korištenjem sljedeće naredbe:
</p>
<pre> apt-get install libtcmalloc-minimal0
</pre>
<p>Prethodna naredba služi samo za dodavanje biblioteke. Za njezino korištenje, za Ubuntu, biblioteku moramo predloadirati:
</p>
<pre>LD_PRELOAD=”/usr/lib/libtcmalloc_minimal.so.0″ suricata -c suricata.yaml -i eth0
</pre>
<p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Dario.Supan&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Dario.Supan (stranica ne postoji)">Dario Supan</a> 19:38, 11. siječnja 2013. (CET)
</p>
<h2> <span class="mw-headline" id="Usporedba_Suricate_i_Snorta">Usporedba Suricate i Snorta</span></h2>
<h3> <span class="mw-headline" id="Opis_testiranja">Opis testiranja</span></h3>
<p>Godinama je na IDS/IPS području, alat pod nazivom Snort držao vodeću poziciju. Suricata je noviji, mnogo manje rašireni alat koji donosi neke novosti u spomenuto područje. Pošto je glavna zadaća predstavljanje upravo Suricate, koncentrirati ćemo se na njegove prednosti i mane, ali ćemo usput, na nekim područjima pogledati kako se nosi s već dokazano kvalitetnim suparnikom. Testovi su provedeni  na način da su im se slali potpuno identični podaci. Na temelju ovih testova probati ćemo izvući informacije o snagama i slabostima Suricate i Snorta. Originalni članak se nalazi ovdje <a href="http://www.aldeid.com/wiki/Suricata-vs-snort" class="external autonumber" rel="nofollow">[94]</a>.
</p>
<h3> <span class="mw-headline" id="Op.C4.87i_pregled">Opći pregled</span></h3>
<table border="1">
<tr>
<th> Stavka
</th>
<th> Suricata
</th>
<th> Snort
</th></tr>
<tr>
<td> IPS opcija
</td>
<td> opcionalna tokom kompajliranja (--enable-nfqueue)
</td>
<td> Snort_inline ili snort korišten s -Q naredbom
</td></tr>
<tr>
<td> Pravila
</td>
<td>
<ul><li>VRT::Snort rules
</li><li>EmergingThreats rules
</li></ul>
</td>
<td>
<ul><li>VRT::Snort rules
</li><li>SO rules
</li><li>EmergingThreats rules
</li></ul>
</td></tr>
<tr>
<td> Dretve
</td>
<td> Višedretvenost
</td>
<td> Jedna dretva
</td></tr>
<tr>
<td> Lakoća instalacije
</td>
<td> Nije moguća iz paketa. Ručna instalacija.
</td>
<td> Relativno pravocrtna. Instalacija dostupna i iz paketa.
</td></tr>
<tr>
<td> Dokumentacija
</td>
<td> Nekoliko resursa na netu
</td>
<td> Dobro dokumentiran na službenoj stranici i na netu
</td></tr>
<tr>
<td> Event logiranje
</td>
<td colspan="2"> Flat file, database, unified2 logs for barnyard
</td></tr>
<tr>
<td> IPv6 podrška
</td>
<td> Puna podrška
</td>
<td> Podržava kad se kompajlira s --enable-ipv6 opcijom
</td></tr>
<tr>
<td> Capture accelerators
</td>
<td> PF_RING, packet capture accelerator
</td>
<td> Nema, koristi se libpcap
</td></tr>
<tr>
<td> Configuration file
</td>
<td> suricata.yaml, classification.config, reference.config, threshold.config
</td>
<td> snort.conf, threshold.conf
</td></tr>
<tr>
<td> Ofline analiza (pcap file)
</td>
<td colspan="2"> da
</td></tr>
<tr>
<td> Frontends
</td>
<td colspan="2"> Sguil, Aanval, BASE, FPCGUI (Full Packet Capture GUI), Snortsnarf
</td></tr></table>
<h3> <span class="mw-headline" id="Okru.C5.BEenje">Okruženje</span></h3>
<p><b>Platforme</b><br />
Testovi su provedeni nad identičnim platformama koje su bazirane na Debian 5 Lenny distribuciji hostanoj na ESX VMWare serveru.  Također, kao dodatni preduvjeti, na dvije testirane platforme instalirani su i:
</p>
<ul><li>libpcap version 1.1.1 
</li><li>PCRE version: 7.6 2008-01-28 
</li><li>ZLIB version: 1.2.3.3
</li></ul>
<p><b>Korištene verzije programa</b><br />
U vrijeme testiranja koristile su se tada najnovije verzije koje su bile:
</p>
<ul><li>Suricata: 1.1beta1 (rev a96eae0)
</li><li>Snort: 2.9.0.4 IPv6 (Build 111)
</li></ul>
<p><b>Pravila</b><br />
</p>
<table border="1">
<tr>
<th> Rule set
</th>
<th> Suricata
</th>
<th> Snort
</th></tr>
<tr>
<td> VRT::Snort rules (free version)
</td>
<td align="center"> x
</td>
<td align="center"> x
</td></tr>
<tr>
<td>SO rules (Shared Object)
</td>
<td>
</td>
<td align="center"> x
</td></tr>
<tr>
<td> EmergingThreats rules (free version)
</td>
<td align="center"> x
</td>
<td>
</td></tr></table>
<p>Neka pravila su po defaultu zakomentirana tako da su ona posebno uključena:
</p>
<pre>for x in `ls *.rules | grep -v 'local.rules'`
do
  sed -i -e 's/^#\s*alert/alert/i' $x
done
</pre>
<p><b>Konfiguracije</b><br />
Detaljni podaci o konfiguraciji (za ovaj test) pojedinog alata se mogu naći na linkovima ispod:
</p>
<ul><li>Suricata: <a href="http://dl.dropbox.com/u/10761700/suricata-vs-snort/suricata.yaml" class="external text" rel="nofollow">suricata.yaml</a>
</li><li>Snort: <a href="http://dl.dropbox.com/u/10761700/suricata-vs-snort/snort.conf" class="external text" rel="nofollow">snort.conf</a>
</li></ul>
<h3> <span class="mw-headline" id="Metodologija">Metodologija</span></h3>
<p><b>Način ocjenjivanja</b><br />
</p>
<ul><li><b>0</b>: Ne zadovoljava kriterije ili ih zadovoljava u minimalnoj mjeri
</li><li><b>1</b>: Zadovoljava kriterije
</li><li><b>2</b>: Premašuje kriterije
</li></ul>
<p>Kao dodatak ovom ocjenjivanju našao se prioritet (ponder) koji se dodijelio svakoj grupi testova. Ukupni rezultat se izračunavao sumiranjem ponderiranih rezultata:
(SUM[zbroj ocjena za određenu grupu * prioritet grupe]).
</p><p><b>Log zapisi</b><br />
Log datoteke su se analizirale <i>live</i>:
</p>
<ul><li><b>Suricata</b>: tail -f /var/log/suricata/fast.log
</li><li><b>Snort</b>: tail -f /var/log/snort/alert
</li></ul>
<p>Za praćenje virusa i malicioznih kodova korišteni su Tcpdump i Wireshark.
</p><p><b>Alati korišteni tokom testiranja</b><br />
</p>
<ul><li>Scapy: za slaganje paketa bilo kojeg tipa
</li><li>Scapytain: za spremanje payloada i kasniji jednostavni pregled istog 
</li><li>Netcat: za slanje payloada na  specifični host/port u konjukciji s echo 
</li><li>Hping: za izvođenje DoS napada
</li><li>Nmap: za skeniranje portova 
</li><li>tcpdump: za hvatanje i analizu prometa (npr. filter) 
</li><li>tcpreplay: za ponovni pregled uhvaćenih datoteka 
</li><li>Thc-hydra|Hydra: za brute force servisa
</li></ul>
<h3> <span class="mw-headline" id="Rezultati_testova">Rezultati testova</span></h3>
<table border="1">
<tr>
<th> Testna grupa
</th>
<th> Prioritet
</th>
<th> # testova
</th>
<th> Suricata
</th>
<th> Snort
</th></tr>
<tr>
<td> Test pravila
</td>
<td align="right"> 3
</td>
<td align="right"> 8
</td>
<td align="right"> 6
</td>
<td align="right"> 8
</td></tr>
<tr>
<td> Fragmentirani paketi
</td>
<td align="right"> 2
</td>
<td align="right"> 2
</td>
<td align="right"> 1
</td>
<td align="right"> 3
</td></tr>
<tr>
<td> Krivi login podaci
</td>
<td align="right"> 3
</td>
<td align="right"> 1
</td>
<td align="right"> 1
</td>
<td align="right"> 0
</td></tr>
<tr>
<td> Tehnike izbjegavanja
</td>
<td align="right"> 2
</td>
<td align="right"> 15
</td>
<td align="right"> 21
</td>
<td align="right"> 29
</td></tr>
<tr>
<td> Virusi i ostali maliciozni kodovi
</td>
<td align="right"> 3
</td>
<td align="right"> 14
</td>
<td align="right"> 9
</td>
<td align="right"> 7
</td></tr>
<tr>
<td> Shellcodes
</td>
<td align="right"> 3
</td>
<td align="right"> 11
</td>
<td align="right"> 12
</td>
<td align="right"> 7
</td></tr>
<tr>
<td> DoS napadi
</td>
<td align="right"> 3
</td>
<td align="right"> 3
</td>
<td align="right"> 3
</td>
<td align="right"> 3
</td></tr>
<tr>
<td> Napadi od strane klijenta
</td>
<td align="right"> 3
</td>
<td align="right"> 257
</td>
<td align="right"> 127
</td>
<td align="right"> 157
</td></tr>
<tr>
<td> <b>Performanse</b>
</td>
<td align="right"> 3
</td>
<td align="right"> 0
</td>
<td align="right"> 2
</td>
<td align="right"> 1
</td></tr>
<tr>
<td> <b>Mogućnosti blokiranja</b>
</td>
<td align="right"> 2
</td>
<td align="right"> 0
</td>
<td align="right"> 1
</td>
<td align="right"> 1
</td></tr>
<tr>
<td align="right" colspan="2"> <b>SVEUKUPNO (neponderirana suma)</b>
</td>
<td align="right" rowspan="2"> <b>311</b>
</td>
<td align="right"> <b>183</b>
</td>
<td align="right"> <b>216</b>
</td></tr>
<tr>
<td align="right" colspan="2"> <b>SVEUKUPNO (ponderirana suma)</b>
</td>
<td align="right"> <b>526</b>
</td>
<td align="right"> <b>615</b>
</td></tr></table>
<p><b>Testiranje pravila</b><br />
Ovdje se testirala sposobnost alata da upale alarm s obzirom na navedena pravila (VRT::Snort, SO rules and EmergingThreats).  Testiralo se s 8 različitih napada, a rezultati se mogu vidjeti u tablici ispod:
</p>
<table border="1">
<tr>
<th> Test
</th>
<th> Suricata
</th>
<th> Snort
</th></tr>
<tr>
<td>Simple LFI
</td>
<td align="right"> 1
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>LFI using NULL byte
</td>
<td align="right"> 1
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>Full SYN scan
</td>
<td align="right"> 0
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>Full Connect() port scan
</td>
<td align="right"> 0
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>SQL Injection (UNION SELECT)
</td>
<td align="right"> 1
</td>
<td align="right"> 0
</td></tr>
<tr>
<td>Netcat reverse shell
</td>
<td align="right"> 1
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>Nikto scan
</td>
<td align="right"> 2
</td>
<td align="right"> 1
</td></tr>
<tr>
<td align="right"> <b>TOTAL</b>
</td>
<td align="right"> <b>6</b>
</td>
<td align="right"> <b>6</b>
</td></tr></table>
<p>Treba napomenuti još jednu sitnicu prije nego odemo dalje. Snort ima predprocesor zvan sfportscan zbog čega ima prednost nad Suricatom kod detekcije Nmap skeniranja portova. Suricata je aktivirala alarme za neke napade, ali se nijedan alarm nije javio kod skeniranja portova.
</p><p><b>Fragmentirani paketi</b><br />
Koristili su se payloadi koji su predstavljali fragmentirane pakete. Testirala se sposobnost alata da spoje navedene pakete i preoznaju pokušaje napada. Izvela su se 2 testa zvana <i>ping of death</i> i <i>nestea attack</i>. Snort je uhvatio oba pokušaja napada dok je Suricata pokazala upozorenje samo za drugi napad. Developeri su priznali da postoji bug zbog kojeg se ne aktivira alarm za prvi napad te navode da će problem biti riješen u novijoj verziji aplikacije.
</p><p><b>Višekratni pokušaj unosa nekorektnih podataka za logiranje</b><br />
Ovo testiranje služi da vidimo kako se alati nose s napadima kao što je Brute force FTP-a. I jedan i drugi alat su dali upozorenja o pokušaju brute forcea. 
Snort:
</p>
<pre>#emerging-ftp.rules (from EmergingThreats rules):
alert tcp $HOME_NET 21 -&gt; $EXTERNAL_NET any (msg:"GPL FTP FTP Bad login";
flow:from_server,established; content:"530 "; depth:4; pcre:"/^530\s+(Login|
User)/smi"; classtype:bad-unknown; sid:491; rev:9;)
</pre>
<pre>#emerging-ftp.rules (from EmergingThreats rules):
alert tcp $HOME_NET 21 -&gt; $EXTERNAL_NET any (msg:"GPL FTP FTP Bad login";
flow:from_server,established; content:"530 "; depth:4; pcre:"/^530\s+(Login|
User)/smi"; classtype:bad-unknown; sid:491; rev:9;)
</pre>
<p>Kod Suricate je namješteno (korištenjem <i>Flowinta</i>) da izbaci upozorenje kada se 3 puta za redom unesu pogrešni podaci što je alat uspješno obavio.
</p>
<pre>alert tcp any any -&gt; any any (msg:"Counting Failed Logins"; content:"incorrect"; \
 flowint: username, notset; flowint:username, =, 1; noalert; sid:1;)
alert tcp any any -&gt; any any (msg:"More than two Failed Logins!"; \
 content:"incorrect"; flowint: username, isset; flowint:username, +, 1; \
 flowint:username, &gt;, 2; sid:2;)
</pre>
<p><b>Tehnike izbjegavanja</b><br />
Ovi testovi su namijenjeni kako bi se utvrdilo koliko dobro Suricata i Snort prepoznaju pokušaje napada koji koriste tehnike izbjegavanja kao što su fragmentacija, enkripcija i slično. Testiralo se 15 različitih slučajeva koji su navedeni u tablici ispod:
</p>
<table border="1">
<tr>
<th> Test
</th>
<th> Suricata
</th>
<th> Snort
</th></tr>
<tr>
<td>Nmap decoy test (6th position)
</td>
<td align="right"> 2
</td>
<td align="right"> 2
</td></tr>
<tr>
<td>Nmap decoy test (7th position)
</td>
<td align="right"> 2
</td>
<td align="right"> 2
</td></tr>
<tr>
<td>Hex encoding
</td>
<td align="right"> 2
</td>
<td align="right"> 2
</td></tr>
<tr>
<td>Nmap scan with fragmentation
</td>
<td align="right"> 2
</td>
<td align="right"> 2
</td></tr>
<tr>
<td>Nikto Random URI encoding
</td>
<td align="right"> 1
</td>
<td align="right"> 2
</td></tr>
<tr>
<td>Nikto Directory self reference
</td>
<td align="right"> 1
</td>
<td align="right"> 2
</td></tr>
<tr>
<td>Nikto Premature URL ending
</td>
<td align="right"> 2
</td>
<td align="right"> 2
</td></tr>
<tr>
<td>Nikto Prepend long random string
</td>
<td align="right"> 1
</td>
<td align="right"> 2
</td></tr>
<tr>
<td>Nikto Fake paramater
</td>
<td align="right"> 1
</td>
<td align="right"> 2
</td></tr>
<tr>
<td>Nikto TAB as request spacer
</td>
<td align="right"> 2
</td>
<td align="right"> 2
</td></tr>
<tr>
<td>Nikto Change the case of the URL
</td>
<td align="right"> 1
</td>
<td align="right"> 2
</td></tr>
<tr>
<td>Nikto Windows directory separator
</td>
<td align="right"> 1
</td>
<td align="right"> 2
</td></tr>
<tr>
<td>Nikto Carriage return as request spacer
</td>
<td align="right"> 2
</td>
<td align="right"> 2
</td></tr>
<tr>
<td>Nikto Binary value as request spacer
</td>
<td align="right"> 1
</td>
<td align="right"> 2
</td></tr>
<tr>
<td>JavaScript obfuscation
</td>
<td align="right"> 0
</td>
<td align="right"> 1
</td></tr>
<tr>
<td align="right"> <b>TOTAL</b>
</td>
<td align="right"> <b>21</b>
</td>
<td align="right"> <b>29</b>
</td></tr></table>
<p>Pokazalo se da je Snort nešto bolji od Suricate na ovom području. Istaknuli bismo nekoliko elemenata koji to pokazuju:
</p>
<ul><li>Lažni parametar
</li><li>Promjena velikog i malog slova kod URL-a 
</li><li>Korištenje Windowsovog znaka za podjelu na direktorije (\)
</li></ul>
<p>Napomenimo i da Suricata nije detektirala kod maskiran JavaScriptom.
</p><p><b>Virusi i ostali maliciozni kodovi</b><br />
Kao što bi se dalo pretpostaviti iz samog podnaslova, u ovom dijelu se testiralo koliko dobro Suricata i Snort prepoznaju viruse i ostale maliciozne kodove. Ovog puta Suricata je bila nešto uspješnija. Testiralo se preko 14 različitih malicioznih kodova, a rezultati se mogu vidjeti u tablici ispod:
</p>
<table border="1">
<tr>
<th> Test
</th>
<th> Suricata
</th>
<th> Snort
</th></tr>
<tr>
<td>Packed.Generic.187
</td>
<td align="right"> 1
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>W32.Spybot.Worm
</td>
<td align="right"> -
</td>
<td align="right"> -
</td></tr>
<tr>
<td>W32.Sality.AE (1)
</td>
<td align="right"> 1
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>W32.Sality.AE (2)
</td>
<td align="right"> 0
</td>
<td align="right"> 0
</td></tr>
<tr>
<td>W32.Sality.AE (3)
</td>
<td align="right"> -
</td>
<td align="right"> -
</td></tr>
<tr>
<td> [[#W32.Sality.AE_.284.29|W32.Sality.AE (4)
</td>
<td align="right"> -
</td>
<td align="right"> -
</td></tr>
<tr>
<td>Trojan Horse
</td>
<td align="right"> 0
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>Trojan-Spy.Win32.Zbot
</td>
<td align="right"> 1
</td>
<td align="right"> 0
</td></tr>
<tr>
<td>Trojan.Win32.Spyeye
</td>
<td align="right"> 1
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>Generic Trojan Downloader
</td>
<td align="right"> 1
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>Generic IRC Bot
</td>
<td align="right"> 1
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>Win32/SpamTool
</td>
<td align="right"> 1
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>Dropper with BlackEnergy
</td>
<td align="right"> 1
</td>
<td align="right"> 0
</td></tr>
<tr>
<td>Zango Spyware
</td>
<td align="right"> 1
</td>
<td align="right"> 0
</td></tr>
<tr>
<td align="right"> <b>TOTAL</b>
</td>
<td align="right"> <b>9</b>
</td>
<td align="right"> <b>7</b>
</td></tr></table>
<p><b>Shellcode</b><br />
Ovi testovi su napravljeni s ciljem da se vidi koliko dobro alati detektiraju shellcodove. Shellcode, u području računalne sigurnosti, je mali dio programskog koda koji koristi payload kako bi iskoristio ranjivosti u softveru. Naziva se „shellcode“ jer obično pokreće naredbeni redak (eng. command shell) preko kojeg napadač može ostvariti kontrolu nad kompromitiranim računalom. Koristio se set od 11 shellcodova a rezultati se mogu vidjeti u tablici ispod:
</p>
<table border="1">
<tr>
<th> Test
</th>
<th> Suricata
</th>
<th> Snort
</th></tr>
<tr>
<td>SHELLCODE sparc setuid 0
</td>
<td align="right"> 1
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>SHELLCODE x86 setgid
</td>
<td align="right"> 1
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>SHELLCODE IRIX SGI + NOOP
</td>
<td align="right"> 0
</td>
<td align="right"> 0
</td></tr>
<tr>
<td>SHELLCODE x86 setgid 0 &amp;&amp; SHELLCODE x86 setuid 0
</td>
<td align="right"> 1
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>Metasploit: win32_bind_dllinject -EXITFUNC=seh DLL=c:\ LPORT=4444 Size=312 Encoder=PexFnstenvSub
</td>
<td align="right"> 2
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>Metasploit: win32_bind_dllinject -EXITFUNC=seh DLL=c:\ LPORT=4444 Size=312 Encoder=Pex
</td>
<td align="right"> 2
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>Metasploit: win32_bind -EXITFUNC=seh LPORT=4444 Size=709 Encoder=PexAlphaNum
</td>
<td align="right"> 2
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>cmd.exe /c net user USERNAME PASSWORD /ADD &amp;&amp; net localgroup Administrators /ADD USERNAMEN
</td>
<td align="right"> 1
</td>
<td align="right"> 0
</td></tr>
<tr>
<td>Cisco: Create a new VTY, allocate a password then set the privilege level to 15
</td>
<td align="right"> 0
</td>
<td align="right"> 0
</td></tr>
<tr>
<td>Rothenburg Shellcode
</td>
<td align="right"> 1
</td>
<td align="right"> 1
</td></tr>
<tr>
<td>Mainz/Bielefeld Shellcode
</td>
<td align="right"> 1
</td>
<td align="right"> 0
</td></tr>
<tr>
<td align="right"> <b>TOTAL</b>
</td>
<td align="right"> <b>12</b>
</td>
<td align="right"> <b>7</b>
</td></tr></table>
<p><b>DoS napadi</b><br />
Ovi testovi su napravljeni kako bi se ustvrdilo koliko dobro se alati nose s napadima uskraćivanjem usluge (eng. Denial of Service). Provela su se dva različita DoS napada, jedan na SSH (<i>hping SYN flood</i>), a drugi na MSSQL servise. Oba alata su odlično reagirala u navedenim situacijama.
</p><p><b>Napadi od strane klijenata (eng. Client-side attacks)</b><br />
Ovi testovi su izvršeni slanjem malicioznih dokumenata koji se uobičajeno koriste kod npada od strane klijenata. Time se željelo ustvrditi koliko dobro alati prepoznaju te napade i prema tome aktiviraju alarme. Testeri su skinuli 257 malicioznih dokumenata koji se često koriste za ovu vrstu napada preko servera. Snort ovdje odnosi uvjerljivu pobjedu, a rezultati se nalaze u tablici ispod:
</p>
<table border="1">
<tr>
<td>
</td>
<td> Suricata
</td>
<td> Snort
</td></tr>
<tr>
<td> Broj poslanih datoteka
</td>
<td align="right"> 257
</td>
<td align="right"> 257
</td></tr>
<tr>
<td> Broj otkrivenih datoteka
</td>
<td align="right"> 127
</td>
<td align="right"> 157
</td></tr>
<tr>
<td> Broj aktiviranih upozorenja
</td>
<td align="right"> 210
</td>
<td align="right"> 374
</td></tr>
<tr>
<td> Razina detekcije
</td>
<td align="right"> 49.41%
</td>
<td align="right"> 61.09%
</td></tr></table>
<p><b>Performanse</b><br />
Iako performanse nisu direktno vezane s mogućnošću detekcije i prevencije napada, potencijalni korisnici bi vjerojatno željeli znati koliko su dobro navedeni alati optimizirani. Suricata je noviji alat te stoga iskorištava određene hardverske prednosti kao što je Multi-Threaded Processing. Što sve Suricata podržava je već ranije navedeno i opsiano. Neka ranija testiranja su pokazala da je Suricata zbog navedenih mogućnosti osjetno brža od Snorta. Zagovaratelji Snorta pak naglašavaju da se Snort, prije puštanja u rad, može konfigurirati kako bi se osjetno ubrzao njegov rad što mnogi ne rade zbog neznanja i neiskustva. Ipak kad se sve uzme u obzir, možemo zaključiti da je Suricata ipak nešto brža od Snorta.
</p><p><b>Mogućnosti blokiranja (eng. Blocking capabilities</b>)<br />
Ovo područje nije testirano u sklopu ovog istraživanja. Prema navodima <i>AlienVaulta</i>, alati imaju vrlo slične mogućnosti blokiranja.
</p>
<h3> <span class="mw-headline" id="Zaklju.C4.8Dak_testiranja_Suricata_vs_Snort">Zaključak testiranja Suricata vs Snort</span></h3>
<p>Provedeno je preko 300 napada na Suricatu i Snort. Nisu sve osobine alata testirane (poput performansi, mogućnosti blokiranja...). Cilj istraživanja je bio testirati razinu kvalitete detekcije različitih napada pa su i testovi rađeni imajući to na umu.
Oba alate se temelje na setu pravila. Testiranja su pokazala da su VRT::Snort i EmergingThreats komplementarna pravila te zajedno pružaju visoku razinu detekcije različitih vrsta napada.
Suricata nudei neke nove opcije kao što je podrška za multi-threading , ali pati od nedostatka dokumentacije (čak se i podaci na službenoj stranici osvježavaju dosta neredovito pa možemo naići i na zastarjele podatke). Jedna velika prednost Suricata je to što razumije razinu 7 u OSI modelu zbog čega vrlo dobro prepoznaje različite vrste malicioznog koda.
Snort će još neko vrijeme biti standard za IDS/IPS razvojna okružja jer je stabilan, vrlo dobro dokumentiran i jer se relativno jednostavno konfigurira. Suricata ima jedan novi pristup i već se pokazala boljom na nekim područjima. Iako bi trenutačno bolje preporučili Snort, Suricata je alat koji svakako treba držati na oku.
</p><p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Dario.Supan&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Dario.Supan (stranica ne postoji)">Dario Supan</a> 23:55, 9. siječnja 2013. (CET)
</p>
<h2> <span class="mw-headline" id="Zaklju.C4.8Dak">Zaključak</span></h2>
<p>Sustavi za detekciju i sprječavanje upada nalaze svoje mjesto u sustavu informacijske sigurnosti. Trenutačno je otvorena opcija korištenja više alata, a jedna od opcija je svakako i Suricata. Suricata, kao i svi ostali sustavi za detekciju i suzbijanje upada, ima svoje prednosti i mane. Testiranja su pokazala da Suricata ima odlične performanse jer zna iskoristiti novije hardverske mogućnosti poput multithreadinga. Također se pokazala odličnom na području otkrivanja virusa i ostalih malicioznih kodova zbog snažnog nadzora nad mrežnim prometom. Jedan od velikih pluseva je i mogućnost detaljne konfiguracije što Suricati omogućava da bude pristupačna da se se može prilagoditi različitim korisnicima i poslovnim okruženjima. Tu dolazimo i do njezinih mana. Mogućnost detaljne konfiguracije povlači za sobom boljku koja se proteže kroz sve sustava za detekciju i sprječavanje upada. Korisnici često imaju aktivan vrlo veliki broj pravila zbog čega se često nepotrebno okidaju lažne uzbune (eng. false positive). Zato i je jedna od preporuka da se takvi sustavi što manje koriste za suzbijanje upada već da se koncentriraju na njegovu detekciju. To pak rezultira velikim brojem zapisa u log datotekama na koje se korisnici moraju naviknuti kako bi u šumi podataka pronašli prave prijetnje. Kad se sve zbroji i oduzme, mislimo da Suricata ima više prednosti nego mana. Pošto je razvijena od strane OISF-a smatramo da će i dalje imati dobru podršku te da će novije verzije učiniti sustav mnogo privlačnijim potencijalnim korisnicima.
</p>
<h2> <span class="mw-headline" id="Literatura">Literatura</span></h2>
<p>Pleskonjić D., Maček N., Đorđević B., Carić M. (2007). <i>Sigurnost računarskih sistema i mreža</i>. Beograd: Mikro knjiga 
</p><p><a href="http://www.openinfosecfoundation.org/index.php/download-suricata" class="external free" rel="nofollow">http://www.openinfosecfoundation.org/index.php/download-suricata</a>, Pristupano 9.1.2013.
</p><p><a href="https://redmine.openinfosecfoundation.org/" class="external free" rel="nofollow">https://redmine.openinfosecfoundation.org/</a>, Pristupano 15.1.2013.
</p><p><a href="https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Suricata_User_Guide" class="external free" rel="nofollow">https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Suricata_User_Guide</a>, Pristupano 18.1.2013.
</p><p><a href="http://suricata-ids.org/" class="external free" rel="nofollow">http://suricata-ids.org/</a>, Pristupano 18.1.2013.
</p><p><a href="http://pyyaml.org/wiki/LibYAML" class="external free" rel="nofollow">http://pyyaml.org/wiki/LibYAML</a>, Pristupano 18.1.2013.
</p><p><a href="http://www.aldeid.com/wiki/Suricata-vs-snort" class="external free" rel="nofollow">http://www.aldeid.com/wiki/Suricata-vs-snort</a>, Pristupano 16.1.2013.
</p><p><a href="http://www.cis.hr/sigurosni-alati/ipsids.html" class="external free" rel="nofollow">http://www.cis.hr/sigurosni-alati/ipsids.html</a>, Pristupano 19.1.2013.
</p>
<!-- 
NewPP limit report
Preprocessor node count: 251/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key sisds:pcache:idhash:4390-0!*!0!!hr!2!edit=0 and timestamp 20190203204008 -->
<div class="printfooter">
Dobavljeno iz "<a href="Sustavi_za_detekciju_napada_(Suricata).html">http://security.foi.hr/wiki/index.php/Sustavi_za_detekciju_napada_(Suricata)</a>"</div>
				<!-- /bodytext -->
								<!-- catlinks -->
				<div id='catlinks' class='catlinks catlinks-allhidden'></div>				<!-- /catlinks -->
												<div class="visualClear"></div>
			</div>
			<!-- /bodyContent -->
		</div>
		<!-- /content -->
		<!-- header -->
		<div id="mw-head" class="noprint">
			
<!-- 0 -->
<div id="p-personal" class="">
	<h5>Osobni alati</h5>
	<ul>
					<li  id="pt-login"><a href="http://security.foi.hr/wiki/index.php?title=Posebno:Prijava&amp;returnto=Sustavi_za_detekciju_napada_(Suricata)" title="Predlažemo Vam da se prijavite, ali nije obvezno. [o]" accesskey="o">Prijavi se</a></li>
			</ul>
</div>

<!-- /0 -->
			<div id="left-navigation">
				
<!-- 0 -->
<div id="p-namespaces" class="vectorTabs">
	<h5>Imenski prostori</h5>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="Sustavi_za_detekciju_napada_(Suricata).html"  title="Pogledaj sadržaj [c]" accesskey="c">Članak</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="http://security.foi.hr/wiki/index.php?title=Razgovor:Sustavi_za_detekciju_napada_(Suricata)&amp;action=edit&amp;redlink=1"  title="Razgovor o stranici [t]" accesskey="t">Razgovor</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-variants" class="vectorMenu emptyPortlet">
		<h5><span>Inačice</span><a href="Sustavi_za_detekciju_napada_(Suricata).html#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->
			</div>
			<div id="right-navigation">
				
<!-- 0 -->
<div id="p-views" class="vectorTabs">
	<h5>Pogledi</h5>
	<ul>
					<li id="ca-view" class="selected"><span><a href="Sustavi_za_detekciju_napada_(Suricata).html" >Čitaj</a></span></li>
					<li id="ca-viewsource"><span><a href="http://security.foi.hr/wiki/index.php?title=Sustavi_za_detekciju_napada_(Suricata)&amp;action=edit"  title="Ova stranica je zaštićena. Možete pogledati izvorni kod. [e]" accesskey="e">Vidi izvor</a></span></li>
					<li id="ca-history" class="collapsible "><span><a href="http://security.foi.hr/wiki/index.php?title=Sustavi_za_detekciju_napada_(Suricata)&amp;action=history"  title="Ranije izmjene na ovoj stranici. [h]" accesskey="h">Vidi stare izmjene</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-cactions" class="vectorMenu emptyPortlet">
	<h5><span>Radnje</span><a href="Sustavi_za_detekciju_napada_(Suricata).html#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->

<!-- 2 -->
<div id="p-search">
	<h5><label for="searchInput">Traži</label></h5>
	<form action="http://security.foi.hr/wiki/index.php" id="searchform">
		<input type='hidden' name="title" value="Posebno:Traži"/>
				<input id="searchInput" name="search" type="text"  title="Pretraži ovaj wiki [f]" accesskey="f"  value="" />
		<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Kreni" title="Idi na stranicu s ovim imenom ako ona postoji" />
		<input type="submit" name="fulltext" class="searchButton" id="mw-searchButton" value="Traži" title="Traži ovaj tekst na svim stranicama" />
			</form>
</div>

<!-- /2 -->
			</div>
		</div>
		<!-- /header -->
		<!-- panel -->
			<div id="mw-panel" class="noprint">
				<!-- logo -->
					<div id="p-logo"><a style="background-image: url(../../images/osslogo.png);" href="../../wiki.html"  title="Glavna stranica"></a></div>
				<!-- /logo -->
				
<!-- navigation -->
<div class="portal" id='p-navigation'>
	<h5>Orijentacija</h5>
	<div class="body">
				<ul>
					<li id="n-mainpage-description"><a href="../../wiki.html" title="Posjeti glavnu stranicu [z]" accesskey="z">Glavna stranica</a></li>
					<li id="n-portal"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Portal_zajednice" title="O projektu, što možete učiniti, gdje je što">Portal zajednice</a></li>
					<li id="n-currentevents"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Novosti" title="O trenutačnim događajima">Aktualno</a></li>
					<li id="n-recentchanges"><a href="./Posebno:Nedavne_promjene.html" title="Popis nedavnih promjena u wikiju. [r]" accesskey="r">Nedavne promjene</a></li>
					<li id="n-randompage"><a href="./Posebno:Slučajna_stranica.html" title="Učitaj slučajnu stranicu [x]" accesskey="x">Slučajna stranica</a></li>
					<li id="n-help"><a href="./Pomoć:Pomoć.html" title="Mjesto za pomoć suradnicima.">Pomoć</a></li>
				</ul>
			</div>
</div>

<!-- /navigation -->

<!-- SEARCH -->

<!-- /SEARCH -->

<!-- TOOLBOX -->
<div class="portal" id="p-tb">
	<h5>Traka s alatima</h5>
	<div class="body">
		<ul>
					<li id="t-whatlinkshere"><a href="http://security.foi.hr/wiki/index.php/Posebno:%C5%A0to_vodi_ovamo/Sustavi_za_detekciju_napada_(Suricata)" title="Popis svih stranica koje sadrže poveznice ovamo [j]" accesskey="j">Što vodi ovamo</a></li>
						<li id="t-recentchangeslinked"><a href="http://security.foi.hr/wiki/index.php/Posebno:Povezane_promjene/Sustavi_za_detekciju_napada_(Suricata)" title="Nedavne promjene na stranicama na koje vode ovdašnje poveznice [k]" accesskey="k">Povezane stranice</a></li>
																																										<li id="t-specialpages"><a href="./Posebno:Posebne_stranice.html" title="Popis posebnih stranica [q]" accesskey="q">Posebne stranice</a></li>
									<li id="t-print"><a href="http://security.foi.hr/wiki/index.php?title=Sustavi_za_detekciju_napada_(Suricata)&amp;printable=yes" rel="alternate" title="Verzija za ispis ove stranice [p]" accesskey="p">Verzija za ispis</a></li>
						<li id="t-permalink"><a href="http://security.foi.hr/wiki/index.php?title=Sustavi_za_detekciju_napada_(Suricata)&amp;oldid=16966" title="Trajna poveznica na ovu verziju stranice">Trajna poveznica</a></li>
						</ul>
	</div>
</div>

<!-- /TOOLBOX -->

<!-- LANGUAGES -->

<!-- /LANGUAGES -->
			</div>
		<!-- /panel -->
		<!-- footer -->
		<div id="footer">
											<ul id="footer-info">
																	<li id="footer-info-lastmod"> Datum zadnje promjene na ovoj stranici: 22:03, 20. siječnja 2013.</li>
																							<li id="footer-info-viewcount">Ova stranica je pogledana 32.040 puta.</li>
																							<li id="footer-info-copyright">Sadržaji se koriste u skladu s <a href="http://creativecommons.org/licenses/by-sa/3.0/" class="external ">Creative Commons Attribution Share Alike</a>.</li>
															</ul>
															<ul id="footer-places">
																	<li id="footer-places-privacy"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Za%C5%A1tita_privatnosti" title="SIS Wiki:Zaštita privatnosti">Zaštita privatnosti</a></li>
																							<li id="footer-places-about"><a href="./SIS_Wiki:O_projektu_SIS_Wiki.html" title="SIS Wiki:O projektu SIS Wiki">O projektu SIS Wiki</a></li>
																							<li id="footer-places-disclaimer"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:General_disclaimer" title="SIS Wiki:General disclaimer">Odricanje od odgovornosti</a></li>
															</ul>
											<ul id="footer-icons" class="noprint">
					<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="../skins/common/images/cc-by-sa.png" alt="Creative Commons Attribution Share Alike" width="88" height="31" /></a>
					</li>
					<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<!-- /footer -->
		
<script src="../load.php%3Fdebug=false&amp;lang=hr&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if ( window.mediaWiki ) {
	mediaWiki.config.set({"wgCanonicalNamespace": "", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 0, "wgPageName": "Sustavi_za_detekciju_napada_(Suricata)", "wgTitle": "Sustavi za detekciju napada (Suricata)", "wgAction": "view", "wgArticleId": 4390, "wgIsArticle": true, "wgUserName": null, "wgUserGroups": ["*"], "wgCurRevisionId": 16966, "wgCategories": [], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": []});
}
</script>
<script>if ( window.mediaWiki ) {
	mediaWiki.loader.load(["mediawiki.util", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax"]);
	mediaWiki.loader.go();
}
</script>

<script>if ( window.mediaWiki ) {
	mediaWiki.user.options.set({"ccmeonemails":0,"cols":80,"contextchars":50,"contextlines":5,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,
	"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"hr","language":"hr","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;mediaWiki.loader.state({"user.options":"ready"});
}
</script>		<!-- fixalpha -->
		<script type="text/javascript"> if ( window.isMSIE55 ) fixalpha(); </script>
		<!-- /fixalpha -->
		<!-- Served in 1.320 secs. -->			</body>
</html>
