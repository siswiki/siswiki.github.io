<!DOCTYPE html>
<html lang="hr" dir="ltr">
<head>
<meta charset="UTF-8" />
<title>OpenWRT - SIS Wiki</title>
<meta name="generator" content="MediaWiki 1.17.0" />
<link rel="shortcut icon" href="http://security.foi.hr/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="../opensearch_desc.php" title="SIS Wiki (hr)" />
<link rel="EditURI" type="application/rsd+xml" href="../api.php%3Faction=rsd" />
<link title="Creative Commons" type="application/rdf+xml" href="http://security.foi.hr/wiki/index.php?title=OpenWRT&amp;action=creativecommons" rel="meta" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-sa/3.0/" />
<link rel="alternate" type="application/atom+xml" title="SIS Wiki Atom izvor" href="../index.php%3Ftitle=Posebno:Nedavne_promjene&amp;feed=atom" />
<link rel="stylesheet" href="../load.php%3Fdebug=false&amp;lang=hr&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cskins.vector&amp;only=styles&amp;skin=vector&amp;*.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/wiki/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr ns-0 ns-subject page-OpenWRT skin-vector">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<!-- content -->
		<div id="content">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<!-- firstHeading -->
			<h1 id="firstHeading" class="firstHeading">OpenWRT</h1>
			<!-- /firstHeading -->
			<!-- bodyContent -->
			<div id="bodyContent">
				<!-- tagline -->
				<div id="siteSub">Izvor: SIS Wiki</div>
				<!-- /tagline -->
				<!-- subtitle -->
				<div id="contentSub"></div>
				<!-- /subtitle -->
																<!-- jumpto -->
				<div id="jump-to-nav">
					Skoči na: <a href="OpenWRT.html#mw-head">orijentacija</a>,
					<a href="OpenWRT.html#p-search">traži</a>
				</div>
				<!-- /jumpto -->
								<!-- bodytext -->
				<p>Nikša Marević
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Sadržaj</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="OpenWRT.html#Uvod"><span class="tocnumber">1</span> <span class="toctext">Uvod</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="OpenWRT.html#OpenWRT"><span class="tocnumber">1.1</span> <span class="toctext">OpenWRT</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="OpenWRT.html#Interakcija_s_korisnikom"><span class="tocnumber">1.1.1</span> <span class="toctext">Interakcija s korisnikom</span></a></li>
<li class="toclevel-3 tocsection-4"><a href="OpenWRT.html#Tehni.C4.8Dke_informacije"><span class="tocnumber">1.1.2</span> <span class="toctext">Tehničke informacije</span></a>
<ul>
<li class="toclevel-4 tocsection-5"><a href="OpenWRT.html#Razvoj"><span class="tocnumber">1.1.2.1</span> <span class="toctext">Razvoj</span></a></li>
<li class="toclevel-4 tocsection-6"><a href="OpenWRT.html#Datote.C4.8Dni_sustav"><span class="tocnumber">1.1.2.2</span> <span class="toctext">Datotečni sustav</span></a></li>
<li class="toclevel-4 tocsection-7"><a href="OpenWRT.html#Busybox"><span class="tocnumber">1.1.2.3</span> <span class="toctext">Busybox</span></a></li>
<li class="toclevel-4 tocsection-8"><a href="OpenWRT.html#OPKG"><span class="tocnumber">1.1.2.4</span> <span class="toctext">OPKG</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-9"><a href="OpenWRT.html#Instalacija_firmwarea"><span class="tocnumber">1.1.3</span> <span class="toctext">Instalacija firmwarea</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-10"><a href="OpenWRT.html#DD-WRT"><span class="tocnumber">1.2</span> <span class="toctext">DD-WRT</span></a>
<ul>
<li class="toclevel-3 tocsection-11"><a href="OpenWRT.html#Zna.C4.8Dajke_DD-WRT-a"><span class="tocnumber">1.2.1</span> <span class="toctext">Značajke DD-WRT-a</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="OpenWRT.html#Instalacija_firmwarea_2"><span class="tocnumber">1.2.2</span> <span class="toctext">Instalacija firmwarea</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="OpenWRT.html#Prakti.C4.8Dni_dio"><span class="tocnumber">2</span> <span class="toctext">Praktični dio</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="OpenWRT.html#OpenWRT_2"><span class="tocnumber">2.1</span> <span class="toctext">OpenWRT</span></a>
<ul>
<li class="toclevel-3 tocsection-15"><a href="OpenWRT.html#Konfiguracija_OpenWRTa"><span class="tocnumber">2.1.1</span> <span class="toctext">Konfiguracija OpenWRTa</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="OpenWRT.html#Postavljanje_firewalla"><span class="tocnumber">2.1.2</span> <span class="toctext">Postavljanje firewalla</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="OpenWRT.html#Instalacija_Torrent_klijenta"><span class="tocnumber">2.1.3</span> <span class="toctext">Instalacija Torrent klijenta</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="OpenWRT.html#Jednostavni_file_sharing"><span class="tocnumber">2.1.4</span> <span class="toctext">Jednostavni file sharing</span></a></li>
<li class="toclevel-3 tocsection-19"><a href="OpenWRT.html#Napredne_opcije_usmjeravanja"><span class="tocnumber">2.1.5</span> <span class="toctext">Napredne opcije usmjeravanja</span></a></li>
<li class="toclevel-3 tocsection-20"><a href="OpenWRT.html#Anonimizacija_prometa_putem_TOR_mre.C5.BEe"><span class="tocnumber">2.1.6</span> <span class="toctext">Anonimizacija prometa putem TOR mreže</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-21"><a href="OpenWRT.html#Usporedba_DD-WRT_i_OpenWRT"><span class="tocnumber">3</span> <span class="toctext">Usporedba DD-WRT i OpenWRT</span></a>
<ul>
<li class="toclevel-2 tocsection-22"><a href="OpenWRT.html#Prednosti"><span class="tocnumber">3.1</span> <span class="toctext">Prednosti</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="OpenWRT.html#Nedostaci"><span class="tocnumber">3.2</span> <span class="toctext">Nedostaci</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-24"><a href="OpenWRT.html#Zaklju.C4.8Dak"><span class="tocnumber">4</span> <span class="toctext">Zaključak</span></a></li>
<li class="toclevel-1 tocsection-25"><a href="OpenWRT.html#Literatura"><span class="tocnumber">5</span> <span class="toctext">Literatura</span></a></li>
</ul>
</td></tr></table>
<p><br />
</p>
<h1> <span class="mw-headline" id="Uvod"> Uvod </span></h1>
<p>Za prosječnog kućnog korisnika router je samo još jedan uređaj u kući koji im služi da bi se mogli spojiti na internet. Naravno, u ovom slučaju ne govorimo o profesionalnim routerima kao što su npr. Cisco, već o routerima namijenjenim kućnim korisnicima. Za tog istog prosječnog kućnog korisnika postoje samo sljedeće "brige": koliko ima priključaka za računala i ima li bežičnu mrežnu konekciju. Međutim, naprednijim korisnicima ponekad opcije koje nude kućni routeri nisu dovoljne, a da bi došli do naprednih opcija ponekad su primorani kupovati mnogo skuplje uređaje. Međutim, s pojavom <i>custom firmwarea</i> to više neće biti slučaj jer se jednostavnom nadogradnjom operacijskog sustava dolazi do mnoštva naprednih mogućnosti iz običnog, jeftinog kućnog routera. Neki koje ćemo u nastavku spomenuti su OpenWRT i DD-WRT.
</p>
<h2> <span class="mw-headline" id="OpenWRT"> OpenWRT </span></h2>
<p>OpenWRT je <i>firmware</i> koji je baziran na linux operativnom sustavu za bežične mrežne uređaje. Umjesto kreiranja jedinstvene verzije <i>firmwarea</i> za svaki uređaj posebno, OpenWRT omogućava potpuno prilagođavanje operacijskog sustava uređaja prema korisnikovim željama i potrebama. Na ovaj način se korisnik oslobađa ograničenja i konfiguracije uređaja kako je to zamislio proizvođač ili kako je to zamislio distributer uređaja s modificiranim, najčešće okljaštrenim operacijskim sustavom (npr. <i>internet service provideri</i>). OpenWRT je također vrlo zanimljiv razvijačima softvera jer mogu napraviti aplikaciju na uređaju bez da rade kompletan <i>firmware</i> oko iste.
Međutim, bitno je napomenuti da OenWRT nije moguće instalirati na sve uređaje. Uređaji koji imaju podršku za OpenWRT se nalaze na sljedećem <a href="http://wiki.openwrt.org/toh/start" class="external text" rel="nofollow">linku</a>.
</p>
<h3> <span class="mw-headline" id="Interakcija_s_korisnikom">Interakcija s korisnikom</span></h3>
<p>Glavni način interakcije s korisnikom je putem CLI (eng. <i>command line interface</i>) odnosno komandno-linijskog sučelja. Sam način rada ne razlikuje se puno od bilo kojeg rada s linux/unix operacijskim sustavima. S obzirom na to da je flash memorija routera dosta malena za današnje standarde (8 MB u prosjeku), nisu sve funkcije na koje smo navikli na linux distribucijama dostupne korisniku. 
</p>
<pre>
BusyBox v1.15.3 (2011-11-24 18:38:13 CET) built-in shell (ash)
Enter 'help' for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 Backfire (10.03.1, r29592) ------------------------
  * 1/3 shot Kahlua    In a shot glass, layer Kahlua
  * 1/3 shot Bailey's  on the bottom, then Bailey's,
  * 1/3 shot Vodka     then Vodka.
 ---------------------------------------------------
root@OpenWrt:~#</pre>
<p>Osim komandno-linijskog sučelja, dostupno je i web sučelje. Web sučelje je napravljeno na način da se korisnicima omogući na lagan način manipulirati sa često korištenim opcijama, dok za napredne opcije ipak treba posegnuti za CLI sučeljem. Za OpenWRT postoje tri web sučelja i to:
</p>
<ol><li>LuCI
</li><li>X-Wrt
</li><li>Gargoyle
</li></ol>
<p>LuCI je zadano web sučelje koje dolazi s OpenWRT. Samo sučelje napisano je velikim dijelom u Lua jeziku. Sam Lua jezik je dizajniran kao skriptni jezik, a kako je pisan u ISO C-u isti je višeplatformski jezik. Kao zadani poslužitelj za ovo web sučelje se koristi uhttpd.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:1069px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:Luci3.jpg" class="image"><img alt="" src="../images/9/90/Luci3.jpg" width="1067" height="915" class="thumbimage" /></a>  <div class="thumbcaption">Početna stranica LuCI sučelja</div></div></div></div>
<p>X-Wrt je alternativa za LuCI web sučelje. Za razliku od LuCI sučelja pisan je pomoću Haserla. Haserl je "mali" program koji koristi <i>shell</i> ili Lua skripte da bi kreirao cgi web skripte. Namijenjen je za okružja gdje su ruby ili php jednostavno preveliki, kao u našem slučaju routeri. Kao zadani poslužitelj ovo sučelje ne koristi uhttpd kao LuCI, već lighttpd.
</p><p>Treća opcija je Gargoyle. Za razliku od dva prethodno navedena sučelja, Gargoyle velikim dijelom koristi javascript kako bi se što više izračuna obavilo na klijentskoj strani i na taj način rasteretilo router, dok su procedure koje je neophodno izvršavati na strani poslužitelja napisane pomoću Haserla.
</p>
<h3> <span class="mw-headline" id="Tehni.C4.8Dke_informacije">Tehničke informacije</span></h3>
<h4> <span class="mw-headline" id="Razvoj">Razvoj</span></h4>
<p>Za daljne razvijanje OpenWRTa se koristi OpenWRT <i>Buildroot</i>. To je set <i>makefile</i> i zakrpa koji omogućava kreiranje alata koji će se koristiti na drugačijem sustavu od onog na kojemu se vrši kompajliranje i korjenski datotečni sustav za tzv. <i>embedded</i> sustave. OpenWRT <i>Buildroot</i> je opsežno modificirana verzija originalnog <i>Buildroota</i>. Set alata za kompajliranje se sastoji od:
</p>
<ol><li>Kompajler (obično gcc)
</li><li>Binarni programi popus asemblera i linkera (za OpenWRT <i>binutils</i>)
</li><li>Standardna biblioteka jezika C (<i>GNU Libc, uClibc</i> ili <i>dietlibc</i>)
</li></ol>
<p>Detaljne upute kako se razvija OpenWRT se nalaze na sljedećem <a href="http://wiki.openwrt.org/about/toolchain" class="external text" rel="nofollow">linku</a>.
</p>
<h4> <span class="mw-headline" id="Datote.C4.8Dni_sustav">Datotečni sustav</span></h4>
<p>OpenWRT je dostupan u dva datotečna sustava i to JFFS2 i SquashFS.
</p><p>JFFS2 (Journalling Flash File System version 2) je <i>log-structured</i> datotečni sustav namijenjen za sustave s <i>flash</i> memorijom. Sam JFFS2 je sadržan u jezgri Linux operacijskog sustava od verzije 2.4.10. JFFS2 je predstavio:
</p>
<ol><li>Podršku na NAND flash uređaje
</li><li>Čvrste veze
</li><li>Kompresiju - četiri su algoritma dostupna: zlib, rubin, rtime i lzo.
</li><li>Bolje performanse jer za razliku od JFFS-a ne generira veliki broj nepotrebnih I/O operacija zbog <i>garbage collection</i> algoritma
</li></ol>
<p>SquashFS je kompresirani <i>read-only</i> datotečni sustav za Linux operacijske sustave. SquashFS kompresira datoteke, indeksne čvorove kao i direktorije, a podržava veličine blokova do 1 MB. SquashFS je namijenjen općem <i>read-only</i> sistemskom korištenju ponajviše na <i>embedded</i> sustavima poput routera. Originalna verzija SquashFSa je koristila gzip kompresiju dok se tokom vremena ostvarila podrška i za LZMA, LZO i xz kompresiju. SquashFS je prisutan i kao datotečni sustav za <i>live cd</i> distribucije linux sustava poput Debiana, Fedore, Ubuntua i ostalih.
</p><p><br />
Kada se koriste JFFS2 verzije OpenWRT-a tada se sve datoteke i direktoriji mogu modificirati uključujući i sistemske. Prilikom korištenja SquashFS datotečnog sustava, jezgra operacijskog sustava i sistemske datoteke i direktoriji će biti u kompresirane u <i>read-only</i> modu rada dok će se kreirati i JFFS2 datotečni sustav za instalaciju dodatnih paketa. Ukoliko nema potrebe za modifikacijom sistemskih datoteka, tada je SquashFS bolji izbor. 
</p>
<h4> <span class="mw-headline" id="Busybox">Busybox</span></h4>
<p>Busybox omogućuje nekoliko okljaštrenih unix alata u jednoj izvršnoj datoteci. Moguće ga je pokrenuti u velikom broju POSIX okruženja kao što je Linux (uključujući i Android), FreeBSD i mnoge druge. Posebno je kreiran za uređaje koji imaju ograničene resurse. Busybox se može prilagoditi da pruža podskup od više od dvije stotine alata. Osim unix alata specificiranih u SUS specifikaciji podržava i mnoštvo alata koje bi korisnik očekivao u linux sustavu. Busybox koristi <i>Almquist shell</i>. 
</p>
<h4> <span class="mw-headline" id="OPKG">OPKG</span></h4>
<p>OPKG je upravitelj paketima za OpenWRT. OPKG je upravitelj "lake kategorije" koji se koristi za dohvaćanje i instalaciju OpenWRT paketa bilo iz lokalnog repozitorija ili repozitorija na internetu. OPKG dijeli mnogo sličnosti u korištenju s apt-get komandom iz linuxa.
</p><p>OPKG se koristi zajedno sa zastavicama <i>update, upgrade, install, configure, remove</i> i <i>flag</i>. <i>Update</i> zastavica se koristi za preuzimanje liste dostupnih paketa iz repozitorija. Upgrade se koristi za ažuriranje paketa na načina da se iza <i>upgrade</i> nadopiše i ime paketa. Install se koristi za dohvaćanje i instalaciju željenog paketa. <i>Configure</i> služi za konfiguraciju neraspakiranih paketa dok <i>remove</i> služi za brisanje paketa.
</p><p><br />
</p>
<h3> <span class="mw-headline" id="Instalacija_firmwarea"> Instalacija <i>firmwarea</i> </span></h3>
<p>Da bi mogli koristiti OpenWRT <i>firmware</i>, potrebno je napraviti jednu od ponuđenih opcija:
</p>
<ol><li> Instalirati <i>firmware</i> na neizbrisivu memoriju
</li><li> Instalirati <i>firmware</i> na RAM memoriju
</li><li> Pokrenuti <i>firmware</i> preko mreže
</li></ol>
<p><br />
</p><p>Za naše potrebe <i>firmware</i> je instaliran na neizbrisivu memoriju. To možemo napraviti na sljedeće načine:
</p>
<dl><dt>1. Preko originalnog <i>firmwarea</i>
</dt><dd>Pronađemo preko web sučelja (na originalnom <i>firmwareu</i>) opciju stavljanja nove verzije <i>firmwarea</i>, odaberemo putanju gdje se nalazi OpenWRT te na kraju kliknemo "Update"
</dd></dl>
<dl><dt>2. Preko <i>bootloadera</i> i mrežnog priključka
</dt><dd>Prvo valja instalirati odgovarajući softver na računalo npr. ako <i>bootloader</i> sadrži FTP server, treba instalirati FTP klijent. Zatim treba dati računalu statičku IP adresu u istoj mreži kako je postavljeno u <i>bootloaderu</i>. Nakon što se sve podesi, računalo se spaja na odgovarajući priključak, uređaj se ponovno pokreće. U zadanom trenutku treba slijediti procedure da se prebriše stari <i>firmware</i> novim OpenWRT operacijskim sustavom. Pri tome treba paziti da se ne prebriše <i>bootloader</i> dok se to eksplicitno ne zatraži od korisnika.
</dd></dl>
<dl><dt>3. Preko <i>bootloadera</i> i serijskog porta
</dt></dl>
<dl><dt>4. Preko JTAG-a
</dt></dl>
<p>Potonja dva načina nećemo detaljnije razmatrati.
</p>
<h2> <span class="mw-headline" id="DD-WRT"> DD-WRT </span></h2>
<p>DD-WRT je operacijski sustav za routere napravljen za mnoge bežične routere bazirane na Broadcomovim i Atherosovim mikročipovima. Prve verzije su bazirane na <i>Alchemy firmware</i> operacijskom sustavu za routere od kompanije Sveasoft, međutim, kako je tvrtka Sveasoft prestala davati otvoreni kod za svoj operacijski sustav, DD-WRT se počeo razvijati u svom smjeru. Trenutno je DD-WRT izdan besplatno od <a href="http://en.wikipedia.org/wiki/GNU_General_Public_License" class="external text" rel="nofollow">GPL</a> licencom. DD-WRT je zbog svoga <i>user-friendly</i> web sučelja popularan kao izbor za ljude koji nisu vješti s komandnom linijom, a trebaju im napredne funkcije. Proizvođač mrežne opreme Buffalo je odlučio koristiti DD-WRT kao službeni softver na svojim uređajima iz serije HighPowerLista podržanih uređaja se nalazi na sljedećem <a href="http://www.dd-wrt.com/wiki/index.php/Supported_Devices" class="external text" rel="nofollow">linku</a>.
</p><p>Samim DD-WRT-om se nećemo detaljno baviti jer ćemo ga koristiti isključivo za usporedbu s OpenWRT-om. 
</p><p><i>Zanimljivost:</i> DD u nazivu DD-WRT je njemačka registracijska oznaka za Dresden.
</p>
<h3> <span class="mw-headline" id="Zna.C4.8Dajke_DD-WRT-a">Značajke DD-WRT-a</span></h3>
<p>DD-WRT se sastoji od web sučelja i komandno-linijskog sučelja kojem je moguće pristupiti preko telneta ili SSH. Web sučelje je vrlo bogato opcijama i većina opcija se da konfigurirati putem njega. Za potrebe usporedbe je korištena <i>mega</i> distribucija koja na sebi ima najviše dodatnih alata. 
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:858px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:Ddwrt.JPG" class="image"><img alt="" src="../images/5/56/Ddwrt.JPG" width="856" height="755" class="thumbimage" /></a>  <div class="thumbcaption">Prikaz web sučelja za DD-WRT operacijski sustav</div></div></div></div>
<p>Kada se putem telnet klijenta ulogiramo na DD-WRT dobivamo sljedeći ekran:
</p>
<pre>
DD-WRT v24-sp2 mega (c) 2010 NewMedia-NET GmbH
Release: 08/07/10 (SVN revision: 14896)

Jutsu login: root
Password:
==========================================================

 ____  ___    __        ______ _____         ____  _  _
 | _ \| _ \   \ \      / /  _ \_   _| __   _|___ \| || |
 || | || ||____\ \ /\ / /| |_) || |   \ \ / / __) | || |_
 ||_| ||_||_____\ V  V / |  _ &lt; | |    \ V / / __/|__   _|
 |___/|___/      \_/\_/  |_| \_\|_|     \_/ |_____|  |_|

                       DD-WRT v24-sp2
                   http://www.dd-wrt.com

==========================================================


BusyBox v1.13.4 (2010-08-07 02:19:29 CEST) built-in shell (ash)
Enter 'help' for a list of built-in commands.

root@Jutsu:~#
</pre>
<p>Možemo vidjeti da se i ovdje koristi Busybox kao i na OpenWRT-u.
</p><p>DD-WRT dolazi u sedam verzija i to: Micro, Mini, Nokaid, Standard, VOIP, VPN i Mega. Micro verzija je namijenjena za routere koji imaju malu ROM memoriju dok je Mega verzija koja sadrži sve alate za DD-WRT i namijenjena je za routere koji imaju preko 8MB interne ROM memorije.
</p><p><br />
</p>
<h3> <span class="mw-headline" id="Instalacija_firmwarea_2"> Instalacija <i>firmwarea</i> </span></h3>
<p>Instalacija DD-WRT-a je izrazito jednostavna. Međutim, vrlo je važno paziti koji model routera imate jer neke verzije DD-WRTa imaju izbačene funkcije da bi mogle stati u <i>flash</i> od uređaja. Nakon što je pronađena ispravna verzija, preko web sučelja originalnog operacijskog sustava se učita datoteka koja sadrži DD-WRT i pusti da router sam obavi nadogradnju sustava. Pri tome je vrlo važno da ne dođe do gubitka napajanja na routeru prilikom nadogradnje jer isti tada prestaje raditi.
</p>
<h1> <span class="mw-headline" id="Prakti.C4.8Dni_dio">Praktični dio</span></h1>
<h2> <span class="mw-headline" id="OpenWRT_2">OpenWRT</span></h2>
<h3> <span class="mw-headline" id="Konfiguracija_OpenWRTa">Konfiguracija OpenWRTa</span></h3>
<p>Za potrebe korištenja OpenWRTa korišten je virtualni image u virtualzacijskom programu VirtualBox.
</p><p>Unutar operacijskog sustava bilo je potrebno konfigurirati mrežne adaptere. Za potrebe testiranja su korištena dva sučelja. Jedno sučelje "glumi" WAN port i povezano je u NAT modu s host operacijskim sustavom, dok je drugi povezan u bridged mod i ima adresu u subnetu od mreže na kojoj se nalazi računalo na kojem se izvodi virtualizacija. Prvo je bilo potrebno staviti <i>root</i> korisniku lozinku da se omogući SSH pristup:
</p>
<pre>root@OpenWrt:~# passwd root
Changing password for root
New password:
Retype password:
Password for root changed by root</pre>
<p>Zatim je bilo potrebno konfigurirati mrežu. Tekstualnim editorom "VI" je uređena konfiguracijska datoteka koja se nalazi na /etc/config/network na sljedeći način:
</p>
<pre>
# Copyright (C) 2006 OpenWrt.org

config interface loopback
        option ifname   lo
        option proto    static
        option ipaddr   127.0.0.1
        option netmask  255.0.0.0

config interface wan           #wan mreža koja radi u NAT modu
        option ifname   eth0
        option proto    dhcp

config interface lan           #mreža koja radi u bridged modu
        option ifname   eth1
        option type     bridge
        option proto    static
        option ipaddr   192.168.2.150
        option netmask  255.255.255.0</pre>
<p>Nakon što je mreža konfigurirana, bilo je moguće skinuti sadržaj repozitorija u sustav. To se radi na sljedeći način:
</p>
<pre>root@OpenWrt:~#opkg update</pre>
<p>Na ovaj način je preuzet sadržaj repozitorija i moguće je skidati sve potrebne pakete za daljnji dio.
</p>
<h3> <span class="mw-headline" id="Postavljanje_firewalla">Postavljanje <i>firewalla</i></span></h3>
<p>Firewall je moguće na više načina postaviti na uređaj koji ima na sebi OpenWRT. Mi ćemo sagledati tri načina:
</p>
<ol><li>Firewall preko <i>iptables</i>
</li><li>Firewall preko web sučelja
</li><li>Konfiguracija datoteke /etc/config/firewall
</li></ol>
<p>Ukoliko se koristimo opcijom iptables, tada vrijede ista pravila kao i kada postavljamo pravila za mrežni promet na bilo kojoj linux distribuciji. Ukratko, postoje tri lanca:
</p>
<ol><li>INPUT
</li><li>FORWARD
</li><li>OUTPUT
</li></ol>
<p>Za svaki paket koji pristigne na neko od mrežnih sučelja, serijsko ili neko drugo, najprije se određuje njegovo odredište (eng. Routing decision). Ukoliko je krajnji cilj paketa neki lokalni proces na istom računalu na kojemu je upogonjen firewall, paket se usmjerava prema INPUT lancu. Ako se pokaže da je odredište paketa neko drugo računalo, tada ga se prosljeđuje FORWARD lancu. Konačno, paket kojeg generiraju neke lokalne aplikacije odnosno procesi na lokalnom računalu, usmjerava se OUTPUT lancu u kojem se odlučuje što je potrebno napraviti s tim mrežnim paketom generiranim od strane samog firewalla. Nekoliko je akcija primjenjivo nad svakim paketom u navedenim točkama od kojih su najznačajnije 
sljedeće: DROP, ACCEPT, QUEUE, RETURN, REJECT i LOG. Akcija DROP označava odbacivanje paketa na način da ga se jednostavno zanemari pri čemu se ne šalje nikakva obavijest o odbačenom paketu.  ACCEPT podrazumijeva prosljeđivanje paketa u sljedeći segment koji dolazi.  QUEUE označava prosljeđivanje paketa korisničkom procesu iz memorijskog prostora NetFilter mehanizma u memorijski prostor korisničkih aplikacija. RETURN obilježava prestanak usporedbe u tekućem lancu i povratak na sljedeću neobrađenu usporedbu u prethodnom lancu. REJECT slično kao i DROP odbacuje paket, ali na način da pošiljatelja obavijesti o tome. LOG se koristi za zapisivanje potankosti o paketima preuzetih iz zaglavlja paketa i drugih potencijalno važnih informacija. Na sljedeći način možemo pogledati koja pravila postoje u routeru:
</p>
<pre>root@OpenWrt:~# iptables -L
Chain INPUT (policy ACCEPT)
target     prot opt source               destination

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination
</pre>
<p>U ovom slučaju se sav mrežni promet se propušta. Daljnje korištenje <i>iptables</i> nećemo razmatrati.
</p><p>Konfiguracija firewalla preko web sučelja omogućava brzo dodavanje pravila. Osim toga se omogućuje i lakši uvid u već postojeća pravila.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:866px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:Firewall.jpg" class="image"><img alt="" src="../images/c/c5/Firewall.jpg" width="864" height="985" class="thumbimage" /></a>  <div class="thumbcaption">Web sučelje OpenWRT firewalla</div></div></div></div>
<p>Nova pravila se dodavaju na način da se klikne na "Add" ikonu ovisno da li želimo dodati novo pravilo ili preusmjerenje. Kada dodavamo novo pravilo, dodavamo mu ime, postavljamo na koje se sučelje odnosi (LAN ili WAN u našem slučaju), na koji se protokol odnosi, polazišna i odredišna IP adresa te koju će radnju firewall obaviti (drop, accept, reject, don't track). Napredne funkcije koje se nude su odredišna zona, MAC adresa izvora te da li se pravilo odnosi na IPv4, IPv6 ili na oba protokola.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:866px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:Firewall2.jpg" class="image"><img alt="" src="../images/a/a1/Firewall2.jpg" width="864" height="657" class="thumbimage" /></a>  <div class="thumbcaption">Web sučelje OpenWRT firewalla - dodavanje novog pravila</div></div></div></div>
<p>Konfiguracijska datoteka /etc/config/firewall izgleda na sljedeći način:
</p>
<pre>config defaults
	option syn_flood	1
	option input		ACCEPT
	option output		ACCEPT 
	option forward		REJECT
# Uncomment this line to disable ipv6 rules
#	option disable_ipv6	1

config zone
	option name		lan
	option network		'lan'
	option input		ACCEPT 
	option output		ACCEPT 
	option forward		REJECT

config zone
	option name		wan
	option network		'wan'
	option input		REJECT
	option output		ACCEPT 
	option forward		REJECT
	option masq		1 
	option mtu_fix		1

config forwarding 
	option src      	lan
	option dest     	wan

# We need to accept udp packets on port 68,
# see https://dev.openwrt.org/ticket/4108
config rule
	option name		Allow-DHCP-Renew
	option src		wan
	option proto		udp
	option dest_port	68
	option target		ACCEPT
	option family		ipv4

# Allow IPv4 ping
config rule
	option name		Allow-Ping
	option src		wan
	option proto		icmp
	option icmp_type	echo-request
	option family		ipv4
	option target		ACCEPT

# Allow DHCPv6 replies
# see https://dev.openwrt.org/ticket/10381
config rule
	option name		Allow-DHCPv6
	option src		wan
	option proto		udp
	option src_ip		fe80::/10
	option src_port		547
	option dest_ip		fe80::/10
	option dest_port	546
	option family		ipv6
	option target		ACCEPT

# Allow essential incoming IPv6 ICMP traffic
config rule
	option name		Allow-ICMPv6-Input
	option src		wan
	option proto	icmp
	list icmp_type		echo-request
	list icmp_type		destination-unreachable
	list icmp_type		packet-too-big
	list icmp_type		time-exceeded
	list icmp_type		bad-header
	list icmp_type		unknown-header-type
	list icmp_type		router-solicitation
	list icmp_type		neighbour-solicitation
	option limit		1000/sec
	option family		ipv6
	option target		ACCEPT

# Allow essential forwarded IPv6 ICMP traffic
config rule                                   
	option name		Allow-ICMPv6-Forward
	option src		wan
	option dest		*
	option proto		icmp
	list icmp_type		echo-request
	list icmp_type		destination-unreachable
	list icmp_type		packet-too-big
	list icmp_type		time-exceeded
	list icmp_type		bad-header
	list icmp_type		unknown-header-type
	option limit		1000/sec
	option family		ipv6
	option target		ACCEPT

# include a file with users custom iptables rules
config include
	option path /etc/firewall.user


### EXAMPLE CONFIG SECTIONS
# do not allow a specific ip to access wan
#config rule
#	option src		lan
#	option src_ip	192.168.45.2
#	option dest		wan
#	option proto	tcp
#	option target	REJECT 

# block a specific mac on wan
#config rule
#	option dest		wan
#	option src_mac	00:11:22:33:44:66
#	option target	REJECT 

# block incoming ICMP traffic on a zone
#config rule
#	option src		lan
#	option proto	ICMP
#	option target	DROP

# port redirect port coming in on wan to lan
#config redirect
#	option src			wan
#	option src_dport	80
#	option dest			lan
#	option dest_ip		192.168.16.235
#	option dest_port	80 
#	option proto		tcp


### FULL CONFIG SECTIONS
#config rule
#	option src		lan
#	option src_ip	192.168.45.2
#	option src_mac	00:11:22:33:44:55
#	option src_port	80
#	option dest		wan
#	option dest_ip	194.25.2.129
#	option dest_port	120
#	option proto	tcp
#	option target	REJECT 

#config redirect
#	option src		lan
#	option src_ip	192.168.45.2
#	option src_mac	00:11:22:33:44:55
#	option src_port		1024
#	option src_dport	80
#	option dest_ip	194.25.2.129
#	option dest_port	120
#	option proto	tcp</pre>
<p>Dodavanje pravila u ovu datoteku možemo sagledati sljedećim predloškom:
</p>
<pre>#config ime_pravila
	option src		lan           #naziv izvorišnog sučelja 
	option src_ip	192.168.45.2          #izvorišna IP adresa
	option src_mac	00:11:22:33:44:55     #izvorišna MAC adresa
	option src_port	80                    #izvorišni port
	option dest		wan           #odredišno sučelje
	option dest_ip	194.25.2.129          #odredišna IP adresa
	option dest_port	120           #odredišni port
	option proto	tcp                   #odredišni protokol
	option target	REJECT                #koja će se akcija izvršiti</pre>
<p>Detaljna konfiguracija firewalla se neće razmatrati.  
</p>
<h3> <span class="mw-headline" id="Instalacija_Torrent_klijenta">Instalacija Torrent klijenta</span></h3>
<p>Za potrebe projekta uzet je softver Transmission. Transmission se na OpenWRT instalira na sljedeći način:
</p><p>Prvo je potrebno instalirati Daemon koji je pokrenut u pozadini
</p>
<pre>root@OpenWrt:~#opkg install transmission-daemon</pre>
<p>Zatim se instalira CLI Transmissiona. CLI se može koristiti kao zaseban program u komandnoj liniji:
</p>
<pre>root@OpenWrt:~#opkg install transmission-cli</pre>
<p>Nakon komandne linije, instalira se web sučelje programa. Web sučelje je opcionalno, ali je program lakše koristiti kada ima GUI. Web sučelje je jednostavno za korištenje i dobiva se na način da se upiše <i>ip_adresa_routera:port</i>. Port se zadaje u konfiguracijskoj datoteci i postupak će biti opisan u nastavku.
</p>
<pre>root@OpenWrt:~#opkg install transmission-web</pre>
<p>Osim web sučelja, program može raditi i uz pomoć opcionalne desktop aplikacije. Da bi remote desktop aplikacija radila, potrebno je instalirati sljedeći modul:
</p>
<pre>root@OpenWrt:~#opkg install transmission-remote</pre>
<p>Nakon uspješne instalacije svih modula, potrebno je konfigurirati program pomoću konfiguracijske datoteke. Konfiguracijska datoteka se nalazi na putanji /etc/config/transmission i može se urediti pomoću tekstualnog editora kao što je VI. Konfiguracijska datoteka izgleda na sljedeći način:
</p>
<pre>config transmission
        option enable 1
        option config_dir '/etc/transmission'
        option alt_speed_down 50
        option alt_speed_enabled false
        option alt_speed_time_begin  540
        option alt_speed_time_day 127
        option alt_speed_time_enabled false
        option alt_speed_time_end 1020
        option alt_speed_up 50
        option bind_address_ipv4 '0.0.0.0'
        option bind_address_ipv6 '::'
        option blocklist_enabled false
        option dht_enabled true
        option download_dir '/mnt/sda4/'
        option encryption 1
        option incomplete_dir '/mnt/sda4/incomplete'
        option incomplete_dir_enabled false
        option lazy_bitfield_enabled true
        option lpd_enabled false
        option message_level 2
        option open_file_limit 32
        option peer_limit_global 240
        option peer_limit_per_torrent 60
        option peer_port 51413
        option peer_port_random_high 65535
        option peer_port_random_low 49152
        option peer_port_random_on_start false
        option peer_socket_tos 0
        option pex_enabled true
        option port_forwarding_enabled false
        option preallocation 1
        option proxy &quot;&quot;
        option proxy_auth_enabled false
        option proxy_auth_password ''
        option proxy_auth_username ''
        option proxy_enabled false
        option proxy_port 80
        option proxy_type 0
        option ratio_limit 2.0000
        option ratio_limit_enabled false
        option rename_partial_files true
        option rpc_authentication_required false
        option rpc_bind_address '0.0.0.0'
        option rpc_enabled true
        option rpc_password ''
        option rpc_port 9091
        option rpc_username ''
        option rpc_whitelist '127.0.0.1,192.168.2.*'
        option rpc_whitelist_enabled true
        option script_torrent_done_enabled false
        option script_torrent_done_filename ''
        option speed_limit_down 100
        option speed_limit_down_enabled false
        option speed_limit_up 40
        option speed_limit_up_enabled true
        option start_added_torrents false
        option trash_original_torrent_files false
        option umask 18
        option upload_slots_per_torrent 14
        option watch_dir_enabled false
        option watch_dir ''</pre>
<p>Opcije koje nas zanimaju su <i>enable</i> koju je potrebno postaviti na 1 da bi program funkcionirao, <i>rpc_port</i> koja nam kaže na kojem portu aplikacija radi. U našem primjeru radi na adresi 192.168.2.150:9091 gdje je 192.168.2.150 adresa samog uređaja, 9091 port rada aplikacije Transmission. Osim toga, potrebno je postaviti u <i>rpc_whitelist</i> set ip adresa u kojima radi router. Zadnja opcija koju je potrebno prilagoditi je <i>download_dir</i>. Tu se unosi putanja do diska gdje će se pohranjivati dijeljene datoteke. Ta putanja može voditi do fizičkog diska koji je spojen na USB routera (ukoliko ga posjeduje, a može biti eksterni HDD ili USB flash memorija) ili do mrežne lokacije koja se nalazi u <i>mountu</i>. Nakon uspješne konfiguracije, potrebno je pokrenuti <i>daemon</i>. On se pokreće na sljedeći način:
</p>
<pre>root@OpenWrt:~#/etc/init.d/transmission start</pre>
<p>Ukoliko želimo da se <i>daemon</i> pokreće prilikom svakog pokretanja OpenWRTa, onda je potrebno upisati sljedeće:
</p>
<pre>root@OpenWrt:~#/etc/init.d/transmission enable</pre>
<p>Napokon možemo iskušati da li Transmission radi i upisivanjem u web preglednik adrese 192.168.2.150:9091 dobivamo sljedeće:
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:785px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:Transmission.jpg" class="image"><img alt="" src="../images/c/ce/Transmission.jpg" width="783" height="540" class="thumbimage" /></a>  <div class="thumbcaption">Transmission web sučelje</div></div></div></div>
<p>Nadalje, željeli bi vidjeti da li Transmission radi i u svojem <i>remote</i> obliku. Ovaj oblik je vrlo koristan jer omogućuje da se vrši preuzimanje datoteka na udaljeni poslužitelj. Nakon instalacije Transmission daljinskog klijenta i prvog pokretanja, prvo što dobivamo je sljedeći prozor:
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:532px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:Transmission2.jpg" class="image"><img alt="" src="../images/c/c6/Transmission2.jpg" width="530" height="345" class="thumbimage" /></a>  <div class="thumbcaption">Konfiguracija Transmision daljinskog sučelja</div></div></div></div>
<p>Potrebno je unijeti adresu poslužitelja, port poslužitelja, u našem slučaju 192.168.2.150 za adresu i 9091 za port te korisničko ime i lozinku koji su u našem slučaju prazna polja jer ih nismo definirali u konfiguracijskoj datoteci. Postoje i ostale naprednije funkcije koje za potrebe ove demonstracije nisu korištene. Samo sučelje daljinskog klijenta podsjeća na ostale desktop BitTorrent aplikacije i izgleda ovako:
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:1278px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:Transmission3.jpg" class="image"><img alt="" src="../images/f/f9/Transmission3.jpg" width="1276" height="795" class="thumbimage" /></a>  <div class="thumbcaption">Transmission remote GUI</div></div></div></div>
<p>Detaljni rad i opcije ove aplikacije nećemo razmatrati jer nisu relevantni za rad.
</p>
<h3> <span class="mw-headline" id="Jednostavni_file_sharing">Jednostavni file sharing</span></h3>
<p>Za potrebe jednostavnog file sharinga korišten je modul <i>samba2-server</i> i modul <i>luci-app-samba</i> koji omogućuje konfiguraciju samba poslužitelja unutar web sučelja od routera. Samba je poznata s linux operacijskog sustava kao servis za dijeljenje datoteka i pisača. Da bi instalirali sambu potrebno je izvršiti sljedeću naredbu:
</p>
<pre>root@OpenWrt:~# opkg install samba2-server</pre> 
<p>Nakon instalacije, možemo kofigurirati sambinu konfiguracijsku datoteku koja se nalazi na putanji /etc/config/samba putem tekstualnog editora kao što je VI, međutim, ovdje ćemo sambu konfigurirati putem web sučelja. Da bi to napravili, potrebno je instalirati dodatak <i>luci-app-samba</i> koji možemo instalirati na sljedeći način:
</p>
<pre>root@OpenWrt:~# opkg install luci-app-samba</pre> 
<p>Nakon instalacije luci-app-samba, možemo urediti da se samba pokreće prilikom svakog pokretanja uređaja kao i pokrenuti je na sljedeći način:
</p>
<pre>root@OpenWrt:~# o/etc/init.d/samba enable
root@OpenWrt:~# o/etc/init.d/samba start
</pre>
<p>Sada se možemo spojiti na web sučelje uređaja upisujući ip adresu uređaja u web preglednik (u našem slučaju 192.168.2.150), ulogirati se te kliknuti na tab <i>Services</i>.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:991px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:Luci.jpg" class="image"><img alt="" src="../images/7/76/Luci.jpg" width="989" height="678" class="thumbimage" /></a>  <div class="thumbcaption">Web sučelje za upravljanje sambom</div></div></div></div>
<p>Za probu je postavljeno dijeljenje direktorija /tmp koji se nalazi na samom uređaju. Ukoliko se želi, moguće je postaviti dijeljenje uređaja poput hard diskova ili USB memorije koji su spojeni na USB sučelje routera. U kombinaciji s prethodno opisanim Transmissionom možemo primjerice napraviti i dijeljenje svih datoteka koje su preuzete putem interneta u lokalnoj mreži. Da se uvjerimo da dijeljenje podataka zaista funkcionira, u Windows exploreru smo upisali putanju \\openwrt\tmp i dobili smo sve datoteke koje se nalaze u tom dijeljenom direktoriju.
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:1052px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:Luci2.jpg" class="image"><img alt="" src="../images/8/8d/Luci2.jpg" width="1050" height="665" class="thumbimage" /></a>  <div class="thumbcaption">Sadržaj dijeljene datoteke koja se nalazi na routeru</div></div></div></div>
<h3> <span class="mw-headline" id="Napredne_opcije_usmjeravanja">Napredne opcije usmjeravanja</span></h3>
<p>Pomoću alata Quagga je korisnicima omogućeno da koriste napredne opcije usmjeravanja kao što ih nalazimo na puno naprednijim uređajima. Tako nam je omogućeno da koristimo napredne protokole poput BGPv4, BGPv4+, BGPv4-, OSPF ili RIP na bilo kojem routeru koji ima na sebi OpenWRT i Quaggu. Da bi instalirali podršku za sve protokole potrebno je instalirati potrebne alate i njihove dodatke na sljedeći način:
</p>
<pre>opkg install ip quagga quagga-libzebra quagga-bgpd quagga-libospf quagga-ospf6d quagga-ospfd quagga-ripd</pre>
<p>Na ovaj način smo omogućili baratanje sa svim prethodno navedenim protokolima. Možemo primjetiti da je potrebno instalirati i paket "ip" koji je kontrolni alat za usmjeravanje te je isti potreban da bi Quagga uspješno radila. Nakon što je sve instalirano, potrebno je napraviti konfiguraciju alata i samog sustava. Kako alat nije htio dobro raditi, nakon intezivnog traženja je pronađeno da se mora urediti konfiguracijska datoteka /etc/hosts i maknuti točka poslije <i>localhost</i> tako da ista izgleda na sljedeći način:
</p>
<pre>127.0.0.1 localhost</pre>
<p>Nakon toga možemo urediti konfiguracijsku datoteku koja se nalazi na /etc/quagga/zebra.conf. U toj datoteci možemo promijeniti lozinku za spajanje na Quaggu kao i dopustiti da se konfiguracija vrši bez posrednog logiranja na router. Da bi to omogućili, potrebno je da datoteka izgleda na sljedeći način:
</p>
<pre>password lozinka                   #postaviti željenu lozinku
!
access-list vty permit 127.0.0.0/8
access-list vty permit any         #promijeniti zadano deny stanje u permit
!
line vty
 access-class vty

</pre>
<p>Sada možemo pokrenuti servis na sljedeći način:
</p>
<pre>root@OpenWrt:~# /etc/init.d/quagga start</pre>
<p>Samu konfiguraciju vršimo pomoću telnet klijenta gdje se spajamo na adresu routera uz uvjet da je port postavljen na 2601. Ukoliko bi uzeli port 23 koji je zadani port za telnet, spojili bi smo se na sam router, a ne na Quaggu, što nam nije sada cilj. Za spajanje je korišten program putty sa konfiguracijom kako stoji na slici:
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:468px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:Quagga.jpg" class="image"><img alt="" src="../images/a/a3/Quagga.jpg" width="466" height="448" class="thumbimage" /></a>  <div class="thumbcaption">Putty konfiguracija za spajanje na Quaggu</div></div></div></div>
<p>Nakon uspješnog spajanja, potrebno je unijeti lozinku koju smo zadali u konfiguraciji. Možemo primijetiti da sučelje podsjeća na ono koje se nalazi na Ciscovim uređajima. Čaj je i većina komandi ista. Na ovaj način možemo zaključiti da ukoliko posjedujemo znanje kako konfigurirati Ciscove uređaje, vrlo lako možemo konfigurirati i sve uređaje koje imaju instaliranu Quaggu. Zbog nedostatka opreme nije napravljena detaljna konfiguracija Quagge. Samo sučelje izgleda na sljedeći način:
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:661px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:Quagga2.jpg" class="image"><img alt="" src="../images/3/35/Quagga2.jpg" width="659" height="424" class="thumbimage" /></a>  <div class="thumbcaption">Sučelje Quagge</div></div></div></div>
<h3> <span class="mw-headline" id="Anonimizacija_prometa_putem_TOR_mre.C5.BEe">Anonimizacija prometa putem TOR mreže</span></h3>
<p>Jedna od zanimljivosti je kako omogućiti anonimnost korisnicima. Moguće je preuzeti <i>Tor browser bundle</i> za omogućavanje anonimnosti http prometa, međutim što ako želimo da svi korisnici koriste Tor mrežu za sve protokole? Za taj slučaj možemo prilagoditi router koji na sebi ima OpenWRT da se spaja na Tor mrežu. Za početak moramo instalirati dodatak za <i>iptables</i> iptables-mod-nat-extra i sam tor na sljedeći način:
</p>
<pre>root@OpenWrt:~# opkg install tor iptables-mod-nat-extra</pre>
<p>Nakon instalacije potrebno je napraviti konfiguraciju. Prvo je potrebno podesiti mrežno sučelje na koje će se korisnici spajati. Konfiguracijska datoteka se nalazi na /etc/conf/network.
</p>
<pre>config interface tor
        option ifname   &quot;ath0&quot;  #bežično mrežno sučelje
        option proto    static
        option ipaddr   192.168.3.1
        option netmask  255.255.255.0</pre>
<p>Zatim je potrebno prilagoditi <i>dhcp</i> za novo sučelje "tor" na sljedeći način:
</p>
<pre>config dhcp tor
    option interface    tor
    option start     100
    option stop    150
    option leasetime    12h</pre>
<p>Nakon toga valja urediti <i>firewall</i> na način da svi korisnici koji se spoje na bežičnu točku ne mogu vidjeti koja su računala unutar mreže iz sigurnosnih razloga te dodati pravila da se korisnike preusmjerava na tor mrežu. To se može napraviti na sljedeći način u konfiguracijskoj datoteci /etc/config/firewall:
</p>
<pre>config zone
        option name     tor
        option input    REJECT
        option output   ACCEPT
        option forward  REJECT
        option syn_flood 1
        option conntrack 1 #this setting is mandatory

#otvaranje porta na DHCP serveru, da bi klijenti dobiliip konfiguracijsko pravilo                                
        option src              tor        
        option proto            udp        
        option dest_port        67         
        option target           ACCEPT     
#TOR transparentni proxy port (postavljen u /etc/tor/torrc)                                           
config rule                                
        option src              tor        
        option proto            tcp        
        option dest_port        9040       
        option target           ACCEPT     
#TOR DNS-proxy-port (postavljen u /etc/tor/torrc)                                            
config rule                                
        option src              tor        
        option proto            udp        
        option dest_port        9053       
        option target           ACCEPT</pre>
<p>Idući korak je postavljanje pravila putem <i>iptables</i>. Ukoliko iste stavimo u datoteku /etc/firewall.user tada će se one izvršiti prilikom svakog pokretanja <i>firewalla</i>:
</p>
<pre>iptables -t nat -A PREROUTING -i ath0 -p udp --dport 53 -j REDIRECT --to-ports 9053 #redirects all DNS-requests on the interface ath0 to the tor-daemon-dns-proxy-port
iptables -t nat -A PREROUTING -i ath0 -p tcp --syn -j REDIRECT --to-ports 9040 #redirects all tcp-requests on the interface ath0 to the tor-daemon-transparent-proxy-port</pre>
<p>Nakon što je <i>firewall</i> podešen možemo konfigurirati Tor. Njegova konfiguracijska datoteka se nalazi u /etc/tor/torrc
</p>
<pre>VirtualAddrNetwork 10.192.0.0/10             
AutomapHostsOnResolve 1                                              
TransPort 9040                                                          
TransListenAddress 192.168.3.1                                          
DNSPort 9053                                                              
DNSListenAddress 192.168.3.1</pre> 
<p>Na kraju valja podesiti datoteku za wifi sučelje koja se nalazi /etc/conf/wireless:
</p>
<pre>config wifi-device  wifi0
    option type     atheros
    option channel  auto

# REMOVE THIS LINE TO ENABLE WIFI:
#    option disabled 1

config wifi-iface
    option device    wifi0
    option network    tor
    option mode    ap
    option ssid    'TorWlan'
    option encryption none     #ukoliko se želi, može se staviti i sigurnosna zaštita za spajanje</pre>
<p>Spajanjem na SSID TorWlan, svim računalima će se promet preusmjeravati preko Tor mreže dok se ta računala međusobno neće moći "vidjeti" niti vidjeti od čega se sve lokalna mreža sastoji.
</p>
<h1> <span class="mw-headline" id="Usporedba_DD-WRT_i_OpenWRT">Usporedba DD-WRT i OpenWRT</span></h1>
<p>U ovom poglavlju ćemo sagledati prednosti i nedostatke OpenWRT-a nad DD-WRT operacijskim sustavom.
</p>
<h2> <span class="mw-headline" id="Prednosti">Prednosti</span></h2>
<ol><li>Veća zajednica - veća zajednica znači i veći angažman ljudi oko projekta kao i veća podrška za <i>3rd party</i> developere
</li><li>Modularnost - korisnik može sebi prilagoditi distribuciju ovisno o željama i potrebama
</li><li>Veći broj dodataka - repozitorij OpenWRT-a sadrži brojne dodatke za operacijski sustav
</li><li>Velika mogućnost prilagodbe - moguće je uređivati sve konfiguracijske datoteke da bi se operacijski sustav što više prilagodio korisniku
</li><li>Veliki broj podržanih uređaja - ukoliko dva routera različitih proizvođača imaju osti <i>chipset</i> tada je velika vjerojatnost da će na njima raditi isti <i>image</i> operacijskog sustava
</li></ol>
<h2> <span class="mw-headline" id="Nedostaci">Nedostaci</span></h2>
<ol><li>Manjak stabilnosti - nakon dvogodišnjeg korištenja DD-WRT-a bez ikakvih problema, pojavili su se određeni problemi vezani za stabilnost (prestanak rada i sl.) kod OpenWRT-a unutar mjesec dana
</li><li>Inferiorno web sučelje - dok se kod DD-WRT-a može skoro sve obaviti putem web sučelja, kod OpenWRT-a je ipak potrebno intenzivnije znanje korištenja linux shell naredbi 
</li><li>Nedostatak kompletne dokumentacije za sve dodatke na OpenWRT-ovom mrežnom mjestu - na DD-WRT-ovoj stranici se nalaze svi mogući tutoriali koji će korisniku trebati dok to primjerice kod OpenWRT-a nije slučaj. Prilikom izrade ovog rada postojao je problem kod instalacije Quagga i Tor programskog paketa jer na osnovnoj stranici nije bilo dokumentacije o njima
</li></ol>
<h1> <span class="mw-headline" id="Zaklju.C4.8Dak">Zaključak</span></h1>
<p>OpenWRT pruža odličnu alternativu <i>stock</i> operacijskom sustavu routera. Kao prvu prednost možemo navesti postojanje dosta naprednijih funkcija (koje će, doduše, više značiti naprednim korisnicima). Osim toga, OpenWRT omogućuje slobodu korištenja na način da korisnik može konfigurirati routere na točno onakav način kakav mu odgovara. Primjerice, nekim korisnicima ne treba ništa drugo osim AP (<i>access point</i>) funkcija routera te se isti vrlo lagano može "pretvoriti" u AP, a da se pri tome uopće ne koriste opcije poput DHCP-a i sl. koje su pokrenute "u pozadini" i na taj način oduzimaju dragocjeno procesorsko vrijeme kao i radnu memoriju routera. Kao još jedna zanimljiva opcija koja je obrađena je korištenje routera kao torrent klijenta. Tako korisnik ne mora imati upaljeno računalo cijelo vrijeme dok se preuzimaju podaci putem torrenta već jednostavno može u router prikopčati bilo kakav tip USB memorije i na taj način uštediti na energiji jer rad routera zahtjeva mnogo manje energije te je router u većini slučajeva uređaj koji se nikada ne gasi.
</p><p>Možemo zaključiti da ovakve "mikro distribucije" linuxa uvelike daje korisniku slobodu da izvuče maksimum iz svog uređaja, a da pri tome može i uštediti novce jer "jeftini" router s ovakvim operacijskim sustavom može parirati i nekim višestruko skupljim uređajima.
</p>
<h1> <span class="mw-headline" id="Literatura">Literatura</span></h1>
<ol><li><a href="http://www.openwrt.org" class="external free" rel="nofollow">http://www.openwrt.org</a>
</li><li><a href="http://www.lua.org/about.html" class="external free" rel="nofollow">http://www.lua.org/about.html</a>
</li><li><a href="http://luci.subsignal.org/trac" class="external free" rel="nofollow">http://luci.subsignal.org/trac</a>
</li><li><a href="http://www.x-wrt.org/" class="external free" rel="nofollow">http://www.x-wrt.org/</a>
</li><li><a href="http://www.gargoyle-router.com" class="external free" rel="nofollow">http://www.gargoyle-router.com</a>
</li><li><a href="http://www.squashfs-lzma.org/" class="external free" rel="nofollow">http://www.squashfs-lzma.org/</a>
</li><li><a href="http://www.busybox.net/" class="external free" rel="nofollow">http://www.busybox.net/</a>
</li></ol>

<!-- 
NewPP limit report
Preprocessor node count: 360/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key sisds:pcache:idhash:4365-0!*!0!!hr!2!edit=0 and timestamp 20190203204055 -->
<div class="printfooter">
Dobavljeno iz "<a href="OpenWRT.html">http://security.foi.hr/wiki/index.php/OpenWRT</a>"</div>
				<!-- /bodytext -->
								<!-- catlinks -->
				<div id='catlinks' class='catlinks catlinks-allhidden'></div>				<!-- /catlinks -->
												<div class="visualClear"></div>
			</div>
			<!-- /bodyContent -->
		</div>
		<!-- /content -->
		<!-- header -->
		<div id="mw-head" class="noprint">
			
<!-- 0 -->
<div id="p-personal" class="">
	<h5>Osobni alati</h5>
	<ul>
					<li  id="pt-login"><a href="http://security.foi.hr/wiki/index.php?title=Posebno:Prijava&amp;returnto=OpenWRT" title="Predlažemo Vam da se prijavite, ali nije obvezno. [o]" accesskey="o">Prijavi se</a></li>
			</ul>
</div>

<!-- /0 -->
			<div id="left-navigation">
				
<!-- 0 -->
<div id="p-namespaces" class="vectorTabs">
	<h5>Imenski prostori</h5>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="OpenWRT.html"  title="Pogledaj sadržaj [c]" accesskey="c">Članak</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="http://security.foi.hr/wiki/index.php?title=Razgovor:OpenWRT&amp;action=edit&amp;redlink=1"  title="Razgovor o stranici [t]" accesskey="t">Razgovor</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-variants" class="vectorMenu emptyPortlet">
		<h5><span>Inačice</span><a href="OpenWRT.html#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->
			</div>
			<div id="right-navigation">
				
<!-- 0 -->
<div id="p-views" class="vectorTabs">
	<h5>Pogledi</h5>
	<ul>
					<li id="ca-view" class="selected"><span><a href="OpenWRT.html" >Čitaj</a></span></li>
					<li id="ca-viewsource"><span><a href="http://security.foi.hr/wiki/index.php?title=OpenWRT&amp;action=edit"  title="Ova stranica je zaštićena. Možete pogledati izvorni kod. [e]" accesskey="e">Vidi izvor</a></span></li>
					<li id="ca-history" class="collapsible "><span><a href="http://security.foi.hr/wiki/index.php?title=OpenWRT&amp;action=history"  title="Ranije izmjene na ovoj stranici. [h]" accesskey="h">Vidi stare izmjene</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-cactions" class="vectorMenu emptyPortlet">
	<h5><span>Radnje</span><a href="OpenWRT.html#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->

<!-- 2 -->
<div id="p-search">
	<h5><label for="searchInput">Traži</label></h5>
	<form action="http://security.foi.hr/wiki/index.php" id="searchform">
		<input type='hidden' name="title" value="Posebno:Traži"/>
				<input id="searchInput" name="search" type="text"  title="Pretraži ovaj wiki [f]" accesskey="f"  value="" />
		<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Kreni" title="Idi na stranicu s ovim imenom ako ona postoji" />
		<input type="submit" name="fulltext" class="searchButton" id="mw-searchButton" value="Traži" title="Traži ovaj tekst na svim stranicama" />
			</form>
</div>

<!-- /2 -->
			</div>
		</div>
		<!-- /header -->
		<!-- panel -->
			<div id="mw-panel" class="noprint">
				<!-- logo -->
					<div id="p-logo"><a style="background-image: url(../../images/osslogo.png);" href="../../wiki.html"  title="Glavna stranica"></a></div>
				<!-- /logo -->
				
<!-- navigation -->
<div class="portal" id='p-navigation'>
	<h5>Orijentacija</h5>
	<div class="body">
				<ul>
					<li id="n-mainpage-description"><a href="../../wiki.html" title="Posjeti glavnu stranicu [z]" accesskey="z">Glavna stranica</a></li>
					<li id="n-portal"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Portal_zajednice" title="O projektu, što možete učiniti, gdje je što">Portal zajednice</a></li>
					<li id="n-currentevents"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Novosti" title="O trenutačnim događajima">Aktualno</a></li>
					<li id="n-recentchanges"><a href="./Posebno:Nedavne_promjene.html" title="Popis nedavnih promjena u wikiju. [r]" accesskey="r">Nedavne promjene</a></li>
					<li id="n-randompage"><a href="./Posebno:Slučajna_stranica.html" title="Učitaj slučajnu stranicu [x]" accesskey="x">Slučajna stranica</a></li>
					<li id="n-help"><a href="./Pomoć:Pomoć.html" title="Mjesto za pomoć suradnicima.">Pomoć</a></li>
				</ul>
			</div>
</div>

<!-- /navigation -->

<!-- SEARCH -->

<!-- /SEARCH -->

<!-- TOOLBOX -->
<div class="portal" id="p-tb">
	<h5>Traka s alatima</h5>
	<div class="body">
		<ul>
					<li id="t-whatlinkshere"><a href="http://security.foi.hr/wiki/index.php/Posebno:%C5%A0to_vodi_ovamo/OpenWRT" title="Popis svih stranica koje sadrže poveznice ovamo [j]" accesskey="j">Što vodi ovamo</a></li>
						<li id="t-recentchangeslinked"><a href="http://security.foi.hr/wiki/index.php/Posebno:Povezane_promjene/OpenWRT" title="Nedavne promjene na stranicama na koje vode ovdašnje poveznice [k]" accesskey="k">Povezane stranice</a></li>
																																										<li id="t-specialpages"><a href="./Posebno:Posebne_stranice.html" title="Popis posebnih stranica [q]" accesskey="q">Posebne stranice</a></li>
									<li id="t-print"><a href="http://security.foi.hr/wiki/index.php?title=OpenWRT&amp;printable=yes" rel="alternate" title="Verzija za ispis ove stranice [p]" accesskey="p">Verzija za ispis</a></li>
						<li id="t-permalink"><a href="http://security.foi.hr/wiki/index.php?title=OpenWRT&amp;oldid=15957" title="Trajna poveznica na ovu verziju stranice">Trajna poveznica</a></li>
						</ul>
	</div>
</div>

<!-- /TOOLBOX -->

<!-- LANGUAGES -->

<!-- /LANGUAGES -->
			</div>
		<!-- /panel -->
		<!-- footer -->
		<div id="footer">
											<ul id="footer-info">
																	<li id="footer-info-lastmod"> Datum zadnje promjene na ovoj stranici: 18:31, 20. siječnja 2013.</li>
																							<li id="footer-info-viewcount">Ova stranica je pogledana 7.007 puta.</li>
																							<li id="footer-info-copyright">Sadržaji se koriste u skladu s <a href="http://creativecommons.org/licenses/by-sa/3.0/" class="external ">Creative Commons Attribution Share Alike</a>.</li>
															</ul>
															<ul id="footer-places">
																	<li id="footer-places-privacy"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Za%C5%A1tita_privatnosti" title="SIS Wiki:Zaštita privatnosti">Zaštita privatnosti</a></li>
																							<li id="footer-places-about"><a href="./SIS_Wiki:O_projektu_SIS_Wiki.html" title="SIS Wiki:O projektu SIS Wiki">O projektu SIS Wiki</a></li>
																							<li id="footer-places-disclaimer"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:General_disclaimer" title="SIS Wiki:General disclaimer">Odricanje od odgovornosti</a></li>
															</ul>
											<ul id="footer-icons" class="noprint">
					<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="../skins/common/images/cc-by-sa.png" alt="Creative Commons Attribution Share Alike" width="88" height="31" /></a>
					</li>
					<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<!-- /footer -->
		
<script src="../load.php%3Fdebug=false&amp;lang=hr&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if ( window.mediaWiki ) {
	mediaWiki.config.set({"wgCanonicalNamespace": "", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 0, "wgPageName": "OpenWRT", "wgTitle": "OpenWRT", "wgAction": "view", "wgArticleId": 4365, "wgIsArticle": true, "wgUserName": null, "wgUserGroups": ["*"], "wgCurRevisionId": 15957, "wgCategories": [], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": []});
}
</script>
<script>if ( window.mediaWiki ) {
	mediaWiki.loader.load(["mediawiki.util", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax"]);
	mediaWiki.loader.go();
}
</script>

<script>if ( window.mediaWiki ) {
	mediaWiki.user.options.set({"ccmeonemails":0,"cols":80,"contextchars":50,"contextlines":5,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,
	"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"hr","language":"hr","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;mediaWiki.loader.state({"user.options":"ready"});
}
</script>		<!-- fixalpha -->
		<script type="text/javascript"> if ( window.isMSIE55 ) fixalpha(); </script>
		<!-- /fixalpha -->
		<!-- Served in 0.575 secs. -->			</body>
</html>
