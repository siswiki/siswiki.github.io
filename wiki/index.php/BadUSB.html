<!DOCTYPE html>
<html lang="hr" dir="ltr">
<head>
<meta charset="UTF-8" />
<title>BadUSB - SIS Wiki</title>
<meta name="generator" content="MediaWiki 1.17.0" />
<link rel="shortcut icon" href="http://security.foi.hr/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="../opensearch_desc.php" title="SIS Wiki (hr)" />
<link rel="EditURI" type="application/rsd+xml" href="../api.php%3Faction=rsd" />
<link title="Creative Commons" type="application/rdf+xml" href="http://security.foi.hr/wiki/index.php?title=BadUSB&amp;action=creativecommons" rel="meta" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-sa/3.0/" />
<link rel="alternate" type="application/atom+xml" title="SIS Wiki Atom izvor" href="../index.php%3Ftitle=Posebno:Nedavne_promjene&amp;feed=atom" />
<link rel="stylesheet" href="../load.php%3Fdebug=false&amp;lang=hr&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cskins.vector&amp;only=styles&amp;skin=vector&amp;*.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/wiki/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr ns-0 ns-subject page-BadUSB skin-vector">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<!-- content -->
		<div id="content">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<!-- firstHeading -->
			<h1 id="firstHeading" class="firstHeading">BadUSB</h1>
			<!-- /firstHeading -->
			<!-- bodyContent -->
			<div id="bodyContent">
				<!-- tagline -->
				<div id="siteSub">Izvor: SIS Wiki</div>
				<!-- /tagline -->
				<!-- subtitle -->
				<div id="contentSub"></div>
				<!-- /subtitle -->
																<!-- jumpto -->
				<div id="jump-to-nav">
					Skoči na: <a href="BadUSB.html#mw-head">orijentacija</a>,
					<a href="BadUSB.html#p-search">traži</a>
				</div>
				<!-- /jumpto -->
								<!-- bodytext -->
				<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Sadržaj</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="BadUSB.html#BadAndroid"><span class="tocnumber">1</span> <span class="toctext">BadAndroid</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="BadUSB.html#DNS_.2F_Ethernet_Spoofing"><span class="tocnumber">2</span> <span class="toctext">DNS / Ethernet Spoofing</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="BadUSB.html#Primjer:_Phishing_free_email_servisa"><span class="tocnumber">2.1</span> <span class="toctext">Primjer: Phishing free email servisa</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="BadUSB.html#BadAndroid_Ethernet_Spoofing"><span class="tocnumber">3</span> <span class="toctext">BadAndroid Ethernet Spoofing</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="BadUSB.html#Upute"><span class="tocnumber">3.1</span> <span class="toctext">Upute</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="BadUSB.html#Obja.C5.A1njenje"><span class="tocnumber">3.2</span> <span class="toctext">Obja&#353;njenje</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="BadUSB.html#Phishing_primjer:_Facebook"><span class="tocnumber">4</span> <span class="toctext">Phishing primjer: Facebook</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="BadUSB.html#Kloniranje_stranice"><span class="tocnumber">4.1</span> <span class="toctext">Kloniranje stranice</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="BadUSB.html#Postavljanje_servera"><span class="tocnumber">4.2</span> <span class="toctext">Postavljanje servera</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="BadUSB.html#BadAndroid_Keyboard_Emulator"><span class="tocnumber">5</span> <span class="toctext">BadAndroid Keyboard Emulator</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="BadUSB.html#Flash-anje_kernela"><span class="tocnumber">5.1</span> <span class="toctext">Flash-anje kernela</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="BadUSB.html#Emuliranje_tipkovnice"><span class="tocnumber">5.2</span> <span class="toctext">Emuliranje tipkovnice</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="BadUSB.html#Android_aplikacija_za_slanje_tipki"><span class="tocnumber">5.3</span> <span class="toctext">Android aplikacija za slanje tipki</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="BadUSB.html#Dobivanje_root_pristupa_ure.C4.91aju"><span class="tocnumber">6</span> <span class="toctext">Dobivanje root pristupa uređaju</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="BadUSB.html#Samsung_Google_Nexus_S"><span class="tocnumber">6.1</span> <span class="toctext">Samsung Google Nexus S</span></a>
<ul>
<li class="toclevel-3 tocsection-16"><a href="BadUSB.html#Otklju.C4.8Davanje_bootloader-a"><span class="tocnumber">6.1.1</span> <span class="toctext">Otključavanje bootloader-a</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="BadUSB.html#Instaliranje_Custom_Recovery"><span class="tocnumber">6.1.2</span> <span class="toctext">Instaliranje Custom Recovery</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="BadUSB.html#Root-anje_ure.C4.91aja"><span class="tocnumber">6.1.3</span> <span class="toctext">Root-anje uređaja</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-19"><a href="BadUSB.html#Asus_Google_Nexus_7"><span class="tocnumber">6.2</span> <span class="toctext">Asus Google Nexus 7</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-20"><a href="BadUSB.html#BadArduino_Keyboard_Emulator"><span class="tocnumber">7</span> <span class="toctext">BadArduino Keyboard Emulator</span></a>
<ul>
<li class="toclevel-2 tocsection-21"><a href="BadUSB.html#Arduino_Leonardo"><span class="tocnumber">7.1</span> <span class="toctext">Arduino Leonardo</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="BadUSB.html#Instalacija_HID_keyboard_funkcija"><span class="tocnumber">7.2</span> <span class="toctext">Instalacija HID keyboard funkcija</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="BadUSB.html#Keyboard_Library"><span class="tocnumber">7.3</span> <span class="toctext">Keyboard Library</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="BadUSB.html#Primjer_manipulacije_hosts_datotekom_u_Windows_7_operacijskom_sustabvu"><span class="tocnumber">7.4</span> <span class="toctext">Primjer manipulacije hosts datotekom u Windows 7 operacijskom sustabvu</span></a>
<ul>
<li class="toclevel-3 tocsection-25"><a href="BadUSB.html#Primjer_programa"><span class="tocnumber">7.4.1</span> <span class="toctext">Primjer programa</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr></table>
<h1> <span class="mw-headline" id="BadAndroid"> BadAndroid </span></h1>
<p>Andro Krezić, Zoran Antolović, Roko Labrović
</p><p><br />
</p>
<h1> <span class="mw-headline" id="DNS_.2F_Ethernet_Spoofing"> DNS / Ethernet Spoofing </span></h1>
<p><a href="http://computer.howstuffworks.com/dns.htm" class="external text" rel="nofollow">DNS</a> je omogućio ljudima bezbrižno surfanje bez potrebe za pamćenjem IP adresa koje se često mogu i promijeniti. Umjesto da pamtimo adresu <a href="http://31.13.93.3" class="external text" rel="nofollow">31.13.93.3</a> jednostavnije koristimo samo <a href="http://facebook.com" class="external text" rel="nofollow">facebook.com</a>. Ali kako onda znamo da facebook.com pokazuje upravo na ispravan IP? Vjerujemo da će na&#353; zahtjev za &quot;resolve&quot;-anjem DNS-a u IP adresu proći bez problema te da ćemo dobiti ispravne podatke. Sigurnosna prijetnja koju ovdje primjećujemo jest mogućnost namjerne promjene DNS odgovora na dva načina:
</p>
<ul><li> Promjena DNS poruke odgovora u nepostojeći IP - Denial of Service attack
</li><li> Promjena DNS poruke odgovora u postojeći IP i preusmjeravanje na tzv. &quot;Phishing&quot; stranicu
</li></ul>
<p><br />
Dok je prvi od dva napada na prvi pogled bezazlen, drugi postaje prava prijetnja ukoliko se ne otkrije na vrijeme. Napad je moguće izvesti na nekoliko načina:
</p>
<ul><li> Usmjeravanjem korisničkih postavki na vlastiti DNS server
</li><li> Pode&#353;avanje DNS zapisa na <a href="https://www.youtube.com/watch?v=zDEx7TxCm1s" class="external text" rel="nofollow">routeru</a> (npr. u open WiFi mrežama)
</li><li> Izmjenom <a href="http://en.wikipedia.org/wiki/Hosts_%28file%29" class="external text" rel="nofollow">hosts</a> datoteka
</li></ul>
<h2> <span class="mw-headline" id="Primjer:_Phishing_free_email_servisa"> Primjer: Phishing free email servisa </span></h2>
<p>Uzmimo za primjer servis freemail.net.hr koji ne koristi sigurni protokol https te ne osigurava potvrdu identiteta stranice koja je posjećena. Žrtva napada može u preglednik upisati <a href="http://freemail.net.hr" class="external free" rel="nofollow">http://freemail.net.hr</a> i u nadi da će joj se prikazati originalna stranica email servisa. Napadač je pripremio lažnu stranicu koja se izgledom ne razlikuje od originalne te je podesio preusmjeravanje/izmjenu DNS poruka. Stranica koju žrtva otvori na spomenutom URL-u nije originalna već identična kopija koju je gotovo nemoguće primjetiti. Ukoliko žrtva u poku&#353;aju prijave unese svoje korisničke podatke, vrlo je vjerojatno da su podaci dostupni napadaču a da žrtva toga nije ni svjesna.
</p>
<h1> <span class="mw-headline" id="BadAndroid_Ethernet_Spoofing"> BadAndroid Ethernet Spoofing </span></h1>
<h2> <span class="mw-headline" id="Upute"> Upute </span></h2>
<p>Projekt dostupan na <a href="https://github.com/tst-zdouglas/BadAndroid" class="external text" rel="nofollow">BadAndroid</a> omogućuje napad s Android uređaja koji će emulirati Ethernet karticu na priključenom računalu te na taj način napraviti napad na DNS zapise. Za napad je potrebno:
</p>
<ul><li> <a href="BadUSB.html#Dobivanje_root_pristupa_ure.C4.91aju"> Root-ati</a> uređaj - kako bismo imali potpuni pristup uređaju, osigurajte povezanost na Internet
</li><li> Instalirajte &quot;busybox&quot; (npr. kori&#353;tenjem stericson busybox installer)
</li><li> Keirajte hosts datoteku s parovima IP-adresa i domena koje želite preusmjeriti na vlastite servere npr:<br /> 	1.2.3.4 paypal.com www.paypal.com
</li><li> Kopirajte skripte i hosts datoteku na svoj uređaj:<br /> 	adb push bad.sh /data/local/tmp/<br /> 	adb push cleanup.sh /data/local/tmp/<br /> 	adb push hosts /data/local/tmp/
</li><li> Instalirajte i pokrenite aplikaciju za kori&#353;tenje terminala (npr. jackpal/Android-Terminal-Emulator) u osigurajte si administratorski pristup: /system/xbin/su
</li><li> Pokrenite skriptu bad.sh: sh /data/local/tmp/bad.sh
</li><li> Povežite uređaj s Windows ili Linux računalom koje želite napasti. Web promet sada bi trebao ići kroz va&#353; uređaj s parcijalnom redirekcijom domena koje ste naveli u hosts datoteci.
</li><li> Kada ste zavr&#353;ili s napadom, ponovno pokrenite uređaj ili pokrenite skriptu za či&#353;ćenje: cleanup.sh
</li></ul>
<h2> <span class="mw-headline" id="Obja.C5.A1njenje"> Obja&#353;njenje </span></h2>
<p>Sva logika za napad nalazi se u skripti bad.sh. Analizom iste lako je utvrditi temelje za ovaj napad:
</p>
<ul><li> Aplikacija ima nekoliko <i>dependancy</i>-a koji se provjeravaju na vrhu skripte:
<ul><li> busybox
</li><li> <a href="http://www.thekelleys.org.uk/dnsmasq/doc.html" class="external text" rel="nofollow">dnsmasq</a> - Mrežna infrastruktura za manje mreže (DNS, dhcp ...)
</li><li> RNDIS - Remote Network Driver Interface Specification Microsoftov protokol za emulaciju Ethernet uređaja (interfacea)
</li><li> iptables
</li></ul>
</li><li> Zatim skripta blokira zadano prepoznavanje uređaja povezanog USB-om kako bi se mogla emulirati Ethernet kartica
</li><li> Omogućuju se potrebni protokoli i radi se njihovo testiranje te se čeka na učitavanje interfacea
</li><li> Pode&#353;ava se interface firewall i proslijeđivanje paketa
</li><li> Pokreće se dnsmasq servis s podacima iz hosts datoteke
</li></ul>
<h1> <span class="mw-headline" id="Phishing_primjer:_Facebook"> Phishing primjer: Facebook </span></h1>
<p>U nastavku je prikazana jednostavna phishing stranica koja simulira početnu stranicu Facebook dru&#353;tvene mreže. Izgled stranice vidljiv je na <a href="http://i.snag.gy/Gq58f.jpg" class="external text" rel="nofollow">slici</a>.
</p><p>Napredni korisnik odmah može primjetiti kako se radi o nesigurnoj vezi (http umjesto https) i to mu može biti sumnjivo. Nažalost mnogo je vi&#353;e korisnika koji ne primjećuju i ne razumiju sigurnost na internetu. Aplikacija će prihvatiti korisnički unos i pohraniti ga u datoteku te napadaču omogućiti pristup korisničkom imenu (emailu) i lozinku koju žrtva koristi za Facebook. Nakon toga napadač jednostavno može žrtvi onemogućiti kori&#353;tenje Facebook servisa, ali uz činjenicu da korisnici često koriste iste podatke, opasnost ovog napada eksponencijalno raste.
</p>
<h2> <span class="mw-headline" id="Kloniranje_stranice"> Kloniranje stranice </span></h2>
<p>Izrada identične stranice vrlo je jednostavna budući da današnji preglednici prilikom pohrane stranice na disk pohranjuju i sve vezane dokumente (slike, css i js file-ove itd.). Dovoljno je odabrati izbornik File -&gt; Save i pohraniti stranicu na disk. Pohranjuje se jedna html datoteka i jedan folder unutar kojeg se nalazi vezani materijal. Stranicu je moguće doraditi po izboru (dodati i ukloniti elemente, podesiti ponašanje formi i sl.).
</p>
<h2> <span class="mw-headline" id="Postavljanje_servera"> Postavljanje servera </span></h2>
<p>Server je potrebno postaviti s uputom o domeni koju će posluživati. U ovom slučaju to je domena facebook.com stoga apache virtual host config file izgleda ovako:
</p><p><code>
&lt;VirtualHost *:80&gt;<br />
	ServerAdmin webmaster@localhost<br />
	ServerName facebook.com<br />
	ServerAlias www.facebook.com<br />
<br />
	DocumentRoot /var/www/facebook<br />
	ErrorLog ${APACHE_LOG_DIR}/error.log<br />
	CustomLog ${APACHE_LOG_DIR}/access.log combined<br />
&lt;/VirtualHost&gt;<br />
</code><br />
</p>
<h1> <span class="mw-headline" id="BadAndroid_Keyboard_Emulator"> BadAndroid Keyboard Emulator </span></h1>
<p>BadAndroid Keyboard Emulator nam omogućava emulaciju standardne USB tipkovnice pomoću Android uređaja. Računalo će prepoznati Android kao tipkovnicu i primati inpute koji su definirani u skriptama koje odaberemo na uređaju. Kako bi <i>natjerali</i> Android da se predstavlja kao tipkovnica, potrebno je instalirati <i>custom</i> kernel. <a href="https://github.com/pelya/android-keyboard-gadget/tree/master/nexus7-2012-wifi-grouper" class="external text" rel="nofollow">Preuzimanje potrebnog kernela</a> (<b>Upozorenje:</b> ovaj kernel je namijenjen samo za Asus Google Nexus 7 (2012) sa 5.0.x verzijom Android-a, za instalaciju na ostale uređaje provjerite <a href="https://github.com/pelya/android-keyboard-gadget" class="external text" rel="nofollow">GitHub repozitorij</a>).
</p>
<h2> <span class="mw-headline" id="Flash-anje_kernela"> Flash-anje kernela </span></h2>
<p>Za flash-anje custom kernela, potrebno je imati root pristup uređaju i instalirati <i>ADB</i> i <i>Fastboot</i>. <a href="BadUSB.html#Asus_Google_Nexus_7"> Upute za root</a>, <a href="http://forum.xda-developers.com/showthread.php?t=2588979," class="external text" rel="nofollow">ADB i Fastboot instalacija</a>
</p><p>Nakon root-anja uređaja:
</p>
<ul><li> Upaliti uređaj u bootloader mode kombinacijom tipki volume up + power
</li><li> Spojiti uređaj sa računalom pomoću USB kabela
</li><li> Otvoriti direktorij u kojem se nalaze ADB i Fastboot datoteke za root
</li><li> Kopirati boot.img (kernel) u prethodno navedeni direktorij
</li><li> Otvoriti isti folder unutar Command Prompt-a (kratica: shift + desni klik na folder i kliknuti na „Open command prompt here“
</li><li> Da bismo provjerili dali je uređaj prepoznat, upišemo:
</li><li> <code>fastboot devices</code>
</li><li> Ako je uređaj prepoznat, flash-amo kernel:
</li><li> <code>fastboot flash boot boot.img</code>
</li><li> Nakon flash-anja ponovno pokrenemo uređaj:
</li><li> <code>fastboot reboot</code>
</li></ul>
<h2> <span class="mw-headline" id="Emuliranje_tipkovnice"> Emuliranje tipkovnice </span></h2>
<p>Da bismo mogli započeti koristiti Android uređaj kao tipkovnicu, potrebno je prebaciti <a href="https://github.com/pelya/android-keyboard-gadget/blob/master/hid-gadget-test/hid-gadget-test" class="external text" rel="nofollow"><i>hid-gadget-test</i></a> na uređaj:
</p>
<ul><li> Otvoriti direktorij u kojem se nalaze ADB i Fastboot datoteke za root
</li><li> Kopirati datoteku <i>hid-gadget-test</i> u prethodno navedeni folder
</li><li> Otvoriti isti folder unutar Command Prompt-a (kratica: shift + desni klik na folder i kliknuti na „Open command prompt here“
</li><li> Upisati:
</li><li> <code>adb push hid-gadget-test /data/local/tmp</code>
</li><li> Sada se <i>hid-gadget-test</i> nalazi na uređaju unutar /data/local/tmp foldera
</li></ul>
<p>Nakon toga je potrebno preuzeti i instalirati <a href="https://play.google.com/store/apps/details?id=jackpal.androidterm&amp;hl=hr" class="external text" rel="nofollow">Android Terminal Emulator</a> sa Play Store, otvoriti ga i upisati:
</p>
<ul><li> Da bismo dobili root pristup:
</li><li> <code>su</code>
</li><li> Izmijeniti prava pristupa gidg0 i hidg1 u 666, kako bi svi imali pravo čitanja i pisanja:
</li><li> <code>chmod 666 /dev/hidg0 /dev/hidg1</code>
</li><li> Nakon toga odemo u direktorij u kojem se nalazi <i>hid-gadget-test</i>:
</li><li> <code>cd /data/local/tmp</code>
</li><li> I sada možemo simulirati pritisak tipki na tipkovnici pomoću naredbe (za slovo "a"):
</li><li> <code>echo a | ./hid-gadget-test /dev/hidg0 keyboard</code>
</li><li> Kombinacije tipki, npr. <b>ctrl + shift + esc</b> dobijamo na način:
</li><li> <code>left-ctrl left-shift esc | ./hid-gadget-test /dev/hidg0 keyboard</code>
</li></ul>
<p>Potpuna lista podržanih tipki se nalazi na <a href="https://github.com/pelya/android-keyboard-gadget/blob/master/hid-gadget-test/jni/hid-gadget-test.c#L33" class="external text" rel="nofollow">GitHub-u</a>.
</p>
<h2> <span class="mw-headline" id="Android_aplikacija_za_slanje_tipki"> Android aplikacija za slanje tipki </span></h2>
<p>U svrhu ovog projekta napravljena je Android aplikacija koja olakšava slanje tipki na računalo. Unutar aplikacije se nalazi klasa koja čita skripte koje mi zadamo i prevodi ih u <i>jezik</i> potreban za simulaciju pritiska tipke, kako nebi svaki put trebali upisivati <code>echo a | ./hid-gadget-test /dev/hidg0 keyboard</code> za svako slovo.
</p><p><a href="http://security.foi.hr/wiki/index.php/Datoteka:Screenshot_2015-01-18-18-23-27.png" class="image"><img alt="Screenshot 2015-01-18-18-23-27.png" src="../images/thumb/d/dd/Screenshot_2015-01-18-18-23-27.png/400px-Screenshot_2015-01-18-18-23-27.png" width="400" height="640" /></a>
</p><p>Unutar aplikacije je implementiran <i>file explorer</i> kojim možemo odabrati skriptu koju postavimo na uređaj, a primjer skripte koja otvara <i>notepad</i> i ispiše "hello world" u njemu izgleda ovako:
</p><p><code>
 
#CMD echo left-meta r
 
</p><p> 
#BASH sleep 1;
 
</p><p>notepad
</p><p> 
#BASH sleep 1;
 
</p><p> 
#CMD echo enter
 
</p><p> 
#BASH sleep 1;
 
</p><p>hello world
</p><p>
#BASH sleep 1;
 
</code>
</p><p>Kako bismo lakše pisali i razumjeli skripte, napravili smo klasu koja sadrži metode koje provjeravaju početak svake linije. Ako linija počinje sa:
</p>
<ul><li> <b>#BASH</b> - naredba za Bash shell, u ovom primjeru se koristi <i>sleep 1</i> jer trebamo čekati 1 sekundu da se otvori program
</li><li> <b>#CMD</b> - naredba kojom šaljemo samo jednu tipku
</li><li> sami tekst znači da se šalje cijeli tekst, slovo po slovo
</li></ul>
<p>Ova skripta prvo otvara "Run" prozor u Windowsu pomoću <i>Windows</i> tipke + R, zatim unutra upiše "notepad" i klikne enter. Nakon toga se čeka 1 sekunda da bi se otvorio notepad i unutra se upiše "hello world".
</p><p>Aplikacija pokreće skriptu pritiskom na tipku "Run", ali također je omogućeno da se zadnja skripta sama pokrene prilikom spajanja uređaja na računalo. To je postignuto pomoću Broadcast Receivera na Androidu koji je podešen tako da čeka promjenu stanja iz "not charging" u "charging".
</p>
<h1> <span class="mw-headline" id="Dobivanje_root_pristupa_ure.C4.91aju"> Dobivanje root pristupa uređaju </span></h1>
<p>Za ovaj projekt su korištena dva Android uređaja koje je bilo potrebno root-at, odnosno, dobiti potpuni pristup uređaju. Uređaji su Samsung Google Nexus S (Android 4.1.2) i Asus Google Nexus 7 (Android 5.0.2).
</p>
<h2> <span class="mw-headline" id="Samsung_Google_Nexus_S"> Samsung Google Nexus S </span></h2>
<h3> <span class="mw-headline" id="Otklju.C4.8Davanje_bootloader-a"> Otključavanje bootloader-a </span></h3>
<p>Prije samog root-anja, potrebno je otključati bootloader. Bootloader služi za pokretanje kernela i operacijskog sustava, a obično je zaključan na uređajima od strane proizvođača uređaja. Zaključani bootloader osigurava da će korisnik koristiti proizvođačev ROM (firmware uređaja).
</p><p><a href="https://docs.google.com/file/d/0B46yaD9nFJdcUFV4RkJ2LVZPZmc/edit" class="external text" rel="nofollow">Potrebne potrebne datoteke za root-anje</a>
</p><p>Prije nego što se krene sa otključavanjem, potrebno je instalirati <a href="http://androidxda.com/download-samsung-usb-drivers" class="external text" rel="nofollow">Samsung drivere</a> ako već nemamo, kako bi uopće mogli komunicirati sa uređajem pomoću računala i zatim uključiti USB debugging na uređaju (Settings -&gt; Developer Settings -&gt; USB Debugging). 
Sljedeće korake treba poduzeti kako bi se otključao bootloader na Nexus S uređaju (NAPOMENA: otključavanje bootloader-a briše sve podatke sa mobitela – napraviti backup):
</p>
<ul><li> Upaliti uređaj u bootloader mode kombinacijom tipki <b>volume up + power</b>
</li><li> Spojiti uređaj sa računalom pomoću USB kabela
</li><li> Otvoriti folder „NSFiles“ pomoću Command Prompt-a (kratica: <b>shift + desni klik</b> na folder i kliknuti na „Open command prompt here“
</li><li> Upisati u CMD:
</li><li> <code>fastboot oem unlock</code>
</li><li> Koristeći tipki volume up i volume down označiti „Yes“ i potvrditi
</li><li> Nakon otključavanja označiti „Reboot“  i potvrditi
</li></ul>
<h3> <span class="mw-headline" id="Instaliranje_Custom_Recovery"> Instaliranje Custom Recovery </span></h3>
<p>"Custom Recovery" je potrebno instalirati kako bi se na sustav uređaja mogao instalirati neslužbeni (custom) software, a on nam je potreban za instalaciju root programa. Postoje dva popularna Custom Recovery-ja za Android: ClockworkMod (<b>CWM</b>) i TeamWin Recovery Project (TWRP<b>Podebljani tekst</b>). Za ovaj projekt je korišten CWM ali i sa TWRP nebi trebalo biti razlike.
</p>
<ul><li> Upaliti uređaj u bootloader mode kombinacijom tipki volume up + power
</li><li> Spojiti uređaj sa računalom pomoću USB kabela
</li><li> Otvoriti folder „NSFiles“ pomoću Command Prompt-a (kratica: shift + desni klik na folder i kliknuti na „Open command prompt here“
</li><li> Upisati u CMD:
</li><li> <code>fastboot flash recovery CWM-T.img</code>
</li><li> Nakon instalacije treba mode označiti „Recovery“ i potvrditi
</li></ul>
<h3> <span class="mw-headline" id="Root-anje_ure.C4.91aja"> Root-anje uređaja </span></h3>
<ul><li> <a href="http://download.chainfire.eu/supersu" class="external text" rel="nofollow">Preuzeti najnoviji SuperSU paket</a>
</li><li> Unutar Recovery Mode kliknuti „Mount and storage“ -&gt; „Mount USB storage“
</li><li> Sada imamo pristup memoriji uređaja na računalu i prebacimo SuperSU paket na uređaj
</li><li> Kliknuti na tipku „Unmount“
</li><li> Instalirati preuzeti SuperSU paket na uređaj („install zip from sdcard“ -&gt; „choose zip from sdcard“ -&gt; find your SuperSU zip file -&gt; „flash“)
</li><li> Nakon flash-anja (instalacije) kliknuti na „reboot system now“
</li></ul>
<h2> <span class="mw-headline" id="Asus_Google_Nexus_7"> Asus Google Nexus 7 </span></h2>
<p><a href="http://autoroot.chainfire.eu/#fastboot" class="external text" rel="nofollow">Preuzimanje skripte i potrebnih datoteka</a>. Za ovaj projekt je korišten Asus Google Nexus 7 naziva <i>nakasi</i>, a ime uređaja je <i>grouper</i> i Android verzija 5.0.2.
Dobivanje root pristupa na Nexus 7 uređaju je nešto jednostavnije jer postoji skripta koja napravi sve za nas, potrebno ju je samo pokrenuti. Jedini preduvjet je da su driveri uređaja instalirani na računalu (<a href="http://www.asus.com/Tablets_Mobile/Nexus_7/HelpDesk_Download/" class="external text" rel="nofollow">download driver-a</a>). Važno je napomenuti da ova skripta također vrši otključavanje bootloader-a i da će sve datoteke na uređaju biti izbrisane, tako da je pametno napraviti backup prije pokretanja ukoliko uređaj sadrži neke važne podatke.
</p><p>Nakon što imamo sve potrebne uvjete:
</p>
<ul><li> Upaliti uređaj u bootloader mode kombinacijom tipki <b>volume down + power</b>
</li><li> Pokrenuti skriptu ovisno o operacijskom sustavu računala
</li><li> Nakon root-anja označiti „Reboot“  i potvrditi
</li></ul>
<p><br />
</p>
<h1> <span class="mw-headline" id="BadArduino_Keyboard_Emulator"> BadArduino Keyboard Emulator </span></h1>
<h2> <span class="mw-headline" id="Arduino_Leonardo"> Arduino Leonardo </span></h2>
<p>Arduino Leonardo je mikrokontrolerska ploča sa ATmega32u4 čipom koja ima 20 digitalnih ulazno/izlaznih pinova (7 PWM izlaza i 12 analohnih ulaza), kristalni oscilator od 16MHz, mikro USB konektor, priključak za napajanje, ICSP konektor i reset taster. Sadrži sve što je potrebno za podršku mikrokontroleru. Ono što Arduina Leonarda razlikuje od ostalih ploča jest ugračen ATmega32u4 čip koji ima ugrađenu USB komunikaciju. Uprabo to mu omogućava da se ploča Leonardo računalu predstavi kao miš, tipkovnica ili dodatni serijski port ili nešto drugo. Upravo mogućnost predstavljanja ove ploče kao tipkovnica na računalu koristit će se za prikaz BadUSB ranjivosti.
</p><p><br />
</p>
<div class="thumb tleft"><div class="thumbinner" style="width:402px;"><a href="http://security.foi.hr/wiki/index.php/Datoteka:ArduinoLeonardoFront_2.jpg" class="image"><img alt="" src="../images/thumb/4/46/ArduinoLeonardoFront_2.jpg/400px-ArduinoLeonardoFront_2.jpg" width="400" height="263" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="http://security.foi.hr/wiki/index.php/Datoteka:ArduinoLeonardoFront_2.jpg" class="internal" title="Povećaj"><img src="../skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div>Ploča Arduino Leonardo</div></div></div>
<p><br />
</p><p><br />
</p><p><br />
</p><p><br />
</p><p><br />
</p><p><br />
</p><p><br />
</p><p><br />
</p><p><br />
</p><p><br />
</p><p><br />
</p><p><br />
</p><p><br />
</p>
<h2> <span class="mw-headline" id="Instalacija_HID_keyboard_funkcija"> Instalacija HID keyboard funkcija </span></h2>
<p>Kako bi omogućili korištenje Leonarda potrebno je napraviti određene izmjene.
</p><p>1. Potrebno je skinuti sljedeće <a href="https://github.com/NicoHood/HID" class="external text" rel="nofollow">biblioteke</a>
</p><p>2. Učitati biblioteke unutar Arduino IDE-a (Import library: In Arduino IDE -&gt; Sketch -&gt; Import Library -&gt; Add library -&gt; Path to HID-master)
</p><p>3. Zamjeniti sve datoteke s ekstenzijom .h i .cpp u direktoriju C:\Program Files (x86)\Arduino\hardware\arduino\cores\arduino sa datotekama uz github repozitorija kojeg smo skinuli u koraku 1. (HID-master)
</p><p><br />
</p>
<h2> <span class="mw-headline" id="Keyboard_Library"> Keyboard Library </span></h2>
<p>Sad kad smo omogućili Arduino korištenje keyboard library-a ukratko će biti opisane najvažnije funkcije. Bitno je napomenuti upozorenje s radom ove biblioteke. Ukoliko ona stalno radi može doći do poteškoća u programiranju ploče. Funkcije poput Keyboard.print() poslat će tipke na računalo i bilo bi ih poželjno pozvati samo u trenutku kada vi to hoćete. Zbog toga preporuča se sustav kontrole za uključivanje na tu funkciju poput fizičkog prekidača.
</p>
<ul><li><b>Keyboard.begin()</b> - započinje emuliranje spojene tipkovnice na računalo.
</li><li><b>Keyboard.end()</b> - završava emuliranje spojene tipkovnice na računalo.
</li><li><b>Keyboard.press()</b> - simulira pritisak tipke na tipkovnici.
</li><li><b>Keyboard.print()</b> - simulira keystroke na tipkovnici.
</li><li><b>Keyboard.println()</b> - simulira keystroke na tipkovnici, ali u novom redu
</li><li><b>Keyboard.release()</b> - Otpušta simuliranje pritiska tipke na tipkovnici.
</li><li><b>Keyboard.releaseAll()</b> - Otipšta simuliranje pritiska svih tipki.
</li><li><b>Keyboard.write()</b> - Simulira pritisak i otpuštanje tipke na tipkovnici.
</li></ul>
<h2> <span class="mw-headline" id="Primjer_manipulacije_hosts_datotekom_u_Windows_7_operacijskom_sustabvu"> Primjer manipulacije hosts datotekom u Windows 7 operacijskom sustabvu </span></h2>
<p>Kako bi se pokazalo kako to sve funkcijonira za primjer će se uzeti manipulacija hosts datotekom unutar Windows7 opracijskog sustava putem cmd komande linije. Kako bi izbjegli poteškoće tjekom programiranja tipkovnice na Arduino ćemo postaviti prekidač i pritiskom na prekidač pokrenuti funkcijonalnost koju smo isprogramirali.
</p><p><br />
<a href="http://security.foi.hr/wiki/index.php/Datoteka:KeyboardMessage3_bb.png" class="image"><img alt="KeyboardMessage3 bb.png" src="../images/thumb/a/ae/KeyboardMessage3_bb.png/400px-KeyboardMessage3_bb.png" width="400" height="324" /></a>  
<a href="http://security.foi.hr/wiki/index.php/Datoteka:KeyboardMessage3_schem.png" class="image"><img alt="KeyboardMessage3 schem.png" src="../images/thumb/5/55/KeyboardMessage3_schem.png/400px-KeyboardMessage3_schem.png" width="400" height="423" /></a>
</p><p><br />
</p>
<h3> <span class="mw-headline" id="Primjer_programa"> Primjer programa </span></h3>
<p><a href="http://security.foi.hr/wiki/index.php/Datoteka:Program.PNG" class="image"><img alt="Program.PNG" src="../images/thumb/4/46/Program.PNG/700px-Program.PNG" width="700" height="762" /></a>
</p>
<!-- 
NewPP limit report
Preprocessor node count: 152/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key sisds:pcache:idhash:7967-0!*!0!!hr!2!edit=0 and timestamp 20190203204257 -->
<div class="printfooter">
Dobavljeno iz "<a href="BadUSB.html">http://security.foi.hr/wiki/index.php/BadUSB</a>"</div>
				<!-- /bodytext -->
								<!-- catlinks -->
				<div id='catlinks' class='catlinks catlinks-allhidden'></div>				<!-- /catlinks -->
												<div class="visualClear"></div>
			</div>
			<!-- /bodyContent -->
		</div>
		<!-- /content -->
		<!-- header -->
		<div id="mw-head" class="noprint">
			
<!-- 0 -->
<div id="p-personal" class="">
	<h5>Osobni alati</h5>
	<ul>
					<li  id="pt-login"><a href="http://security.foi.hr/wiki/index.php?title=Posebno:Prijava&amp;returnto=BadUSB" title="Predlažemo Vam da se prijavite, ali nije obvezno. [o]" accesskey="o">Prijavi se</a></li>
			</ul>
</div>

<!-- /0 -->
			<div id="left-navigation">
				
<!-- 0 -->
<div id="p-namespaces" class="vectorTabs">
	<h5>Imenski prostori</h5>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="BadUSB.html"  title="Pogledaj sadržaj [c]" accesskey="c">Članak</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="http://security.foi.hr/wiki/index.php?title=Razgovor:BadUSB&amp;action=edit&amp;redlink=1"  title="Razgovor o stranici [t]" accesskey="t">Razgovor</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-variants" class="vectorMenu emptyPortlet">
		<h5><span>Inačice</span><a href="BadUSB.html#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->
			</div>
			<div id="right-navigation">
				
<!-- 0 -->
<div id="p-views" class="vectorTabs">
	<h5>Pogledi</h5>
	<ul>
					<li id="ca-view" class="selected"><span><a href="BadUSB.html" >Čitaj</a></span></li>
					<li id="ca-viewsource"><span><a href="http://security.foi.hr/wiki/index.php?title=BadUSB&amp;action=edit"  title="Ova stranica je zaštićena. Možete pogledati izvorni kod. [e]" accesskey="e">Vidi izvor</a></span></li>
					<li id="ca-history" class="collapsible "><span><a href="http://security.foi.hr/wiki/index.php?title=BadUSB&amp;action=history"  title="Ranije izmjene na ovoj stranici. [h]" accesskey="h">Vidi stare izmjene</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-cactions" class="vectorMenu emptyPortlet">
	<h5><span>Radnje</span><a href="BadUSB.html#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->

<!-- 2 -->
<div id="p-search">
	<h5><label for="searchInput">Traži</label></h5>
	<form action="http://security.foi.hr/wiki/index.php" id="searchform">
		<input type='hidden' name="title" value="Posebno:Traži"/>
				<input id="searchInput" name="search" type="text"  title="Pretraži ovaj wiki [f]" accesskey="f"  value="" />
		<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Kreni" title="Idi na stranicu s ovim imenom ako ona postoji" />
		<input type="submit" name="fulltext" class="searchButton" id="mw-searchButton" value="Traži" title="Traži ovaj tekst na svim stranicama" />
			</form>
</div>

<!-- /2 -->
			</div>
		</div>
		<!-- /header -->
		<!-- panel -->
			<div id="mw-panel" class="noprint">
				<!-- logo -->
					<div id="p-logo"><a style="background-image: url(../../images/osslogo.png);" href="../../wiki.html"  title="Glavna stranica"></a></div>
				<!-- /logo -->
				
<!-- navigation -->
<div class="portal" id='p-navigation'>
	<h5>Orijentacija</h5>
	<div class="body">
				<ul>
					<li id="n-mainpage-description"><a href="../../wiki.html" title="Posjeti glavnu stranicu [z]" accesskey="z">Glavna stranica</a></li>
					<li id="n-portal"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Portal_zajednice" title="O projektu, što možete učiniti, gdje je što">Portal zajednice</a></li>
					<li id="n-currentevents"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Novosti" title="O trenutačnim događajima">Aktualno</a></li>
					<li id="n-recentchanges"><a href="./Posebno:Nedavne_promjene.html" title="Popis nedavnih promjena u wikiju. [r]" accesskey="r">Nedavne promjene</a></li>
					<li id="n-randompage"><a href="./Posebno:Slučajna_stranica.html" title="Učitaj slučajnu stranicu [x]" accesskey="x">Slučajna stranica</a></li>
					<li id="n-help"><a href="./Pomoć:Pomoć.html" title="Mjesto za pomoć suradnicima.">Pomoć</a></li>
				</ul>
			</div>
</div>

<!-- /navigation -->

<!-- SEARCH -->

<!-- /SEARCH -->

<!-- TOOLBOX -->
<div class="portal" id="p-tb">
	<h5>Traka s alatima</h5>
	<div class="body">
		<ul>
					<li id="t-whatlinkshere"><a href="http://security.foi.hr/wiki/index.php/Posebno:%C5%A0to_vodi_ovamo/BadUSB" title="Popis svih stranica koje sadrže poveznice ovamo [j]" accesskey="j">Što vodi ovamo</a></li>
						<li id="t-recentchangeslinked"><a href="http://security.foi.hr/wiki/index.php/Posebno:Povezane_promjene/BadUSB" title="Nedavne promjene na stranicama na koje vode ovdašnje poveznice [k]" accesskey="k">Povezane stranice</a></li>
																																										<li id="t-specialpages"><a href="./Posebno:Posebne_stranice.html" title="Popis posebnih stranica [q]" accesskey="q">Posebne stranice</a></li>
									<li id="t-print"><a href="http://security.foi.hr/wiki/index.php?title=BadUSB&amp;printable=yes" rel="alternate" title="Verzija za ispis ove stranice [p]" accesskey="p">Verzija za ispis</a></li>
						<li id="t-permalink"><a href="http://security.foi.hr/wiki/index.php?title=BadUSB&amp;oldid=32825" title="Trajna poveznica na ovu verziju stranice">Trajna poveznica</a></li>
						</ul>
	</div>
</div>

<!-- /TOOLBOX -->

<!-- LANGUAGES -->

<!-- /LANGUAGES -->
			</div>
		<!-- /panel -->
		<!-- footer -->
		<div id="footer">
											<ul id="footer-info">
																	<li id="footer-info-lastmod"> Datum zadnje promjene na ovoj stranici: 22:53, 19. siječnja 2015.</li>
																							<li id="footer-info-viewcount">Ova stranica je pogledana 2.825 puta.</li>
																							<li id="footer-info-copyright">Sadržaji se koriste u skladu s <a href="http://creativecommons.org/licenses/by-sa/3.0/" class="external ">Creative Commons Attribution Share Alike</a>.</li>
															</ul>
															<ul id="footer-places">
																	<li id="footer-places-privacy"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Za%C5%A1tita_privatnosti" title="SIS Wiki:Zaštita privatnosti">Zaštita privatnosti</a></li>
																							<li id="footer-places-about"><a href="./SIS_Wiki:O_projektu_SIS_Wiki.html" title="SIS Wiki:O projektu SIS Wiki">O projektu SIS Wiki</a></li>
																							<li id="footer-places-disclaimer"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:General_disclaimer" title="SIS Wiki:General disclaimer">Odricanje od odgovornosti</a></li>
															</ul>
											<ul id="footer-icons" class="noprint">
					<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="../skins/common/images/cc-by-sa.png" alt="Creative Commons Attribution Share Alike" width="88" height="31" /></a>
					</li>
					<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<!-- /footer -->
		
<script src="../load.php%3Fdebug=false&amp;lang=hr&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if ( window.mediaWiki ) {
	mediaWiki.config.set({"wgCanonicalNamespace": "", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 0, "wgPageName": "BadUSB", "wgTitle": "BadUSB", "wgAction": "view", "wgArticleId": 7967, "wgIsArticle": true, "wgUserName": null, "wgUserGroups": ["*"], "wgCurRevisionId": 32825, "wgCategories": [], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": []});
}
</script>
<script>if ( window.mediaWiki ) {
	mediaWiki.loader.load(["mediawiki.util", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax"]);
	mediaWiki.loader.go();
}
</script>

<script>if ( window.mediaWiki ) {
	mediaWiki.user.options.set({"ccmeonemails":0,"cols":80,"contextchars":50,"contextlines":5,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,
	"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"hr","language":"hr","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;mediaWiki.loader.state({"user.options":"ready"});
}
</script>		<!-- fixalpha -->
		<script type="text/javascript"> if ( window.isMSIE55 ) fixalpha(); </script>
		<!-- /fixalpha -->
		<!-- Served in 0.426 secs. -->			</body>
</html>
