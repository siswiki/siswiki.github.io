<!DOCTYPE html>
<html lang="hr" dir="ltr">
<head>
<meta charset="UTF-8" />
<title>Tehnike brzog mrežnog skeniranja (zmap) - SIS Wiki</title>
<meta name="generator" content="MediaWiki 1.17.0" />
<link rel="shortcut icon" href="http://security.foi.hr/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="../opensearch_desc.php" title="SIS Wiki (hr)" />
<link rel="EditURI" type="application/rsd+xml" href="../api.php%3Faction=rsd" />
<link title="Creative Commons" type="application/rdf+xml" href="http://security.foi.hr/wiki/index.php?title=Tehnike_brzog_mre%C5%BEnog_skeniranja_(zmap)&amp;action=creativecommons" rel="meta" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-sa/3.0/" />
<link rel="alternate" type="application/atom+xml" title="SIS Wiki Atom izvor" href="../index.php%3Ftitle=Posebno:Nedavne_promjene&amp;feed=atom" />
<link rel="stylesheet" href="../load.php%3Fdebug=false&amp;lang=hr&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cskins.vector&amp;only=styles&amp;skin=vector&amp;*.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/wiki/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr ns-0 ns-subject page-Tehnike_brzog_mrežnog_skeniranja_zmap skin-vector">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<!-- content -->
		<div id="content">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<!-- firstHeading -->
			<h1 id="firstHeading" class="firstHeading">Tehnike brzog mrežnog skeniranja (zmap)</h1>
			<!-- /firstHeading -->
			<!-- bodyContent -->
			<div id="bodyContent">
				<!-- tagline -->
				<div id="siteSub">Izvor: SIS Wiki</div>
				<!-- /tagline -->
				<!-- subtitle -->
				<div id="contentSub"></div>
				<!-- /subtitle -->
																<!-- jumpto -->
				<div id="jump-to-nav">
					Skoči na: <a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#mw-head">orijentacija</a>,
					<a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#p-search">traži</a>
				</div>
				<!-- /jumpto -->
								<!-- bodytext -->
				<p><b>Članovi tima:</b> Valentina Bobetić, Gabriel Glogoški, Matija Kovaček, Toni Steyskal
</p><p><br />
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Sadržaj</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Uvod"><span class="tocnumber">1</span> <span class="toctext">Uvod</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Po.C4.8Detak_sa_ZMap-om"><span class="tocnumber">2</span> <span class="toctext">Početak sa ZMap-om</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Najbolja_praksa_kod_skeniranja"><span class="tocnumber">3</span> <span class="toctext">Najbolja praksa kod skeniranja</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Naredbe_za_zmap_mre.C5.BEno_skeniranje"><span class="tocnumber">4</span> <span class="toctext">Naredbe za zmap mrežno skeniranje</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Op.C4.87e_postavke"><span class="tocnumber">4.1</span> <span class="toctext">Opće postavke</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Postavke_skeniranja"><span class="tocnumber">4.2</span> <span class="toctext">Postavke skeniranja</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Postavke_mre.C5.BEe"><span class="tocnumber">4.3</span> <span class="toctext">Postavke mreže</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Postavke_sondi"><span class="tocnumber">4.4</span> <span class="toctext">Postavke sondi</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Izlazne_postavke"><span class="tocnumber">4.5</span> <span class="toctext">Izlazne postavke</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Dodatne_postavke"><span class="tocnumber">4.6</span> <span class="toctext">Dodatne postavke</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Dodatne_informacije"><span class="tocnumber">5</span> <span class="toctext">Dodatne informacije</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#TCP_SYN_Skenovi"><span class="tocnumber">5.1</span> <span class="toctext">TCP SYN Skenovi</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#ICMP_Echo_Request_Skenovi"><span class="tocnumber">5.2</span> <span class="toctext">ICMP Echo Request Skenovi</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#UDP_Datagram_Skeniranje"><span class="tocnumber">5.3</span> <span class="toctext">UDP Datagram Skeniranje</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Konfiguracijske_datoteke"><span class="tocnumber">5.4</span> <span class="toctext">Konfiguracijske datoteke</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Opseg_podataka"><span class="tocnumber">5.5</span> <span class="toctext">Opseg podataka</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Izlazni_rezultati"><span class="tocnumber">5.6</span> <span class="toctext">Izlazni rezultati</span></a>
<ul>
<li class="toclevel-3 tocsection-18"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Izlazna_polja"><span class="tocnumber">5.6.1</span> <span class="toctext">Izlazna polja</span></a></li>
<li class="toclevel-3 tocsection-19"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Filtriranje_izlaza"><span class="tocnumber">5.6.2</span> <span class="toctext">Filtriranje izlaza</span></a></li>
<li class="toclevel-3 tocsection-20"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#CSV"><span class="tocnumber">5.6.3</span> <span class="toctext">CSV</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-21"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Blacklisting_i_whitelisting"><span class="tocnumber">5.7</span> <span class="toctext">Blacklisting i whitelisting</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Ograni.C4.8Davanje_brzine_i_uzorkovanje"><span class="tocnumber">5.8</span> <span class="toctext">Ograničavanje brzine i uzorkovanje</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Slanje_vi.C5.A1estrukih_paketa"><span class="tocnumber">5.9</span> <span class="toctext">Slanje višestrukih paketa</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-24"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Zmap_pro.C5.A1irenja"><span class="tocnumber">6</span> <span class="toctext">Zmap proširenja</span></a></li>
<li class="toclevel-1 tocsection-25"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Primjeri_skeniranja"><span class="tocnumber">7</span> <span class="toctext">Primjeri skeniranja</span></a>
<ul>
<li class="toclevel-2 tocsection-26"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Automatizacija_ZMap_skeniranja"><span class="tocnumber">7.1</span> <span class="toctext">Automatizacija ZMap skeniranja</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Rezultati_skeniranja_pomo.C4.87u_skripte"><span class="tocnumber">7.2</span> <span class="toctext">Rezultati skeniranja pomoću skripte</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-28"><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#Literatura"><span class="tocnumber">8</span> <span class="toctext">Literatura</span></a></li>
</ul>
</td></tr></table>
<h2> <span class="mw-headline" id="Uvod"> Uvod </span></h2>
<p>Započnimo s upoznavanjem jednog od najboljih „open source“ mrežnih skenera koji omogućava skeniranje i istraživanje Interneta, a naziva se ZMap. ZMap na vrlo lagani način uz pomoć jedne virtualne mašine i jako dobre mreže, omogućava kompletno skeniranje svih IPv4 adresa u svega 5 minuta, a moguće je približavanje teoretskom limitu od 10 GB Etherneta. 
ZMap je razvijen od strane tima računalnih znanstvenika sveučilišta u Michiganu:<br />
</p>
<ul><li>Zakir Durumeric<br />
</li><li>Eric Wustrow<br />
</li><li>J. Alex Halderman<br />
</li></ul>
<p><br />
Oni u svojem istraživačkom radu vrlo detaljno opisuju na koji način funkcionira ZMap, kako izgledaju moduli, kakve sve mogu biti izlazne datoteke u kojima se nalaze rezultati skeniranja. 
Obzirom da je ZMap jedan od vrlo moćnih alata za skeniranje mreže, potrebno je imati na umu da skeniranjem svih IPv4 adresa, većina ljudi neće biti sretna što skenirate njihovu mrežu i zadirete u njihovu privatnost. Stoga je prilikom skeniranja, potrebno takve ljude izuzeti iz skeniranja i poštivati njihove želje. Ovaj trojac se potrudio i dao je listu najboljih praksa prilikom skeniranja u kojoj navode na koji način ne ulaziti u tuđu mrežu i vršiti skeniranje, već postupati prema određenim zakonima. 
Na web stranici <a href="https://zmap.io/index.html" class="external free" rel="nofollow">https://zmap.io/index.html</a> pod karticom „Download“ može se skinuti posljednja verzija ZMap alata (posljednja verzija je 1.2.1) koja se može koristiti na Linuxu, Mac OS i BSD. Isto tako, prikazane su naredbe za instalaciju na pojedinom operativnom sustavu preko terminala te mogućnost tzv. „buildanja“ ZMap-a iz izvršne datoteke ako slučajno obična instalacija ne uspije. 
U nastavku će biti objašnjeno kako izgleda naredba u terminalu , koje se sve naredbe koriste prilikom skeniranja mreže, koje su najbolje prakse kojih se valja držati kako ne bi ušli u nečiju mrežu bez dozvole, biti će prikazani dodatni moduli, što je to „blacklisting“ i kako pohraniti rezultate skeniranja u neki od oblika koji se nude.
</p>
<hr />
<p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Valentina&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Valentina (stranica ne postoji)">Valentina</a> 09:50, 6. siječnja 2015. (CET)
</p>
<h2> <span class="mw-headline" id="Po.C4.8Detak_sa_ZMap-om"> Početak sa ZMap-om </span></h2>
<p>Kao što je već spomenuto, ZMap je dizajniran da obavlja sveobuhvatno skeniranje IPv4 adresnog prostora ili njegovih velikih portova. Uvijek je potrebno imati na umu da je ZMap moćan alat i da njegovim pokretanjem se vrši potencijalno skeniranje cijelog IPv4 adresnog prostora u kojemu se šalje više od 1,4 milijuna paketa u sekundi što je izuzetno veliki broj paketa. Stoga je uvijek prije skeniranja, potrebno kontaktirati lokalne administratore mreže što je najbolje učiniti. 
Po već unaprijed definiranom, ZMap će izvršiti TCP SYN skeniranje na određenom portu po maksimalnoj mogućoj brzini skeniranja. Primjerice, ako želimo skenirati 10.000 slučajnih adresa na portu 80 po brzini 10 Mbps, to ćemo napraviti na sljedeći način:<br />
</p>
<pre>
zmap --bandwidth=10M --target-port=80 --max-targets=10000 --output-file=results.csv&lt;br\&gt;
</pre>
<p>Postaviti ćemo širinu pojasa („bandwith“), port kojega želimo skenirati, koliko adresa želimo skenirati i kamo će se spremiti rezultat skeniranja i na koji način. 
Drugačiji način ovog zapisa je sljedeći: <br />
</p>
<pre>
$ zmap -B 10M -p 80 -n 10000 -o results.csv&lt;br\&gt;
</pre>
<p>ZMap-u također možemo odrediti koje podmreže („subnet“) da skenira, kao na primjer ako želimo da skenira samo podmreže 10.0.0.0/8 i 192.168.0.0/16 na portu 80, to ćemo upisati na sljedeći način:<br />
</p>
<pre>
zmap -p 80 -o results.csv 10.0.0.0/8 192.168.0.0/16&lt;br\&gt;
</pre>
<p>Nakon što pokrenemo skeniranje, vidjeti ćemo da se nešto događa, odnosno da se svake sekunde ažurira izlazni rezultat skeniranja. Za ovaj zadnji upit izlazni rezultati bi se kretali ovako:<br />
</p>
<div style="text-align: center;">
<pre>
0% (1h51m left); send: 28777 562 Kp/s (560 Kp/s avg); recv: 1192 248 p/s (231 p/s avg); hits: 0.04%
0% (1h51m left); send: 34320 554 Kp/s (559 Kp/s avg); recv: 1442 249 p/s (234 p/s avg); hits: 0.04%
0% (1h50m left); send: 39676 535 Kp/s (555 Kp/s avg); recv: 1663 220 p/s (232 p/s avg); hits: 0.04%
0% (1h50m left); send: 45372 570 Kp/s (557 Kp/s avg); recv: 1890 226 p/s (232 p/s avg); hits: 0.04%
</pre>
</div>
<p><br />
Izlazni rezultati prikazuju postotak napredovanja skeniranja i preostalo vrijeme do kraja skeniranja, koliko je paketa poslano, a koliko je primljeno i po kojoj brzini i prosječnoj brzini, te „hit-rate“.<br />
Svaka mreža ima drugačiju brzinu skeniranja, pa rezultat skeniranja najviše ovisi o brzini skeniranja. Ponekad to može trajati jako dugo, ako je mrežna brzina velika, a ako nije, onda to može trajati i po nekoliko sati. Najveći problem, najviše za početnike je ako ne znamo brzinu skeniranja, odnosno brzinu koju naša mreža može podržati. Najbolje je eksperimentirati s različitim brzinama skeniranja i pronaći granice propusnosti „Bandwith limit“ koje mreža može podržati. <br />
Eksperimentom će ZMap dati popis IP adresa koje su uspješno odgovorile (npr. sa SYN ACK paketom), a prikaže ih na sljedeći način:<br />
</p>
<pre>
115.237.116.119
23.9.117.80
207.118.204.141
217.120.143.111
50.195.22.82
</pre>
<p><br />
Format izlaza može biti prikazan na nekoliko načina, kao na primjer JSON i Redis, ali o tome više u nastavku gdje će biti objašnjeni svaki od formata izlaznog rezultata i na koji način oni mogu biti pohranjeni te kako te rezultate filtrirati.<br />
Tim koji je razvio ZMap preporuča svojim korisnicima da koriste datoteke koje se nalaze na crnoj listi („blacklist file“), da se isključe sva pridržana/nedodijeljeni IP prostor (npr. RFC1918) kao i mreže koje same po sebi zahtijevaju da budu isključene iz skeniranja.  ZMap će iskoristiti jednostavne datoteke sa crne liste koje sadrže rezervirane i ne alocirane adresne lokacija dostupne na  <b>/etc/zmap/blacklist.conf</b>. Ako neki od korisnika pronađe određene specifične postavke poput maksimalne propusnosti ili vlastitu crnu listu datoteka, tada je taj korisnik u mogućnosti koristiti te postavke svaku puta kada pokrene ZMap na način da se one specificiraju u <b>/etc/zmap/zmap.conf</b> ili da se koriste konfiguracijske datoteke koje su već prilagođene. 
Ako tijekom skeniranja dođe do poteškoća koje je potrebno ukloniti, postoji nekoliko mogućnosti da njihovo uklanjanja („debug“). Prva mogućnost je pokrenuti tzv. skeniranje na suho („dry run scan“) kako bi uopće vidjeli koji paketi su poslani preko mreže, a koji nisu, na način da se doda <b>--dryrun zastava</b> prilikom upisivanja naredbe u terminalu. <br />
Isto tako, moguće je i promijeniti opseg zapisivanja („logging verbosity“) na način da se postavi <b>--verbosity=n</b> zastavica prilikom upisivanja naredbe. <br />
</p>
<hr />
<p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Valentina&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Valentina (stranica ne postoji)">Valentina</a> 15:26, 12. siječnja 2015. (CET)
</p>
<h2> <span class="mw-headline" id="Najbolja_praksa_kod_skeniranja">Najbolja praksa kod skeniranja</span></h2>
<p>Kako bi se minimizirale smetnje na mreži prilikom izvođenje skeniranja poželjno je pratiti sljedeća pravila:
</p>
<ol><li>Blisko surađivati sa administratorom za mrežu kako bi se smanjili rizici, ili riješili upiti</li><li>Provjeriti i potvrditi da skeniranje neće zagušiti lokalnu mrežu ili providera</li><li>Signaliziran bezopasnu namjeru skeniranja na web stranicama i DNS unosima na izvorišnim adresama</li><li>Jasno objasniti svrhu i opseg skeniranja kroz sve oblike komunikacije</li><li>Omogućiti jednostavan način prekida i poštivanja upućenih zahtjeve</li><li>Ne raditi skeniranja bez stvarne potrebe za ciljeve istraživanja</li><li>Raspršiti promet za skeniranje kroz vrijeme ili izvorišne IP adrese</li></ol>
<p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:GGlogoski&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:GGlogoski (stranica ne postoji)">GGlogoski</a> 23:23, 12. siječnja 2015. (CET)
</p>
<h2> <span class="mw-headline" id="Naredbe_za_zmap_mre.C5.BEno_skeniranje"> Naredbe za zmap mrežno skeniranje </span></h2>
<p>U nastavku slijede opcije i njihov opis koje se najčešće koriste prilikom mrežnog skeniranja.
</p>
<h3> <span class="mw-headline" id="Op.C4.87e_postavke">Opće postavke </span></h3>
<table class="wikitable" style="width:75%">
<tr>
<td style="padding: 5px; width:25%"><b>Opcije</b>
</td>
<td style="padding: 5px;"> <b>Opis</b>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-p, --target-port=port</big>
</td>
<td style="padding: 5px;"> <big>Skenira određeni port.</big><br />Primjer: –p 443 ili –target-port=443 (TCP port 443)
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-o, --output-file=name</big>
</td>
<td style="padding: 5px;"> <big>Zapisuje rezultate skeniranja u datoteku.</big><br />Primjer: –o rezultati.csv ili –output-file=rezultati.csv
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-b, --blacklist-file=path</big>
</td>
<td style="padding: 5px;"> <big>Ne skenira određene IP adrese navedene u blacklist datoteci. Raspon adresa koje ne želite skenirati navode se u datoteci i to u CIDR notaciji.</big><br />Primjer: ako ne želite skenirati sljedeći raspon adresa 192.168.10.0 – 192.168.10.255 , u blacklist datoteku navedete 192.168.10.0/24
</td></tr>
</table>
<h3> <span class="mw-headline" id="Postavke_skeniranja">Postavke skeniranja </span></h3>
<table class="wikitable" style="width:75%">
<tr>
<td style="padding: 5px; width:25%"><b>Opcije</b>
</td>
<td style="padding: 5px;"> <b>Opis</b>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-n, --max-targets=n</big>
</td>
<td style="padding: 5px;"> <big>Određuje maksimalni broj IP adresa koji želite skenirati. </big><br />Primjer: želite skenirati 100  adresa: -n 100 ili –max-targets=100 
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-N, --max-results=n</big>
</td>
<td style="padding: 5px;"> <big>Određuje maksimalni broj rezultata koji želite zaprimiti. Prekida skeniranje nakon dobivenog broja rezultata. </big><br />Primjer: želite zaprimiti maksimalno 1000 rezultata:  –N 1000 ili –max-results=1000 ,  skeniranje se prekida nakon 1000 zaprimljenih rezultata.
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-t, --max-runtime=secs</big>
</td>
<td style="padding: 5px;"> <big>Određuje maksimalno vrijeme trajanja slanja paketa u sekundama.</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-r, --rate=pps</big>
</td>
<td style="padding: 5px;"> <big>Određuje  maksimalni broj poslanih paketa u sekundi.</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-B, --bandwidth=bps</big>
</td>
<td style="padding: 5px;"> <big>Određuje  maksimalni broj poslanih bitova u sekundi.</big><br />Primjer: –B 10 za 10mbps.
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-c, --cooldown-time=secs</big>
</td>
<td style="padding: 5px;"> <big>Određuje vrijeme trajanja zaprimanja rezultata nakon što je poslan zahtjev (defaultna vrijednost je 8 sekundi).</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-s --seed=n</big>
</td>
<td style="padding: 5px;"> <big>Određuje broj koliko puta želimo skenirati isti raspon IP adresa.</big><br />Primjer: želimo skenirati 3 puta iste IP adrese: -s=3 ili –seed=3 
</td></tr>
<tr>
<td style="padding: 10px;"> <big>--shards=n</big>
</td>
<td style="padding: 5px;"> <big>Dijeli skeniranje u N particiija (defaultna vrijednost je 1). Za korištenje ove opcije mora biti navedena opcija –seed</big><br />Primjer: želimo podijeliti skeniranje u 2 particije: --shards=2
</td></tr>
<tr>
<td style="padding: 10px;"> <big>--shard=n</big>
</td>
<td style="padding: 5px;"> <big>Određuje koju particiju želimo skenirati (od 0 do n). Za korištenje ove opcije mora biti navedena opcija –seed</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-T, --sender-threads=n</big>
</td>
<td style="padding: 5px;"> <big>Određuje broj dretvi koje će slati pakete (defaultna vrijednost je 1 dretva).</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-P, --probes=n</big>
</td>
<td style="padding: 5px;"> <big>Određuje broj segmenta paketa koji će se poslati IP adresi (defaultna vrijednost je 1).</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-d, --dryrun</big>
</td>
<td style="padding: 5px;"> <big>Umjesto slanja, ispisuje paket što je korisni za debugging.</big>
</td></tr>
</table>
<h3> <span class="mw-headline" id="Postavke_mre.C5.BEe"> Postavke mreže </span></h3>
<table class="wikitable" style="width:75%">
<tr>
<td style="padding: 5px; width:25%"><b>Opcije</b>
</td>
<td style="padding: 5px;"> <b>Opis</b>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-s, --source-port=port|range</big>
</td>
<td style="padding: 5px;"> <big>Određuje broj porta s kojeg se šalju paketi.</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-S, --source-ip=ip|range</big>
</td>
<td style="padding: 5px;"> <big>Određuje IP adresu ili raspon IP adresa s kojih se šalju paketi.</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-G, --gateway-mac=addr</big>
</td>
<td style="padding: 5px;"> <big>Određuje gateway MAC adresu za slanje paketa.</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-i, --interface=name</big>
</td>
<td style="padding: 5px;"> <big>Određuje mrežno sučelje koje će biti upotrijebljeno.</big>
</td></tr>
</table>
<h3> <span class="mw-headline" id="Postavke_sondi"> Postavke sondi</span></h3>
<p>Zmap omogućuje korisnicima da odaberu koji modul sondi žele koristiti (tcp_synscan ili icmp_echoscan) ili da napišu vlastiti modul. Moduli se koriste za generiranje paketa sondi i za obradu zaprimljenih rezultata.
</p>
<table class="wikitable" style="width:85%">
<tr>
<td style="padding: 5px; width:25%"><b>Opcije</b>
</td>
<td style="padding: 5px;"> <b>Opis</b>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>--list-probe-modules</big>
</td>
<td style="padding: 5px;"> <big>Ispisuje listu dostupnih sondnih modula.</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-M, --probe-module=name</big>
</td>
<td style="padding: 5px;"> <big>Određuje odabrani modul (defaultno je  tcp_synscan).</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>--probe-args=args</big>
</td>
<td style="padding: 5px;"> <big>Prosljeđuje argumente sondnom modulu.</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>--list-output-fields</big>
</td>
<td style="padding: 5px;"> <big>Ispisuje koje dijelove odabranog sondnog modula se mogu poslati izlaznom modulu.</big>
</td></tr>
</table>
<h3> <span class="mw-headline" id="Izlazne_postavke"> Izlazne postavke</span></h3>
<p>Zmap omogućuje korisnicima da odaberu koji izlazni modul žele koristiti (npr. csv format) ili da napišu vlastiti izlazni modul. Izlazni moduli služe da zaprime i obrade podatke zaprimljene od sondnog modula i da ih prikažu korisniku. Korisnik može koristiti i filtere tako da ograniči koje dijelove rezultata skeniranja želi vidjeti.
</p>
<table class="wikitable" style="width:85%">
<tr>
<td style="padding: 5px; width:25%"><b>Opcije</b>
</td>
<td style="padding: 5px;"> <b>Opis</b>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>--list-output-modules</big>
</td>
<td style="padding: 5px;"> <big>Ispisuje listu dostupnih izlaznih modula.</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-O, --output-module=name</big>
</td>
<td style="padding: 5px;"> <big>Određuje odabrani izalzni modul (defaultno je .csv).</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>--output-args=args</big>
</td>
<td style="padding: 5px;"> <big>Prosljeđuje argumente izlaznom modulu.</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-f, --output-fields=fields</big>
</td>
<td style="padding: 5px;"> <big>Određuje dijelove rezultata želimo dobiti u izlaznom modulu.</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>--output-filter</big>
</td>
<td style="padding: 5px;"> <big>Određuje izlazni filter koji se odnosi na dijelove sondnog modula.</big>
</td></tr>
</table>
<h3> <span class="mw-headline" id="Dodatne_postavke"> Dodatne postavke</span></h3>
<table class="wikitable" style="width:85%">
<tr>
<td style="padding: 5px; width:25%"><b>Opcije</b>
</td>
<td style="padding: 5px;"> <b>Opis</b>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-C, --config=filename</big>
</td>
<td style="padding: 5px;"> <big>Odabire konguracijsku datoteku u kojoj su navedene opcije skeniranja.Korisno ako ne želimo stalno za svako skeniranje pisati razne postavke, jednostavno odabremo datoteku.</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-q, --quiet</big>
</td>
<td style="padding: 5px;"> <big>Onemogućava ispisivanje trenutnog stanja skeniranja.</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-g, --summary</big>
</td>
<td style="padding: 5px;"> <big>Završetkom skeniranja ispisuje se konfiguracija skeniranja i sažetak rezultata skeniranja.</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-v, --verbosity=n</big>
</td>
<td style="padding: 5px;"> <big>Razina log detaljnosti (0-5, default 3).</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-h, --help</big>
</td>
<td style="padding: 5px;"> <big>Ispisuje pomoć za rad s zmapom.</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-V, --version</big>
</td>
<td style="padding: 5px;"> <big>Ispisuje verziju zmapa.</big>
</td></tr>
</table>
<p><a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Mkovacek&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Mkovacek (stranica ne postoji)">Mkovacek</a> 18:16, 8. siječnja 2015. (CET)
</p>
<h2> <span class="mw-headline" id="Dodatne_informacije"> Dodatne informacije </span></h2>
<p>U nastavku slijedi dodatno objašnjene određenih pojmova koji su se koristili u ranijem dijelu wiki-a.
</p><p><br />
</p>
<h3> <span class="mw-headline" id="TCP_SYN_Skenovi"> TCP SYN Skenovi </span></h3>
<p>Prilikom  TCP SYN skena, ZMap zahtijeva jedan ciljani port i podržava određivanje raspon izvornih portova od kojih će skeniranje potjeći.
</p><p><br />
</p>
<div style="text-align: center;">
<p><b>-p, --target-port=port</b>   TCP port broj za skeniranje (npr. 443) <br />
<b>-s, --source-port=port|range</b>   Izvorni portovi za skeniranje paketa (npr. 40000 - 50000)<br />
</p>
</div>
<p><br />
ZMap se oslanja na linux kernel da odgovori SYN/ACK paketima s RST paketima kako bi zatvorio veze koje je otvorio skener. To se događa jer ZMap šalje pakete na Ethernet sloju kako bi se smanjio pretek koji inače nastaje u kernelu od praćenja otvorenih TCP veza i obavljanja dohvaćivanja ruta. Kao takav, ako imate firewall pravilo koje prati uspostavljene veze poput netfilter pravila koje je slično -A INPUT -m state --state RELATED, ESTABLISHED -j ACCEPT, to će blokirati SYN/ACK pakete od dostizanja kernela. To neće spriječiti ZMap od snimanja odgovora, ali će spriječiti RST pakete pri slanju natrag, u konačnici ispunit će vezu na skeniranom računalu do prekida veze. Preporučujemo da odaberete skup neiskorištenih portova na skeniranom računalu kojem može biti dopušten pristup u vaš firewall i specificirajte taj raspon portova kada koristite ZMap sa -s zastavom (npr. 40000-50000).
</p><p><br />
</p>
<h3> <span class="mw-headline" id="ICMP_Echo_Request_Skenovi"> ICMP Echo Request Skenovi </span></h3>
<p>Dok ZMap obavlja TCP SYN skenove prema zadanim postavkama, on također podržava ICMP Echo Request skenove u kojima se ICMP Echo Request paket šalje svakom skeniranom računalu i vrsta ICMP dobivenog odgovora se označuje. ICMP skeniranje se može izvesti odabirom icmp_echoscan modula za skeniranje pomoću:
</p><p><b>$ zmap --probe-module=icmp_echoscan</b>
</p><p><br />
</p>
<h3> <span class="mw-headline" id="UDP_Datagram_Skeniranje"> UDP Datagram Skeniranje </span></h3>
<p>ZMap dodatno podržava UDP sonde, gdje će se poslati proizvoljan UDP datagram svakom skeniranom računalu i zaprimiti ili UDP ili ICMP nedostižan odgovor. ZMap podržava četiri različite metode postavljanja UDP payload-a kroz --probe-args opcije naredbenog retka. To su "text" za ASCII-printable payload-e, "hex" za hexadecimalne payload-e postavljene na naredbenom retku, "file" za payload sadržan u vanjskoj datoteci i "template" za payload koji zahtijeva dinamičnu generaciju polja. Da bi se dobio UDP odgovor, "data" se mora navesti kao jedno od polja -f opcije.
</p><p><br />
Primjer u nastavku će poslati dva bajta "ST" i PCAnywhere "status" zahtjev na UDP port 5632:<br />
<b>$ zmap -M udp -p 5632 --probe-args=text:ST -N 100 -f saddr,data -o -</b>
</p><p><br />
Sljedeći primjer će poslati bajt "0x02" i SQL Server "client broadcast" zahtjev na  UDP port 1434:<br />
<b> $ zmap -M udp -p 1434 --probe-args=hex:02 -N 100 -f saddr,data -o -</b>
</p><p><br />
Posljednji primjer šalje SIP "OPTIONS" zahtjev na UDP port 5060, koristi predložak koji je uključen ZMap distribucijom:<br />
<b> $ zmap -M udp -p 1434 --probe-args=file:sip_options.tpl -N 100 -f saddr,data -o -</b>
</p><p>Sljedeća polja predložaka su trenutno implementirana:
</p><p><b>SADDR:</b> Izvorna IP adresa u dotted-quad formatu<br />
<b>SADDR_N:</b> Izvorna IP adresa u network byte poretku<br />
<b>DADDR:</b> Odredišna IP adresa u dotted-quad formatu<br />
<b>DADDR_N:</b> Odredišna IP adresa u network byte poretku<br />
<b>SPORT:</b> Izvorni port u ascii formatu<br />
<b>SPORT_N:</b> Izvorni port u network byte poretku<br />
<b>DPORT:</b> Odredišni port u ascii formatu<br />
<b>DPORT_N:</b> Odredišni port u network byte poretku<br />
<b>RAND_BYTE:</b> Slučajni bitovi (0-255), duljina specificirana sa =(length) parameterom<br />
<b>RAND_DIGIT:</b> Slučajne brojke od 0-9, duljina specificirana sa =(length) parameterom<br />
<b>RAND_ALPHA:</b> Slučajna slova (mixed-case) od A-Z, duljina specificirana sa =(length) parameterom<br />
<b>RAND_ALPHANUM:</b> Slučajna slova (mixed-case) od A-Z i brojke od 0-9, duljina specificirana sa =(length) parameterom<br />
</p><p><br />
</p>
<h3> <span class="mw-headline" id="Konfiguracijske_datoteke"> Konfiguracijske datoteke </span></h3>
<p>ZMap podržava konfiguracijske datoteke umjesto zahtijevanja da se sve opcije specificiraju u naredbenom retku. Konfiguracija se može kreirati specificirajući jednu opciju dugog imena i vrijednost po liniji, kao što se vidi u nastavku:<br />
</p><p><b>interface "eth1"</b><br />
<b>source-ip 1.1.1.4-1.1.1.8</b><br />
<b>gateway-mac b4:23:f9:28:fa:2d # upstream gateway</b><br />
<b>cooldown-time 300 # seconds</b><br />
<b>blacklist-file /etc/zmap/blacklist.conf</b><br />
<b>output-file ~/zmap-output</b><br />
<b>quiet</b><br />
<b>summary</b><br />
</p><p>ZMap se onda može izvoditi pomoću konfiguracijske datoteke i specificiranjem bilo kakvih dodatno potrebnih parametara: <br />
</p><p><b> $ zmap --config=~/.zmap.conf --target-port=443</b><br />
</p><p><br />
</p>
<h3> <span class="mw-headline" id="Opseg_podataka"> Opseg podataka </span></h3>
<p>Postoji nekoliko tipova izlaza koje ZMap proizvodi na zaslonu. Prema zadanim postavkama, ZMap će ispisati osnovne podatke napretka svake sekunde. To može biti onemogućeno postavljanjem --quiet zastavice.
</p>
<div style="text-align: center;">
<p><b>0:01 12%; send: 10000 done (15.1 Kp/s avg); recv: 144 143 p/s (141 p/s avg); hits: 1.44%</b>
</p>
</div>
<p>ZMap također ispisuje informativne poruke tijekom konfiguracije skenera, kao što su sljedeće,  koje se mogu kontrolirati --verbosity argumentom.
</p><p><b>Aug 11 16:16:12.813 [INFO] zmap: started</b>  <br />
<b>Aug 11 16:16:12.817 [DEBUG] zmap: no interface provided. will use eth0</b><br />
<b>Aug 11 16:17:03.971 [DEBUG] cyclic: primitive root: 3489180582</b><br />
<b>Aug 11 16:17:03.971 [DEBUG] cyclic: starting point: 46588</b><br />
<b>Aug 11 16:17:03.975 [DEBUG] blacklist: 3717595507 addresses allowed to be scanned</b><br />
<b>Aug 11 16:17:03.975 [DEBUG] send: will send from 1 address on 28233 source ports</b><br />
<b>Aug 11 16:17:03.975 [DEBUG] send: using bandwidth 10000000 bits/s, rate set to 14880 pkt/s</b><br />
<b>Aug 11 16:17:03.985 [DEBUG] recv: thread started</b><br />
</p><p>ZMap podržava ispis grep-able sažetka na kraju skeniranja koji se može pozivati --summary zastavicom.
</p><p><br />
</p>
<h3> <span class="mw-headline" id="Izlazni_rezultati"> Izlazni rezultati </span></h3>
<p>ZMap može proizvesti rezultate u više formata korištenjem izlaznih modula. Po zadanim postavkama, ZMap podržava samo csv izlaz, međutim podrška za redis i JSON se može uključiti. Rezultati poslani na izlazne module se mogu filtrirati preko izlaznog filtra. Polja koja zapisuje izlazni modul su specificirana od strane korisnika. Po zadanim postavkama, ZMap će vratiti rezultate u csv formatu i ukoliko ni jedna izlazna datoteka nije navedena, ZMap neće proizvesti specifične rezultate. Postoji mogućnost pisanja vlastitog modula.
</p>
<pre>
-o, --output-file=p     File to write output to
-O, --output-module=p   Invoke a custom output module
-f, --output-fields=p   Comma-separated list of fields to output
--output-filter=filter  Specify an output filter over fields for a given probe
--list-output-modules   Lists available output modules
--list-output-fields    List available output fields for a given probe
</pre>
<h4> <span class="mw-headline" id="Izlazna_polja"> Izlazna polja </span></h4>
<p>ZMap sadrži polja koja mogu služiti kao izlazna izvan dosega IP adresa. Ta polja mogu biti pregledana za danu sondu koristeći --list-output-fields zastavicu.
</p>
<pre>&lt;code&gt;$ zmap --probe-module=&quot;tcp_synscan&quot; --list-output-fields
saddr           string: source IP address of response
saddr-raw          int: network order integer form of source IP address
daddr           string: destination IP address of response
daddr-raw          int: network order integer form of destination IP address
ipid               int: IP identification number of response
ttl                int: time-to-live of response packet
sport              int: TCP source port
dport              int: TCP destination port
seqnum             int: TCP sequence number
acknum             int: TCP acknowledgement number
window             int: TCP window
classification  string: packet classification
success            int: is response considered success
repeat             int: is response a repeat response from host
cooldown           int: Was response received during the cooldown period
timestamp-str   string: timestamp of when response arrived in ISO8601 format.
timestamp-ts       int: timestamp of when response arrived in seconds since Epoch
timestamp-us       int: microsecond part of timestamp (e.g. microseconds since 'timestamp-ts')&lt;/code&gt;</pre>
<p>Kako bi se odabrala polja koja će služiti kao izlaz, bilo koja kombinacija izlaznih polja može biti navedena kao lista odvojena zarezom pomoću --output-fields=fields ili -f zastavicama. Primjer:
</p><p><b>$ zmap -p 80 -f "response,saddr,daddr,sport,seq,ack,in_cooldown,is_repeat,timestamp" -o output.csv</b>
</p><p><br />
</p>
<h4> <span class="mw-headline" id="Filtriranje_izlaza"> Filtriranje izlaza </span></h4>
<p>Rezultati dobiveni pomoću modula sonde se mogu filtrirati prije nego se proslijede izlaznom modulu. Filtri su definirani preko izlaznih polja modula sonde. Pisani su u jednostavnom jeziku filtriranja, sličan SQL-u, i prosljeđeni su ZMapu preko --output-filter opcije. Izlazni filtri se najčešće koriste za filtriranje duplih rezultata ili za prosljeđivanje samo uspješnih odgovora na izlazni modul.
</p><p>Izrazi korišteni za filtriranje su oblika &lt;fieldname&gt; &lt;operation&gt; &lt;value&gt;. Vrsta &lt;value&gt; mora biti string ili pozitivni integer i mora odgovarati tipu &lt;fieldname&gt;. Valjane operacije za usporedbu brojeva su =&#160;!=, &lt;, &gt;, &lt;=, &gt;=. Dok se za usporedbu stringova koriste =,&#160;!=. --list-output-fields zastavica prikazuje koja polja i tipovi su dostupni za odabrani modul sonde.
</p><p>Spoj izraza za filtiranje se može izvesti pomoću &amp;&amp; (logical AND) i || (logical OR) operatora.
</p><p>Primjer filtra za samo uspješne i ne duplicirane odgovore: <br />
<b>--output-filter="success = 1 &amp;&amp; repeat = 0"</b>
</p><p><br />
</p>
<h4> <span class="mw-headline" id="CSV"> CSV </span></h4>
<p>CSV modul će proizvesti zarezom odvojene vrijednosne datoteke traženih izlaznih polja. Na primjer, sljedeća naredba daje CSV u datoteci pod nazivom output.csv:<br />
</p><p><b>$ zmap -p 80 -f "response,saddr,daddr,sport,seq,ack,in_cooldown,is_repeat,timestamp" -o output.csv</b>
</p>
<pre>response, saddr, daddr, sport, dport, seq, ack, in_cooldown, is_repeat, timestamp
synack, 159.174.153.144, 10.0.0.9, 80, 40555, 3050964427, 3515084203, 0, 0,2013-08-15 18:55:47.681
rst, 141.209.175.1, 10.0.0.9, 80, 40136, 0, 3272553764, 0, 0,2013-08-15 18:55:47.683
rst, 72.36.213.231, 10.0.0.9, 80, 56642, 0, 2037447916, 0, 0,2013-08-15 18:55:47.691
rst, 148.8.49.150, 10.0.0.9, 80, 41672, 0, 1135824975, 0, 0,2013-08-15 18:55:47.692
rst, 50.165.166.206, 10.0.0.9, 80, 38858, 0, 535206863, 0, 0,2013-08-15 18:55:47.694
rst, 65.55.203.135, 10.0.0.9, 80, 50008, 0, 4071709905, 0, 0,2013-08-15 18:55:47.700
synack, 50.57.166.186, 10.0.0.9, 80, 60650, 2813653162, 993314545, 0, 0,2013-08-15 18:55:47.704
synack, 152.75.208.114, 10.0.0.9, 80, 52498, 460383682, 4040786862, 0, 0,2013-08-15 18:55:47.707
synack, 23.72.138.74, 10.0.0.9, 80, 33480, 810393698, 486476355, 0, 0,2013-08-15 18:55:47.710
</pre>
<hr />
<p><a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Tsteyska&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Tsteyska (stranica ne postoji)">Toni Steyskal</a> 22:20, 8. siječnja 2015. (CET)
</p>
<h3> <span class="mw-headline" id="Blacklisting_i_whitelisting"> Blacklisting i whitelisting </span></h3>
<p>Zmap podržava još i dva parametra za tzv. blackilstanje odnosno whitelistanje. Korisni su ako se želimo osigurati od toga da skenira nedozvoljeni dio mreže. Bez navedenih parametara bit će skenirane sve navedene IP adrese, no ako se koriste ovi parametri moguće je ograničiti Zmap skeniranje samo na one dijelove mreže kojima imamo dozvolu. U slučaju blacklistanja navedene IP adrese će biti izuzete iz skeniranja, a sve ostale će biti uključene, dok u slučaju whitelistanja će samo navedene IP adrese biti skenirane. Također moguće je ova dva principa istovremeno koristiti sa napomenom da blackilsting ima prednost nad whitelistingom. IP adrese koje će se blokirati ili skeniati mogu biti uređene na dva načina. Prvi je samo nakon prefiksa naredbe staviti IP adresu (sa subnetom)koja će biti dozvoljena ili blokirana, a drugi način je kreirati datoteke u kojima će se nalaziti lista IP adresa koje su dozvoljene/ blokirane. Parametri za omogućavanje blackistinga i whitelistinga:
</p>
<table class="wikitable" style="width:85%">
<tr>
<td style="padding: 5px; width:25%"><b>Opcije</b>
</td>
<td style="padding: 5px;"> <b>Opis</b>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-b, --blacklist-file=path</big>
</td>
<td style="padding: 5px;"> <big>Putanja do datoteke sa IP adresama koje nece biti skenirane ili IP adrese (subneti) u CIDR notaciji</big>
</td></tr>
<tr>
<td style="padding: 10px;"> <big>-w, --whitelist-file=path</big>
</td>
<td style="padding: 5px;"> <big>Putanja do datoteke sa IP adresama koj su dozvoljene ili IP adrese (subneti) u CIDR notaciji</big>
</td></tr>
</table>
<p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:GGlogoski&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:GGlogoski (stranica ne postoji)">GGlogoski</a> 23:19, 11. siječnja 2015. (CET)
</p>
<h3> <span class="mw-headline" id="Ograni.C4.8Davanje_brzine_i_uzorkovanje"> Ograničavanje brzine i uzorkovanje </span></h3>
<p>Prema zadanim postavkama ZMap će skenirati po najbržoj brzini koju podržava mrežni adapter, to predstavlja oko 95-98% teoretske brzine gigabit Ethernet-a, što može biti brže nego što vaš pružatelj usluga može podnijeti. ZMap neće automatski uskladiti brzinu, već se ona mora ručno prilagoditi kako bi se smanjio broj izgubljenih paketa i neispravnih rezultata.
</p><p><b>-r, --rate=pps </b>       Postavi maximalnu brzinu slanja u packetima/seckundi<br />
<b>-B, --bandwidth=bps</b>   Postavi brzinu slanja u bitovima/sekundi (podržava sufikse G, M i K), nadjačava --rate zastavu.<br />
</p><p>ZMap također omogućuje slučajno uzorkovanje IPv4 adresnog prostora određivanjem maximalnog broja računala za skeniranje i/ili maximalnim vremenom izvođenja. Budući da su računala skenirana prema slučajnoj permutaciji generiranoj po instanci skeniranja, ograničavajući skeniranje na n računala dobiva se slučajni uzorak od n skeniranih računala. Opcije naredbenog retka:
</p><p><b>-n, --max-targets=n</b> Ograniči broj računala<br />
<b>-N, --max-results=n</b> Ograniči broj rezultata (izlazi se nakon ovolikog broja pozitivnih rezultata)<br />
<b>-t, --max-runtime=s</b> Ograniči vrijeme za slanje paketa (u sekundama)<br />
<b>-s, --seed=n</b> Sjeme koje se koristi za odabir permutacija adresa.<br />
</p><p><br />
</p>
<h3> <span class="mw-headline" id="Slanje_vi.C5.A1estrukih_paketa"> Slanje višestrukih paketa </span></h3>
<p>ZMap podržava slanje više sondi svakom skeniranom računalu. Povećavanjem tog broja povećava se vrijeme skeniranja i broj dosegnutih skeniranih računala. Međutim, povećanje vremena skeniranja (~ 100% po dodatnoj sondi) uvelike nadmašuje povećanja u broju dosegnutih računala (~ 1% po dodatnoj sondi).
</p><p><b>-P, --probes=n</b> Broj jedinstvenih sondi koje će se slati svakom IP-u (default = 1) <br />
</p>
<hr />
<p><a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Tsteyska&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Tsteyska (stranica ne postoji)">Tsteyska</a> 15:55, 12. siječnja 2015. (CET)
</p><p><br />
</p>
<h2> <span class="mw-headline" id="Zmap_pro.C5.A1irenja">Zmap proširenja</span></h2>
<p>Zmap je moguće proširiti sa raznim modulima (sondirajući ili izlazni moduli). Moguće ih je i samostalno napraviti (koristeći prog. jezik C). Pošto je osnovna funkcionalnost Zmapa uspotavljanje kontakta sa velikim brojem zadanih adresa i provjera koje od njih daju odgovor, nekim korisnicima to neće biti dovoljno. Neki će željeti raditi dodatne procese na aplikacijskoj razini npr. skenirajući HTTP port bilo bi dobro napraviti GET zahtjev ili TLS handshake nakon skeniranja HTTPS porta. Dva modula dolaze ugrađena u Zmap a to su banner-grab i forge-socket
</p><p><b>Banner grab</b>
</p><p>Prva aplikacija koja je ugrađena u Zmap je banner-grab i služi za slanje i hvatanje poruka koje server vraća na razne upite. Aplikacija sluša TCP protokol i kada detektira odgovor sprema ga u odabranu datoteku. Ova tehnika (zvana još i banner grabbing) može se koristiti i u maliciozne svrhe jer potencijalnom napadaču može dati iformacije o sustavu na kojem server radi (a time i njegovim slabostima), pronaći hostove i ostale odgovore na razne komande.
</p><p><b>Forge socket</b>
</p><p>Ova aplikacija je zamišljena kao dodatak na banner-grab, jer server nakon što pošalje odgovor (SYN-ACK paket), koji banner-grab uhvati, zatvara TCP komunikaciju (pomoću RST paketa). I tako banner-grab mora za svaki poziv otvarati novu TCP konekciju. Forge-socket stvara dodatnu TCP vezu koja blokira RST paket i socket koji višestruko koristi SYN-ACK parametre za parmanentnije slanje podataka.
</p><p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:GGlogoski&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:GGlogoski (stranica ne postoji)">GGlogoski</a> 00:43, 13. siječnja 2015. (CET)
</p>
<h2> <span class="mw-headline" id="Primjeri_skeniranja">Primjeri skeniranja</span></h2>
<p>Skeniranje je obavljeno na točno određenim adresama kako bi se vidjelo koji su otvoreni portovi na određenoj adresi.
</p><p><b>Uspješno:</b>
<br />
SSH 
</p>
<pre>zmap -p 22 -f&quot;saddr,daddr,sport,dport&quot; -o rezultati1.csv --summary  161.53.120.61 

Jan 10 12:08:17.618 [WARN] blacklist: ZMap is currently using the default blacklist located at /etc/zmap/blacklist.conf. By default, this blacklist excludes locally scoped networks (e.g. 10.0.0.0/8, 127.0.0.1/8, and 192.168.0.0/16). If you are trying to scan local networks, you can change the default blacklist by editing the default ZMap configuration at /etc/zmap/zmap.conf.
Jan 10 12:08:18.274 [INFO] zmap: output module: csv

 0:00 4%; send: 1 done (2 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%
 0:00 4%; send: 1 done (2 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%
 0:01 16%; send: 1 done (2 p/s avg); recv: 1 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 100.00%
 0:02 28%; send: 1 done (2 p/s avg); recv: 1 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 100.00%
 0:03 41%; send: 1 done (2 p/s avg); recv: 1 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 100.00%
 0:04 53%; send: 1 done (2 p/s avg); recv: 1 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 100.00%
 0:05 65% (3s left); send: 1 done (2 p/s avg); recv: 1 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 100.00%
 0:06 77% (2s left); send: 1 done (2 p/s avg); recv: 1 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 100.00%
 0:07 89% (1s left); send: 1 done (2 p/s avg); recv: 1 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 100.00%
 0:08 104% (0s left); send: 1 done (2 p/s avg); recv: 1 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 100.00%

cnf	target-port	22
cnf	source-port-range-begin	32768
cnf	source-port-range-end	61000
cnf	source-addr-range-begin	192.168.199.130
cnf	source-addr-range-end	192.168.199.130
cnf	maximum-targets	4294967295
cnf	maximum-runtime	0
cnf	maximum-results	4294967295
cnf	permutation-seed	0
cnf	cooldown-period	8
cnf	send-interface	eth0
cnf	rate	0
cnf	bandwidth	0
cnf	shard-num	0
cnf	num-shards	1
cnf	senders	1
env	nprocessors	2
exc	send-start-time	Sat Jan 10 12:08:18 2015
exc	send-end-time	Sat Jan 10 12:08:18 2015
exc	recv-start-time	Sat Jan 10 12:08:18 2015
exc	recv-end-time	Sat Jan 10 12:08:26 2015
exc	sent	1
exc	blacklisted	254
exc	whitelisted	1
exc	first-scanned	0
exc	hit-rate	100.000000
exc	success-total	1
exc	success-unique	1
exc	success-cooldown-total	1
exc	success-cooldown-unique	1
exc	failure-total	0
exc	sendto-failures	0
adv	permutation-gen	247
exc	scan-type	tcp_synscan
Jan 10 12:08:27.934 [INFO] zmap: completed</pre>
<p>Izlazna datoteka:</p>
<pre>saddr, daddr, sport, dport
161.53.120.61,192.168.199.130,22,56122</pre>
<p>HTTPS
</p>
<pre>
zmap -p 443 -f&quot;saddr,daddr,sport,dport&quot; --verbosity=5  -o rezultati2.csv --summary  161.53.120.210 

Jan 10 12:13:06.629 [TRACE] zmap: zmap main thread started
Jan 10 12:13:06.629 [DEBUG] zmap: Loaded configuration file /etc/zmap/zmap.conf
Jan 10 12:13:06.630 [DEBUG] zmap: syslog support enabled
Jan 10 12:13:06.630 [TRACE] zmap: requested ouput-module: default
Jan 10 12:13:06.630 [DEBUG] zmap: no output module provided. will use csv.
Jan 10 12:13:06.630 [TRACE] fieldset: probe module does not supply application success field.
Jan 10 12:13:06.631 [DEBUG] zmap: requested output field (0): saddr
Jan 10 12:13:06.631 [DEBUG] zmap: requested output field (1): daddr
Jan 10 12:13:06.631 [DEBUG] zmap: requested output field (2): sport
Jan 10 12:13:06.631 [DEBUG] zmap: requested output field (3): dport
Jan 10 12:13:06.632 [WARN] blacklist: ZMap is currently using the default blacklist located at /etc/zmap/blacklist.conf. By default, this blacklist excludes locally scoped networks (e.g. 10.0.0.0/8, 127.0.0.1/8, and 192.168.0.0/16). If you are trying to scan local networks, you can change the default blacklist by editing the default ZMap configuration at /etc/zmap/zmap.conf.
Jan 10 12:13:06.632 [DEBUG] constraint: blacklisting 0.0.0.0/0
Jan 10 12:13:06.633 [TRACE] constraint: Painting value 1
Jan 10 12:13:06.640 [DEBUG] constraint: 0 IPs in radix array, 1 IPs in tree
Jan 10 12:13:06.641 [DEBUG] constraint: 1 addresses (0% of address space) can be scanned
Jan 10 12:13:07.275 [DEBUG] zmap: no interface provided. will use default interface (eth0).
Jan 10 12:13:07.275 [DEBUG] zmap: no source IP address given. will use default address: 192.168.199.130.
Jan 10 12:13:07.275 [DEBUG] zmap: found gateway IP 192.168.199.2 on eth0
Jan 10 12:13:07.276 [DEBUG] send: gateway MAC address 00:50:56:fd:4a:09
Jan 10 12:13:07.276 [INFO] zmap: output module: csv
Jan 10 12:13:07.276 [DEBUG] csv: more than one field, will add headers
Jan 10 12:13:07.277 [TRACE] zmap: Isomorphism: 94
Jan 10 12:13:07.277 [DEBUG] send: srcip_first: 2194122944
Jan 10 12:13:07.277 [DEBUG] send: srcip_last: 2194122944
Jan 10 12:13:07.277 [DEBUG] send: will send from 1 address on 28233 source ports
Jan 10 12:13:07.277 [DEBUG] send: no source MAC provided. automatically detected 00:0c:29:07:b2:0a as hw interface for eth0
Jan 10 12:13:07.277 [DEBUG] send: source MAC address 00:0c:29:07:b2:0a
Jan 10 12:13:07.279 [TRACE] zmap: Pinning receive thread to core 0
Jan 10 12:13:07.279 [TRACE] recv: recv thread started
Jan 10 12:13:07.280 [DEBUG] recv: capturing responses on eth0
Jan 10 12:13:07.665 [DEBUG] recv: duplicate responses will be excluded from output
Jan 10 12:13:07.666 [DEBUG] recv: unsuccessful responses will be excluded from output
Jan 10 12:13:07.666 [DEBUG] zmap: 1 sender threads spawned
Jan 10 12:13:07.666 [TRACE] zmap: Pinning a send thread to core 1
Jan 10 12:13:07.667 [TRACE] zmap: Pinning monitor thread to core 0
Jan 10 12:13:07.667 [TRACE] send: send thread started
Jan 10 12:13:07.667 [DEBUG] send: source MAC address 00:0c:29:07:b2:0a

 0:00 5%; send: 1 0 p/s (2 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%

Jan 10 12:13:07.668 [DEBUG] send: thread 0 finished
Jan 10 12:13:07.668 [DEBUG] zmap: senders finished

 0:01 17%; send: 1 done (2 p/s avg); recv: 1 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 100.00%
 0:02 29%; send: 1 done (2 p/s avg); recv: 1 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 100.00%
 0:03 41%; send: 1 done (2 p/s avg); recv: 1 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 100.00%
 0:04 53%; send: 1 done (2 p/s avg); recv: 1 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 100.00%
 0:05 65% (3s left); send: 1 done (2 p/s avg); recv: 1 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 100.00%
 0:06 77% (2s left); send: 1 done (2 p/s avg); recv: 1 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 100.00%
 0:07 89% (1s left); send: 1 done (2 p/s avg); recv: 1 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 100.00%

Jan 10 12:13:15.973 [DEBUG] recv: thread finished

 0:08 104% (0s left); send: 1 done (2 p/s avg); recv: 1 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 100.00%

cnf	target-port	443
cnf	source-port-range-begin	32768
cnf	source-port-range-end	61000
cnf	source-addr-range-begin	192.168.199.130
cnf	source-addr-range-end	192.168.199.130
cnf	maximum-targets	4294967295
cnf	maximum-runtime	0
cnf	maximum-results	4294967295
cnf	permutation-seed	0
cnf	cooldown-period	8
cnf	send-interface	eth0
cnf	rate	0
cnf	bandwidth	0
cnf	shard-num	0
cnf	num-shards	1
cnf	senders	1
env	nprocessors	2
exc	send-start-time	Sat Jan 10 12:13:07 2015
exc	send-end-time	Sat Jan 10 12:13:07 2015
exc	recv-start-time	Sat Jan 10 12:13:07 2015
exc	recv-end-time	Sat Jan 10 12:13:15 2015
exc	sent	1
exc	blacklisted	254
exc	whitelisted	1
exc	first-scanned	0
exc	hit-rate	100.000000
exc	success-total	1
exc	success-unique	1
exc	success-cooldown-total	1
exc	success-cooldown-unique	1
exc	failure-total	0
exc	sendto-failures	0
adv	permutation-gen	94
exc	scan-type	tcp_synscan

Jan 10 12:13:16.975 [INFO] zmap: completed
</pre>
<p>Izlazna datoteka:</p>
<pre>saddr, daddr, sport, dport
161.53.120.210,192.168.199.130,443,51947</pre>
<p><b>Neuspješno:</b>
<br />
</p>
<p>pr. MySql</p>
<pre>
zmap -p 3306 -f&quot;saddr,daddr,sport,dport&quot; --verbosity=5  -o rezultati3.csv --summary  161.53.120.230 

Jan 10 12:20:04.689 [TRACE] zmap: zmap main thread started
Jan 10 12:20:04.689 [DEBUG] zmap: Loaded configuration file /etc/zmap/zmap.conf
Jan 10 12:20:04.689 [DEBUG] zmap: syslog support enabled
Jan 10 12:20:04.691 [TRACE] zmap: requested ouput-module: default
Jan 10 12:20:04.691 [DEBUG] zmap: no output module provided. will use csv.
Jan 10 12:20:04.692 [TRACE] fieldset: probe module does not supply application success field.
Jan 10 12:20:04.692 [DEBUG] zmap: requested output field (0): saddr
Jan 10 12:20:04.692 [DEBUG] zmap: requested output field (1): daddr
Jan 10 12:20:04.693 [DEBUG] zmap: requested output field (2): sport
Jan 10 12:20:04.693 [DEBUG] zmap: requested output field (3): dport
Jan 10 12:20:04.693 [WARN] blacklist: ZMap is currently using the default blacklist located at /etc/zmap/blacklist.conf. By default, this blacklist excludes locally scoped networks (e.g. 10.0.0.0/8, 127.0.0.1/8, and 192.168.0.0/16). If you are trying to scan local networks, you can change the default blacklist by editing the default ZMap configuration at /etc/zmap/zmap.conf.
Jan 10 12:20:04.694 [DEBUG] constraint: blacklisting 0.0.0.0/0
Jan 10 12:20:04.695 [TRACE] constraint: Painting value 1
Jan 10 12:20:04.703 [DEBUG] constraint: 0 IPs in radix array, 1 IPs in tree
Jan 10 12:20:04.703 [DEBUG] constraint: 1 addresses (0% of address space) can be scanned
Jan 10 12:20:05.159 [DEBUG] zmap: no interface provided. will use default interface (eth0).
Jan 10 12:20:05.160 [DEBUG] zmap: no source IP address given. will use default address: 192.168.199.130.
Jan 10 12:20:05.160 [DEBUG] zmap: found gateway IP 192.168.199.2 on eth0
Jan 10 12:20:05.161 [DEBUG] send: gateway MAC address 00:50:56:fd:4a:09
Jan 10 12:20:05.161 [INFO] zmap: output module: csv
Jan 10 12:20:05.161 [DEBUG] csv: more than one field, will add headers
Jan 10 12:20:05.162 [TRACE] zmap: Isomorphism: 171
Jan 10 12:20:05.162 [DEBUG] send: srcip_first: 2194122944
Jan 10 12:20:05.162 [DEBUG] send: srcip_last: 2194122944
Jan 10 12:20:05.163 [DEBUG] send: will send from 1 address on 28233 source ports
Jan 10 12:20:05.163 [DEBUG] send: no source MAC provided. automatically detected 00:0c:29:07:b2:0a as hw interface for eth0
Jan 10 12:20:05.163 [DEBUG] send: source MAC address 00:0c:29:07:b2:0a
Jan 10 12:20:05.166 [TRACE] zmap: Pinning receive thread to core 0
Jan 10 12:20:05.166 [TRACE] recv: recv thread started
Jan 10 12:20:05.167 [DEBUG] recv: capturing responses on eth0
Jan 10 12:20:05.437 [DEBUG] recv: duplicate responses will be excluded from output
Jan 10 12:20:05.437 [DEBUG] recv: unsuccessful responses will be excluded from output
Jan 10 12:20:05.437 [DEBUG] zmap: 1 sender threads spawned
Jan 10 12:20:05.437 [TRACE] zmap: Pinning a send thread to core 1
Jan 10 12:20:05.437 [TRACE] zmap: Pinning monitor thread to core 0
Jan 10 12:20:05.438 [TRACE] send: send thread started
Jan 10 12:20:05.438 [DEBUG] send: source MAC address 00:0c:29:07:b2:0a

 0:00 3%; send: 1 0 p/s (3 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%

Jan 10 12:20:05.438 [DEBUG] send: thread 0 finished
Jan 10 12:20:05.438 [DEBUG] zmap: senders finished

 0:01 15%; send: 1 done (3 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%
 0:02 28%; send: 1 done (3 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%
 0:03 40%; send: 1 done (3 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%
 0:04 52%; send: 1 done (3 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%
 0:05 64% (3s left); send: 1 done (3 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%
 0:06 76% (2s left); send: 1 done (3 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%
 0:07 88% (1s left); send: 1 done (3 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%

Jan 10 12:20:13.789 [DEBUG] recv: thread finished

 0:08 104% (0s left); send: 1 done (3 p/s avg); recv: 0 0 p/s (0 p/s avg); drops: 0 p/s (0 p/s avg); hitrate: 0.00%

cnf	target-port	3306
cnf	source-port-range-begin	32768
cnf	source-port-range-end	61000
cnf	source-addr-range-begin	192.168.199.130
cnf	source-addr-range-end	192.168.199.130
cnf	maximum-targets	4294967295
cnf	maximum-runtime	0
cnf	maximum-results	4294967295
cnf	permutation-seed	0
cnf	cooldown-period	8
cnf	send-interface	eth0
cnf	rate	0
cnf	bandwidth	0
cnf	shard-num	0
cnf	num-shards	1
cnf	senders	1
env	nprocessors	2
exc	send-start-time	Sat Jan 10 12:20:05 2015
exc	send-end-time	Sat Jan 10 12:20:05 2015
exc	recv-start-time	Sat Jan 10 12:20:05 2015
exc	recv-end-time	Sat Jan 10 12:20:13 2015
exc	sent	1
exc	blacklisted	254
exc	whitelisted	1
exc	first-scanned	0
exc	hit-rate	0.000000
exc	success-total	0
exc	success-unique	0
exc	success-cooldown-total	0
exc	success-cooldown-unique	0
exc	failure-total	0
exc	sendto-failures	0
adv	permutation-gen	171
exc	scan-type	tcp_synscan

Jan 10 12:20:14.794 [INFO] zmap: completed
</pre>
<p><br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Valentina&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Valentina (stranica ne postoji)">Valentina</a> 15:26, 12. siječnja 2015. (CET)
<br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Mkovacek&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Mkovacek (stranica ne postoji)">Mkovacek</a> 15:26, 12. siječnja 2015. (CET)
<br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:GGlogoski&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:GGlogoski (stranica ne postoji)">GGlogoski</a> 00:45, 13. siječnja 2015. (CET)<br />
<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Tsteyska&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Tsteyska (stranica ne postoji)">Tsteyska</a> 21:55, 14. siječnja 2015. (CET)
</p>
<h3> <span class="mw-headline" id="Automatizacija_ZMap_skeniranja"> Automatizacija ZMap skeniranja </span></h3>
<p>Testirajući prethodne IP adrese, zapitali smo se da li bi se mogla napraviti određena automatizacija prilikom ZMap skeniranja?
Došli smo do zaključka da se može automatizirati ako se napravi skripta koje se može pokrenuti i izvršavanjem određenog
koda i odabirom parmetara dolazi se do odličnih rezultata. <br />
<br />
Skripta koju smo implemenatirali nudi tri opcije skeniranja:
</p>
<ol><li>da se unese neki specifični port kojega želimo skenirati kao npr. port 80<br />
</li><li>da se unese neki raspon portova koje želimo skenirati kao npr. od 25-50<br />
</li><li>da se skeniraju neki od najpoznatijih portova na kojima se odvija komunikacija kao npr. 7,20,21,22,...
</li></ol>
<p>Opcije su koncipirane tako da se prvo odaberu portovi (kod prve dvije opcije) te se onda upisuju IP adrese, a u trećoj opciji se samo upisuje IP adresa.
<br />
Ako želimo skenirati neki specifični port, onda se unese port i nakon toga IP adresa/e i nakon toga se unutar skripte pozove funkcija koja napravi takvu vrstu testiranja. Ako želimo skenirati određeni raspon portova, tada se unese raspon i IP adresa/e i nakon toga se pozove funkcija unutar skripte koja napravi takvo testiranje i kreće se od početnog porta prema onom završnome.Ako se pak želi provesti skeniranje samo kroz najpoznatije portove, tada se unese samo IP adresa i program prolazi kroz neke od najpoznatijih portova koje smo stavili u skriptu. <br />
Skripta započinje tako da se odabere jedna od opcija skeniranja. Na kraju skeniranja se poziva funkcija za filtriranje, koja pronalazi na kojim portovima je dobiven odgovor. Nakon toga se kreira folder Hit, ako već ne postoji, u kojega se spremaju rezultati portova od kojih je dobiven odgovor. 
<br />
<br />
Skripta koju smo implementirali izgleda ovako:
</p>
<pre>
#!/bin/bash

function filterResults(){
	if [&#160;! -d &quot;Hit&quot; ]
	then
		mkdir Hit
	fi
	
	for ((i=1; i&lt;=3500; i++))
	do
		if [ -f &quot;port_$i.csv&quot; ]
		then
			br=$(wc -c &lt; port_$i.csv)
			if [[ &quot;$br&quot; -gt &quot;54&quot; ]]
			then 
				cp port_$i.csv Hit
			fi
		fi		
	done
}

function folder(){
	if [[ &quot;$IP&quot; =~ &quot;/&quot; ]]
	then
	folder=$(echo $IP | tr &quot;/&quot; &quot;-&quot;)
	mkdir $folder
	elif [ &quot;$IP&quot;&#160;!= &quot;${IP/ /}&quot; ]
	then
	folder=&quot;ZMap_results&quot;
	mkdir $folder
	else
	folder=$IP
	mkdir $folder
        fi
}

function ZMap(){
	zmap -p $i -f &quot;saddr,daddr,sport,dport,classification,ttl,ipid&quot; -o $folder/port_$i.csv $IP
}

function zmapPorts(){
	echo &quot;Enter ports (etc. 80 110): &quot;
	read ports;
	echo &quot;Enter IP&quot;
        read IP;
	folder

        for i in $ports
	do
	   ZMap
	done
	cd $folder
	filterResults
}

function zmapPortRange(){
	echo &quot;From port (etc. 25): &quot;
	read fromPort;
        echo &quot;To port (etc. 50): &quot;
	read toPort;
	echo &quot;Enter IP: &quot;
        read IP;
	folder

	for ((i=$fromPort; i&lt;=$toPort; i++))
	do
          ZMap
	done
	cd $folder
	filterResults
}

function zmapKnownPorts(){
	echo &quot;Enter IP&quot;
        read IP;
	folder


        for i in 1 5 7 18 20 21 22 23 25 29 37 42 43 49 53 69 70 79 80 103 108 109 110 115 118 119 137 139 143 150 156 161 179 190 194 197 389 396 443 444 445 458 546 547 563 569 1080
	do
	   ZMap
	done
	cd $folder
	filterResults
}

echo &quot;1 Specific port(s) etc. 80 110 &quot; 
echo &quot;2 Port range etc. 25..50&quot;
echo &quot;3 Well known ports&quot;

read case;

case $case in 
	1) zmapPorts;;
	2) zmapPortRange;;
	3) zmapKnownPorts;;

esac

</pre>
<p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Valentina&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Valentina (stranica ne postoji)">Valentina</a> 18:52, 19. siječnja 2015. (CET)<br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:GGlogoski&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:GGlogoski (stranica ne postoji)">GGlogoski</a> 19:31, 19. siječnja 2015. (CET)<br />
-- <a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Mkovacek&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Mkovacek (stranica ne postoji)">Mkovacek</a> 19:37, 19. siječnja 2015. (CET)<br />
-- <a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Tsteyska&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Tsteyska (stranica ne postoji)">Tsteyska</a> 20:49, 19. siječnja 2015. (CET)
</p>
<h3> <span class="mw-headline" id="Rezultati_skeniranja_pomo.C4.87u_skripte">Rezultati skeniranja pomoću skripte </span></h3>
<p>Pomoću prethodno navedene skripte izvršili smo skeniranje sljedećih IP adresa: <br />
</p>
<pre>
161.53.120.230 
161.53.120.210 
161.53.120.209 
161.53.120.61
</pre>
<p>Rezultati skeniranja pronađeni su na sljedećim portovima:
</p><p><b>Port 22</b>
</p>
<pre>
saddr, daddr, sport, dport, classification, ttl, ipid
161.53.120.61,192.168.139.137,22,48647,synack,128,2962
</pre>
<p><b>Port 25</b>
</p>
<pre>
saddr, daddr, sport, dport, classification, ttl, ipid
161.53.120.230,192.168.139.137,25,56222,synack,128,2970
161.53.120.61,192.168.139.137,25,58385,synack,128,2971
161.53.120.209,192.168.139.137,25,39784,synack,128,2972
161.53.120.210,192.168.139.137,25,53195,synack,128,2973
</pre>
<p><b>Port 110</b>
</p>
<pre>
saddr, daddr, sport, dport, classification, ttl, ipid
161.53.120.230,192.168.139.137,110,55444,synack,128,3026
161.53.120.61,192.168.139.137,110,50758,synack,128,3027
161.53.120.210,192.168.139.137,110,56199,synack,128,3028
161.53.120.209,192.168.139.137,110,39659,synack,128,3029
</pre>
<p><b>Port 119</b>
</p>
<pre>
saddr, daddr, sport, dport, classification, ttl, ipid
161.53.120.210,192.168.139.137,119,46875,synack,128,3067
161.53.120.61,192.168.139.137,119,33271,synack,128,3068
161.53.120.230,192.168.139.137,119,42167,synack,128,3069
161.53.120.209,192.168.139.137,119,41177,synack,128,3070
</pre>
<p><b>Port 143</b>
</p>
<pre>
saddr, daddr, sport, dport, classification, ttl, ipid
161.53.120.210,192.168.139.137,143,36388,synack,128,3078
161.53.120.230,192.168.139.137,143,52675,synack,128,3079
161.53.120.61,192.168.139.137,143,34591,synack,128,3080
161.53.120.209,192.168.139.137,143,36276,synack,128,3081
</pre>
<p><b>Port 443</b>
</p>
<pre>
saddr, daddr, sport, dport, classification, ttl, ipid
161.53.120.210,192.168.139.137,443,33469,synack,128,3119
</pre>
<p><b>Port 563</b>
</p>
<pre>
saddr, daddr, sport, dport, classification, ttl, ipid
161.53.120.61,192.168.139.137,563,53504,synack,128,3143
161.53.120.230,192.168.139.137,563,58544,synack,128,3144
161.53.120.210,192.168.139.137,563,35419,synack,128,3145
161.53.120.209,192.168.139.137,563,46376,synack,128,3146
</pre>
<p>--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Valentina&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Valentina (stranica ne postoji)">Valentina</a> 19:30, 19. siječnja 2015. (CET)<br />
--<a href="http://security.foi.hr/wiki/index.php?title=Suradnik:GGlogoski&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:GGlogoski (stranica ne postoji)">GGlogoski</a> 19:33, 19. siječnja 2015. (CET)<br />
-- <a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Mkovacek&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Mkovacek (stranica ne postoji)">Mkovacek</a> 19:37, 19. siječnja 2015. (CET)<br />
-- <a href="http://security.foi.hr/wiki/index.php?title=Suradnik:Tsteyska&amp;action=edit&amp;redlink=1" class="new" title="Suradnik:Tsteyska (stranica ne postoji)">Tsteyska</a> 20:49, 19. siječnja 2015. (CET)
</p>
<h2> <span class="mw-headline" id="Literatura"> Literatura </span></h2>
<p><a href="https://zmap.io/documentation.html" class="external free" rel="nofollow">https://zmap.io/documentation.html</a> <br />
<a href="https://zmap.io/documentation.html#gettingstarted" class="external free" rel="nofollow">https://zmap.io/documentation.html#gettingstarted</a> <br />
<a href="https://zmap.io/documentation.html#bestpractices" class="external free" rel="nofollow">https://zmap.io/documentation.html#bestpractices</a> <br />
<a href="http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO.html" class="external free" rel="nofollow">http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO.html</a> <br />
</p>
<!-- 
NewPP limit report
Preprocessor node count: 1053/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key sisds:pcache:idhash:7930-0!*!0!!hr!*!edit=0 and timestamp 20190203204303 -->
<div class="printfooter">
Dobavljeno iz "<a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html">http://security.foi.hr/wiki/index.php/Tehnike_brzog_mre%C5%BEnog_skeniranja_(zmap)</a>"</div>
				<!-- /bodytext -->
								<!-- catlinks -->
				<div id='catlinks' class='catlinks catlinks-allhidden'></div>				<!-- /catlinks -->
												<div class="visualClear"></div>
			</div>
			<!-- /bodyContent -->
		</div>
		<!-- /content -->
		<!-- header -->
		<div id="mw-head" class="noprint">
			
<!-- 0 -->
<div id="p-personal" class="">
	<h5>Osobni alati</h5>
	<ul>
					<li  id="pt-login"><a href="http://security.foi.hr/wiki/index.php?title=Posebno:Prijava&amp;returnto=Tehnike_brzog_mre%C5%BEnog_skeniranja_(zmap)" title="Predlažemo Vam da se prijavite, ali nije obvezno. [o]" accesskey="o">Prijavi se</a></li>
			</ul>
</div>

<!-- /0 -->
			<div id="left-navigation">
				
<!-- 0 -->
<div id="p-namespaces" class="vectorTabs">
	<h5>Imenski prostori</h5>
	<ul>
					<li  id="ca-nstab-main" class="selected"><span><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html"  title="Pogledaj sadržaj [c]" accesskey="c">Članak</a></span></li>
					<li  id="ca-talk" class="new"><span><a href="http://security.foi.hr/wiki/index.php?title=Razgovor:Tehnike_brzog_mre%C5%BEnog_skeniranja_(zmap)&amp;action=edit&amp;redlink=1"  title="Razgovor o stranici [t]" accesskey="t">Razgovor</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-variants" class="vectorMenu emptyPortlet">
		<h5><span>Inačice</span><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->
			</div>
			<div id="right-navigation">
				
<!-- 0 -->
<div id="p-views" class="vectorTabs">
	<h5>Pogledi</h5>
	<ul>
					<li id="ca-view" class="selected"><span><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html" >Čitaj</a></span></li>
					<li id="ca-viewsource"><span><a href="http://security.foi.hr/wiki/index.php?title=Tehnike_brzog_mre%C5%BEnog_skeniranja_(zmap)&amp;action=edit"  title="Ova stranica je zaštićena. Možete pogledati izvorni kod. [e]" accesskey="e">Vidi izvor</a></span></li>
					<li id="ca-history" class="collapsible "><span><a href="http://security.foi.hr/wiki/index.php?title=Tehnike_brzog_mre%C5%BEnog_skeniranja_(zmap)&amp;action=history"  title="Ranije izmjene na ovoj stranici. [h]" accesskey="h">Vidi stare izmjene</a></span></li>
			</ul>
</div>

<!-- /0 -->

<!-- 1 -->
<div id="p-cactions" class="vectorMenu emptyPortlet">
	<h5><span>Radnje</span><a href="Tehnike_brzog_mrežnog_skeniranja_(zmap).html#"></a></h5>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>

<!-- /1 -->

<!-- 2 -->
<div id="p-search">
	<h5><label for="searchInput">Traži</label></h5>
	<form action="http://security.foi.hr/wiki/index.php" id="searchform">
		<input type='hidden' name="title" value="Posebno:Traži"/>
				<input id="searchInput" name="search" type="text"  title="Pretraži ovaj wiki [f]" accesskey="f"  value="" />
		<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Kreni" title="Idi na stranicu s ovim imenom ako ona postoji" />
		<input type="submit" name="fulltext" class="searchButton" id="mw-searchButton" value="Traži" title="Traži ovaj tekst na svim stranicama" />
			</form>
</div>

<!-- /2 -->
			</div>
		</div>
		<!-- /header -->
		<!-- panel -->
			<div id="mw-panel" class="noprint">
				<!-- logo -->
					<div id="p-logo"><a style="background-image: url(../../images/osslogo.png);" href="../../wiki.html"  title="Glavna stranica"></a></div>
				<!-- /logo -->
				
<!-- navigation -->
<div class="portal" id='p-navigation'>
	<h5>Orijentacija</h5>
	<div class="body">
				<ul>
					<li id="n-mainpage-description"><a href="../../wiki.html" title="Posjeti glavnu stranicu [z]" accesskey="z">Glavna stranica</a></li>
					<li id="n-portal"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Portal_zajednice" title="O projektu, što možete učiniti, gdje je što">Portal zajednice</a></li>
					<li id="n-currentevents"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Novosti" title="O trenutačnim događajima">Aktualno</a></li>
					<li id="n-recentchanges"><a href="./Posebno:Nedavne_promjene.html" title="Popis nedavnih promjena u wikiju. [r]" accesskey="r">Nedavne promjene</a></li>
					<li id="n-randompage"><a href="./Posebno:Slučajna_stranica.html" title="Učitaj slučajnu stranicu [x]" accesskey="x">Slučajna stranica</a></li>
					<li id="n-help"><a href="./Pomoć:Pomoć.html" title="Mjesto za pomoć suradnicima.">Pomoć</a></li>
				</ul>
			</div>
</div>

<!-- /navigation -->

<!-- SEARCH -->

<!-- /SEARCH -->

<!-- TOOLBOX -->
<div class="portal" id="p-tb">
	<h5>Traka s alatima</h5>
	<div class="body">
		<ul>
					<li id="t-whatlinkshere"><a href="http://security.foi.hr/wiki/index.php/Posebno:%C5%A0to_vodi_ovamo/Tehnike_brzog_mre%C5%BEnog_skeniranja_(zmap)" title="Popis svih stranica koje sadrže poveznice ovamo [j]" accesskey="j">Što vodi ovamo</a></li>
						<li id="t-recentchangeslinked"><a href="http://security.foi.hr/wiki/index.php/Posebno:Povezane_promjene/Tehnike_brzog_mre%C5%BEnog_skeniranja_(zmap)" title="Nedavne promjene na stranicama na koje vode ovdašnje poveznice [k]" accesskey="k">Povezane stranice</a></li>
																																										<li id="t-specialpages"><a href="./Posebno:Posebne_stranice.html" title="Popis posebnih stranica [q]" accesskey="q">Posebne stranice</a></li>
									<li id="t-print"><a href="http://security.foi.hr/wiki/index.php?title=Tehnike_brzog_mre%C5%BEnog_skeniranja_(zmap)&amp;printable=yes" rel="alternate" title="Verzija za ispis ove stranice [p]" accesskey="p">Verzija za ispis</a></li>
						<li id="t-permalink"><a href="http://security.foi.hr/wiki/index.php?title=Tehnike_brzog_mre%C5%BEnog_skeniranja_(zmap)&amp;oldid=32567" title="Trajna poveznica na ovu verziju stranice">Trajna poveznica</a></li>
						</ul>
	</div>
</div>

<!-- /TOOLBOX -->

<!-- LANGUAGES -->

<!-- /LANGUAGES -->
			</div>
		<!-- /panel -->
		<!-- footer -->
		<div id="footer">
											<ul id="footer-info">
																	<li id="footer-info-lastmod"> Datum zadnje promjene na ovoj stranici: 19:49, 19. siječnja 2015.</li>
																							<li id="footer-info-viewcount">Ova stranica je pogledana 2.976 puta.</li>
																							<li id="footer-info-copyright">Sadržaji se koriste u skladu s <a href="http://creativecommons.org/licenses/by-sa/3.0/" class="external ">Creative Commons Attribution Share Alike</a>.</li>
															</ul>
															<ul id="footer-places">
																	<li id="footer-places-privacy"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:Za%C5%A1tita_privatnosti" title="SIS Wiki:Zaštita privatnosti">Zaštita privatnosti</a></li>
																							<li id="footer-places-about"><a href="./SIS_Wiki:O_projektu_SIS_Wiki.html" title="SIS Wiki:O projektu SIS Wiki">O projektu SIS Wiki</a></li>
																							<li id="footer-places-disclaimer"><a href="http://security.foi.hr/wiki/index.php/SIS_Wiki:General_disclaimer" title="SIS Wiki:General disclaimer">Odricanje od odgovornosti</a></li>
															</ul>
											<ul id="footer-icons" class="noprint">
					<li id="footer-copyrightico">
						<a href="http://creativecommons.org/licenses/by-sa/3.0/"><img src="../skins/common/images/cc-by-sa.png" alt="Creative Commons Attribution Share Alike" width="88" height="31" /></a>
					</li>
					<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="../skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<!-- /footer -->
		
<script src="../load.php%3Fdebug=false&amp;lang=hr&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if ( window.mediaWiki ) {
	mediaWiki.config.set({"wgCanonicalNamespace": "", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 0, "wgPageName": "Tehnike_brzog_mrežnog_skeniranja_(zmap)", "wgTitle": "Tehnike brzog mrežnog skeniranja (zmap)", "wgAction": "view", "wgArticleId": 7930, "wgIsArticle": true, "wgUserName": null, "wgUserGroups": ["*"], "wgCurRevisionId": 32567, "wgCategories": [], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": []});
}
</script>
<script>if ( window.mediaWiki ) {
	mediaWiki.loader.load(["mediawiki.util", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax"]);
	mediaWiki.loader.go();
}
</script>

<script>if ( window.mediaWiki ) {
	mediaWiki.user.options.set({"ccmeonemails":0,"cols":80,"contextchars":50,"contextlines":5,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,
	"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"hr","language":"hr","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false});;mediaWiki.loader.state({"user.options":"ready"});
}
</script>		<!-- fixalpha -->
		<script type="text/javascript"> if ( window.isMSIE55 ) fixalpha(); </script>
		<!-- /fixalpha -->
		<!-- Served in 0.819 secs. -->			</body>
</html>
